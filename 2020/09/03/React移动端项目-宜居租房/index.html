<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>React移动端项目-宜居租房 | Zax&#39;s BLOG</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="React移动端项目-宜居租房简介本项目采用React脚手架create-react-app搭建,使用less预处理配合rem,使用redux保存调用相关数据.后端mock数据采用node.js的express框架进行创建.前后端分离,跨域使用http-proxy-middleware中间件.使用模块化的方式处理各个页面.公共组件抽离到统一目录下方便调用. 技术栈React+React-Route">
<meta property="og:type" content="article">
<meta property="og:title" content="React移动端项目-宜居租房">
<meta property="og:url" content="http://yoursite.com/2020/09/03/React%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%A1%B9%E7%9B%AE-%E5%AE%9C%E5%B1%85%E7%A7%9F%E6%88%BF/index.html">
<meta property="og:site_name" content="Zax&#39;s BLOG">
<meta property="og:description" content="React移动端项目-宜居租房简介本项目采用React脚手架create-react-app搭建,使用less预处理配合rem,使用redux保存调用相关数据.后端mock数据采用node.js的express框架进行创建.前后端分离,跨域使用http-proxy-middleware中间件.使用模块化的方式处理各个页面.公共组件抽离到统一目录下方便调用. 技术栈React+React-Route">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2020-09-03T01:41:26.000Z">
<meta property="article:modified_time" content="2022-11-01T04:33:24.082Z">
<meta property="article:author" content="Zax Tseng">
<meta property="article:tag" content="javascript, React, Vue, HTML5">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Zax&#39;s BLOG" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Zax&#39;s BLOG</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-React移动端项目-宜居租房" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2020/09/03/React%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%A1%B9%E7%9B%AE-%E5%AE%9C%E5%B1%85%E7%A7%9F%E6%88%BF/" class="article-date">
  <time datetime="2020-09-03T01:41:26.000Z" itemprop="datePublished">2020-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      React移动端项目-宜居租房
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="React移动端项目-宜居租房"><a href="#React移动端项目-宜居租房" class="headerlink" title="React移动端项目-宜居租房"></a>React移动端项目-宜居租房</h1><h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>本项目采用React脚手架create-react-app搭建,使用less预处理配合rem,使用redux保存调用相关数据.</br><br>后端mock数据采用node.js的express框架进行创建.前后端分离,跨域使用http-proxy-middleware中间件.</br><br>使用模块化的方式处理各个页面.公共组件抽离到统一目录下方便调用.</p>
<h2 id="技术栈"><a href="#技术栈" class="headerlink" title="技术栈"></a>技术栈</h2><p>React+React-Router(v4)+React-Redux+Less+Express+Fetch</p>
<h2 id="项目启动"><a href="#项目启动" class="headerlink" title="项目启动"></a>项目启动</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//安装依赖</span></span><br><span class="line">npm install</span><br></pre></td></tr></table></figure>
<p>再另开一个终端</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node ./mock/index.<span class="property">js</span></span><br></pre></td></tr></table></figure>
<p>回到第一个终端</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm start</span><br></pre></td></tr></table></figure>
<h2 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h2><ol>
<li>less配置</li>
</ol>
<p>通过<code>npm install less less-loader -S</code>安装less.</br><br><code>npm eject</code>加载webpack配置,打开<code>config/webpack.config.js</code>文件,</br><br>找到<code>sass</code>配置,复制一份.改为less配置.</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> lessRegex = <span class="regexp">/\.less$/</span>;</span><br><span class="line"><span class="keyword">const</span> lessModuleRegex = <span class="regexp">/\.module\.less$/</span>;</span><br></pre></td></tr></table></figure>
<p>搜索<code>sassRegex</code>和<code>sassModuleRegex</code>将相应的文件配置复制一份进行修改.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">test</span>: lessRegex,</span><br><span class="line">    <span class="attr">exclude</span>: lessModuleRegex,</span><br><span class="line">    <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">importLoaders</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">sourceMap</span>: isEnvProduction &amp;&amp; shouldUseSourceMap,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;less-loader&#x27;</span></span><br><span class="line">    ),</span><br><span class="line"></span><br><span class="line">    <span class="attr">sideEffects</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">test</span>: lessModuleRegex,</span><br><span class="line">    <span class="attr">use</span>: <span class="title function_">getStyleLoaders</span>(</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">importLoaders</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">sourceMap</span>: isEnvProduction &amp;&amp; shouldUseSourceMap,</span><br><span class="line">        <span class="attr">modules</span>: &#123;</span><br><span class="line">        <span class="attr">getLocalIdent</span>: getCSSModuleLocalIdent,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&#x27;less-loader&#x27;</span></span><br><span class="line">    ),</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="经验之谈"><a href="#经验之谈" class="headerlink" title="经验之谈"></a>经验之谈</h2><blockquote>
<p>如果出现<code>Cannot find module &#39;resolve&#39;</code>报错,说明依赖没有安装好,大部分是网络原因,运行<code>npm install</code>重新安装一次就好了.<br>2. rem配置</p>
</blockquote>
<p>在index.html中的<code>&lt;header&gt;</code>最后位置放入下列代码.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">(<span class="keyword">function</span> (<span class="params">doc, win</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> docEl = doc.<span class="property">documentElement</span>,</span><br><span class="line">            resizeEvt = <span class="string">&#x27;orientationchange&#x27;</span> <span class="keyword">in</span> <span class="variable language_">window</span> ? <span class="string">&#x27;orientationchange&#x27;</span> : <span class="string">&#x27;resize&#x27;</span>,</span><br><span class="line">            recalc = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">                <span class="keyword">var</span> clientWidth = docEl.<span class="property">clientWidth</span>;</span><br><span class="line">                <span class="keyword">if</span> (!clientWidth) <span class="keyword">return</span>;</span><br><span class="line">                <span class="keyword">if</span>(clientWidth&gt;=<span class="number">750</span>)&#123;</span><br><span class="line">                    docEl.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="string">&#x27;100px&#x27;</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    docEl.<span class="property">style</span>.<span class="property">fontSize</span> = <span class="number">100</span> * (clientWidth / <span class="number">750</span>) + <span class="string">&#x27;px&#x27;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (!doc.<span class="property">addEventListener</span>) <span class="keyword">return</span>;</span><br><span class="line">    win.<span class="title function_">addEventListener</span>(resizeEvt, recalc, <span class="literal">false</span>);</span><br><span class="line">    doc.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, recalc, <span class="literal">false</span>);</span><br><span class="line">&#125;)(<span class="variable language_">document</span>, <span class="variable language_">window</span>);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>创建文件夹</li>
</ol>
<p>在<code>src</code>下创建以下文件夹.</p>
<ul>
<li>路由文件夹<code>router</code></li>
<li>公共组件文件夹<code>components</code></li>
<li>工具类文件夹<code>utils</code></li>
<li>页面文件夹<code>pages</code></li>
<li>静态文件夹<code>static</code></li>
</ul>
<p>在<code>pages</code>下创建各个文件夹</br><br><code>Home, Shop, Life, Mine, NotFound</code>下生成组件<code>index.jsx</code>和<code>style.less</code>.</br></p>
<p>在<code>static</code>文件夹下放入初始化资源</br><br>css,iconfont,images</br></p>
<ol start="4">
<li>路由支持</li>
</ol>
<p><code>npm install react-router react-router-dom --save</code></p>
<p><code>router</code>文件夹下创建<code>AppRouter.jsx</code>文件,将该文件导出挂载到<code>app.js</code>文件内作为组件.</br><br><code>AppRouter</code>文件引入<code>&#123;Route, HashRouter, Switch&#125;</code>,pages下各个页面,将路径和component填入各个<code>Route</code>中.</br></p>
<ol start="5">
<li>css文件初始化</li>
</ol>
<p>在<code>static/common.less</code>中将样式初始化,或者直接引入<code>normalize.css</code>.</p>
<ol start="6">
<li>底部导航</li>
</ol>
<p>引入iconfont字体图标库.在index.js中也引入.</br><br>底部导航是公共组件,在components下创建FootNav文件夹.</br><br>引入router的NavLink,因为需要点击跳转.(注意首页的路径使用exact精确匹配)</br><br>因为每个页面都会用到底部导航,故在每个页面进行引入.</br><br>在各个底部菜单放入图标<code>&lt;i className=&quot;&quot;&gt;</code>引入各个图标.</br></p>
<ol start="7">
<li>HomeHeader</li>
</ol>
<p>创建<code>Home/HomeHeader</code>,按照划分分为3部分,<code>home-header-left,right,middle</code>.</br><br>其中<code>home-header-middle</code>部分包含一个<code>search-container</code>,之中包含一个iconfont和一个<code>input</code>.</br></p>
<ol start="8">
<li>轮播图</li>
</ol>
<p>安装swiper</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save react-swipeable-views</span><br></pre></td></tr></table></figure>
<p>在公共组件components文件夹下创建轮播图文件夹Swiper.</br><br>引入</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">SwipeableViews</span> <span class="keyword">from</span> <span class="string">&#x27;react-swipeable-views&#x27;</span></span><br></pre></td></tr></table></figure>
<p>将图片添加到staic&#x2F;images文件夹下.</br><br>将引入写到home.jsx中,由home向swiper组件传递banner.</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Swiper</span> banners=&#123; [banners1, banners2, banners3] &#125; /&gt;</span><br></pre></td></tr></table></figure>
<p>Swiper中直接将得到的<code>this.props.banners</code>用<code>map</code>方法遍历到<code>SwipeableVIews</code>中.</p>
<h3 id="添加轮播图底部小圆点"><a href="#添加轮播图底部小圆点" class="headerlink" title="添加轮播图底部小圆点"></a>添加轮播图底部小圆点</h3><p>在swiper文件夹下创建Pagination文件夹及相关文件.</br><br><code>&lt;Pagination /&gt;</code>和<code>&lt;SwipeableViews&gt;</code>是同级关系.</br><br>小点的数量由banners的长度决定,在<code>&lt;Pagination dots=&#123;banners.length&#125; /&gt;</code>中传递给子组件.</br><br>此时dots是数字,需要的是数组.使用new Array的方法将长度转化为数组</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//转化为[1,1,1]</span></span><br><span class="line"><span class="keyword">const</span> dotsArr = <span class="keyword">new</span> <span class="title class_">Array</span>(dots).<span class="title function_">fill</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<p>将数组map到<code>&lt;li&gt;&lt;/li&gt;</code>中.</p>
<h4 id="将小点和轮播图绑定"><a href="#将小点和轮播图绑定" class="headerlink" title="将小点和轮播图绑定"></a>将小点和轮播图绑定</h4><p>给<code>&lt;SwipeableViews&gt;</code>绑定事件,滑动到的当前的图的下标currentIndex,给赋值到index,传递给<code>&lt;Pagination /&gt;</code>,</br><br>它得到currentIndex后拿到<code>&lt;li&gt;</code>中进行判断,</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;li className=&#123;currentIndex === index ? <span class="string">&quot;selected&quot;</span> : <span class="string">&quot;&quot;</span>&#125;&gt;</span><br></pre></td></tr></table></figure>
<ol start="9">
<li>搭建服务器</li>
</ol>
<p>在项目根目录创建mock文件夹(或者server).</br><br>包含config,index,router文件和一个data文件夹.</br><br>data文件夹下创建home文件夹,热销商品数据<code>hotdata.js</code>.</br><br>安装express,<code>node index.js</code>启动.</br></p>
<ol start="10">
<li>跨域问题</li>
</ol>
<p>安装<code>npm install http-proxy-middleware --save</code></br><br>创建<code>src/setupProxy.js</code>文件</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; createProxyMiddleware &#125; = <span class="built_in">require</span>(<span class="string">&quot;http-proxy-middleware&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = <span class="keyword">function</span>(<span class="params">app</span>) &#123;</span><br><span class="line">  app.<span class="title function_">use</span>(createProxyMiddleware (<span class="string">&quot;/api&quot;</span>, &#123; <span class="attr">target</span>: <span class="string">&quot;http://localhost:5000/&quot;</span> &#125;));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ol start="11">
<li>Http处理网络请求</li>
</ol>
<p><code>utils</code>文件夹下创建<code>http.js</code></br><br>主要由两个函数构成,<code>getData, postData</code></br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> qs <span class="keyword">from</span> <span class="string">&#x27;querystring&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getDate</span>(<span class="params">url</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> result = <span class="title function_">fetch</span>(url)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> ...</span><br></pre></td></tr></table></figure>
<ol start="12">
<li>创建API</li>
</ol>
<p>创建<code>src/api/base.js</code>和index.js,homehot.js.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//base.js</span></span><br><span class="line"><span class="keyword">const</span> base = &#123;</span><br><span class="line">    <span class="attr">baseUrl</span>: <span class="string">&quot;http://localhost:5000&quot;</span>,</span><br><span class="line">    <span class="attr">homehot1</span>: <span class="string">&quot;/api/homehot1&quot;</span>,</span><br><span class="line">    <span class="attr">homehot2</span>: <span class="string">&quot;/api/homehot2&quot;</span> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 首页热门推荐</span></span><br><span class="line"><span class="keyword">import</span> base <span class="keyword">from</span> <span class="string">&quot;./base&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;getData&#125; <span class="keyword">from</span> <span class="string">&quot;../utils/http&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> homehot = &#123;</span><br><span class="line">    <span class="title function_">homehot1Data</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getData</span>(base.<span class="property">homehot1</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">homehot2Data</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getData</span>(base.<span class="property">homehot2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> homehot</span><br></pre></td></tr></table></figure>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> homehot <span class="keyword">from</span> <span class="string">&#x27;./homehot&#x27;</span></span><br><span class="line"><span class="comment">//这里注意加括号</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;homehot&#125;</span><br></pre></td></tr></table></figure>

<ol start="13">
<li>创建HomeHot文件夹</li>
</ol>
<p>引入api.在componentDidMount中调用api请求数据.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">componentDidMount</span>(<span class="params"></span>)&#123;</span><br><span class="line">    api.<span class="property">homehot</span>.<span class="title function_">homehot1Data</span>()</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span>&#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(data)&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="14">
<li>分离HomeHot的UI</li>
</ol>
<p>创建<code>./HomeHot/HomeHotView</code>.</br><br>将data传入HomeHotView,HomeHotView中map遍历数据data,放在li中.</br><br>创建style.less样式.</br></p>
<ol start="15">
<li>城市选项</li>
</ol>
<p>创建<code>src/pages/City</code>.将相关引入放到router中.</br><br>给北京添加<code>&lt;Link&gt;</code>,可以点击跳转到城市页面.</br></p>
<ol start="16">
<li>城市选择页面</li>
</ol>
<p>创建公共头部<code>component/Header</code>.</br><br>有一个返回箭头,一个title.其中title由使用页面传参</br><br>返回箭头绑定返回事件.</br><br><code>window.history.back(-1)</code></br><br><code>this.props.history.push(&quot;/home&quot;)</code></br></p>
<ol start="17">
<li>当前城市</li>
</ol>
<p>创建<code>./City/CurrentCity</code>,city也是从父级传递过来.</p>
<ol start="18">
<li>热门城市</li>
</ol>
<p>创建<code>./City/HotCity</code>.<br>点击传递参数时,建议使用bind传参,属于隐式传递.使用箭头函数属于显式传递.</br><br>此时事件定义时就不能用箭头函数了.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义事件</span></span><br><span class="line"><span class="title function_">clickHandler</span>(<span class="params">cityName</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">lig</span>(cityName)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//...</span></span><br><span class="line"><span class="comment">//向事件函数传参</span></span><br><span class="line"><span class="comment">//bind隐式传递</span></span><br><span class="line">&lt;li onClick=&#123;<span class="variable language_">this</span>.<span class="property">clickHandler</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>,<span class="string">&#x27;北京&#x27;</span>)&#125;&gt;北京&lt;/li&gt;</span><br><span class="line"><span class="comment">//箭头函数,显式传递</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">onClick</span>=<span class="string">&#123;(e)</span>=&gt;</span>this.clickHandler(&#x27;北京&#x27;,e)&#125;&gt;北京<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<ol start="19">
<li>创建Redux</li>
</ol>
<p>由于每个页面都需要获取城市信息,所以需要使用Redux存储.</p>
<p>安装redux</p>
<p><code>npm install --save redux react-redux</code></p>
<p>安装redux调试工具</p>
<p><code>npm install --save-dev redux-dectools</code></br><br> 创建<code>src/store/index.js</code>,<code>src/actions/city.js</code>,<code>src/actions/index.js</code>和<code>src/reducer/index.js</code>.</br><br> 再创建constants文件用于定义基本字符串.<br> <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/constants/city.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">INIT_CITY</span> = <span class="string">&quot;INIT_CITY&quot;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="variable constant_">UPDATE_CITY</span> = <span class="string">&quot;UPDATE_CITY&quot;</span></span><br></pre></td></tr></table></figure><br>创建初始化城市initCity和更新城市updateCity的函数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/actions/city.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> cityActions <span class="keyword">from</span> <span class="string">&quot;../constants/city&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">initCity</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: cityActions.<span class="property">INIT_CITY</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">updateCity</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="attr">type</span>: cityActions.<span class="property">UPDATE_CITY</span>,</span><br><span class="line">    data</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建city的Reducer</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/reducers/city.js</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> cityActions <span class="keyword">from</span> <span class="string">&#x27;../constants/city&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initState = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">city</span>(<span class="params">state = initState, action </span>)&#123;</span><br><span class="line">    <span class="keyword">switch</span>(action.<span class="property">type</span>)&#123;</span><br><span class="line">        <span class="keyword">case</span> cityActions.<span class="property">INIT_CITY</span>:</span><br><span class="line">            <span class="keyword">return</span> state = action.<span class="property">data</span>;</span><br><span class="line">        <span class="keyword">case</span> cityActions.<span class="property">UPDATE_CITY</span>:</span><br><span class="line">            <span class="keyword">return</span> state = action.<span class="property">data</span>;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure>
<p>合并Reducer</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/reducers/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; combineReducers &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span></span><br><span class="line"><span class="keyword">import</span> city <span class="keyword">from</span> <span class="string">&#x27;./city&#x27;</span></span><br><span class="line"><span class="keyword">const</span> rootReducers = <span class="title function_">combineReducers</span>(&#123;</span><br><span class="line">    city</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> rootReducers</span><br></pre></td></tr></table></figure>
<p>将Reducer传入store中,创建好store.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/store/index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">&#x27;redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> rootReducers <span class="keyword">from</span> <span class="string">&#x27;../reducers&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">configureStore</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> store = <span class="title function_">createStore</span>(rootReducers, </span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">__REDUX_DEVTOOLS_EXTENSION__</span> ? <span class="variable language_">window</span>.<span class="title function_">__REDUX_DEVTOOLS_EXTENSION__</span>() :<span class="literal">undefined</span></span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">return</span> store</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="20">
<li>使用Redux</li>
</ol>
<p>主入口文件index.js进行关联.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Provider</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> configtureStore <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"><span class="keyword">const</span> store = <span class="title function_">configtureStore</span>();</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">AppRouter</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Provider</span>&gt;</span></span>,</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<p>创建初始化页面<code>src/pages/app.jsx</code></p>
<p>在index页面包裹所有的二级路由,并且路径指向首页</p>
<h2 id="初始化项目需求"><a href="#初始化项目需求" class="headerlink" title="初始化项目需求"></a>初始化项目需求</h2><p>1.1 城市初始化</p>
<p>引入<code>bindActionCreators</code>,<code>connect</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//app.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> cityActions <span class="keyword">from</span> <span class="string">&quot;../actions/city&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; bindActionCreators &#125; <span class="keyword">from</span> <span class="string">&quot;redux&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span>&#123;</span><br><span class="line">    <span class="comment">//初始化城市数据</span></span><br><span class="line">    <span class="title function_">componentDidMount</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">cityActions</span>.<span class="title function_">initCity</span>(&#123;</span><br><span class="line">            <span class="attr">cityName</span>: <span class="string">&#x27;北京</span></span><br><span class="line"><span class="string">        &#125;)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    render()&#123;</span></span><br><span class="line"><span class="string">        return(</span></span><br><span class="line"><span class="string">            &lt;div&gt;&#123;this.props.children&#125;&lt;/div&gt;</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">mapStateToProps = state =&gt; &#123;</span></span><br><span class="line"><span class="string">    return &#123;</span></span><br><span class="line"><span class="string">        city: state.city</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">mapDispatchToProps = dispatch =&gt; &#123;</span></span><br><span class="line"><span class="string">    return &#123;</span></span><br><span class="line"><span class="string">        cityActions: bindActionCreators(cityAction, dispatch)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">export default connect(</span></span><br><span class="line"><span class="string">    mapStateToProps,</span></span><br><span class="line"><span class="string">    mapDispatchToProps</span></span><br><span class="line"><span class="string">)(App)</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<p>1.2 在Home页面引入读取操作</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">&#x27;react-redux&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">mapStateToProps</span> = state =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">city</span>: state.<span class="property">city</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title function_">connect</span>(</span><br><span class="line">    mapStateToProps</span><br><span class="line">)(<span class="title class_">Home</span>)</span><br></pre></td></tr></table></figure>
<p>1.3 在City页面也要引入</p>
<p>1.4 将HotCity选中的城市传递到主组件City</p>
<p>定义自定义事件进行传递</p>
<p>传递之后,引入mapDispatchToProps触发修改</p>
<p>改变之后,返回上一页面</p>
<p>1.5 传递城市信息</p>
<p>修改mock中参数</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mock/router.js</span></span><br><span class="line"><span class="keyword">var</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>)</span><br><span class="line">router.<span class="title function_">get</span>(config.<span class="property">homehot1</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">    <span class="comment">//接收城市作为参数</span></span><br><span class="line">    <span class="keyword">var</span> cityName = url.<span class="title function_">parse</span>(req.<span class="property">url</span>,<span class="literal">true</span>).<span class="property">query</span>.<span class="property">city</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(cityName)</span><br><span class="line">    res.<span class="title function_">send</span>(homehot.<span class="property">hot1</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>Home组件中<code>&lt;HomeHot /&gt;</code>得到city参数</br><br>HomeHot组件中接受到city参数</br><br>api中同样接受到参数,注意?符号.</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> homehot = &#123;</span><br><span class="line">    <span class="title function_">homehot1Data</span>(<span class="params">city</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getData</span>(base.<span class="property">homehot1</span>+<span class="string">&quot;?city=&quot;</span>+city)</span><br></pre></td></tr></table></figure>
<p>city如果被选中后又刷新,需要保存之前的数据.</br><br>在City组件中使用<code>localStorage.setItem(&quot;city&quot;,cityName)</code></br><br>之后再componentDidMount中请求city数据可以默认先查看本地是否有数据</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> city = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">city</span> || <span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;city&quot;</span>) ||  <span class="string">&#x27;北京&#x27;</span></span><br></pre></td></tr></table></figure>

<ol start="21">
<li>搜索框</li>
</ol>
<p>搜索框可复用,放在公共组件component中.创建<code>SearchInput</code>组件.绑定相应事件.</br><br>创建<code>src/pages/Search</code>页面.在路由中引入</br><br>搜索框组件中,绑定按下Enter开始搜索</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/components/SearchInput</span></span><br><span class="line">keyUpHandler = <span class="function">(<span class="params">event</span>)=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(event.<span class="property">keyCode</span> === <span class="number">13</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">history</span>.<span class="title function_">push</span>(<span class="string">&#x27;/search&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line">&lt;input onKeyUp=&#123;<span class="variable language_">this</span>.<span class="property">keyUpHandler</span>&#125;/&gt;</span><br></pre></td></tr></table></figure>
<p>由于history在组件SearchInput中并没有(只有直接被路由管理的才有),需要从父组件HomeHeader中获取,也没有,继续向上索取,</br><br>最后在Home组件中获取.<br>22. 搜索页面</p>
<p>搜索后跳转到搜索页面,创建搜索页面的顶部搜索框<SearchHeader>,依旧传入history.</br><br>搜索时所填入的数据需要带到搜索页面,用到路由传参.</br><br>在路由中</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Route</span> path=<span class="string">&quot;/search/:content&quot;</span> component=&#123;<span class="title class_">Search</span>&#125;&gt;&lt;/<span class="title class_">Route</span>&gt;</span><br></pre></td></tr></table></figure>
<p>数据在SearchInput中,将value附加到push的网址后面传递出去.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">history</span>.<span class="title function_">push</span>(<span class="string">&quot;/search/&quot;</span>+<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">value</span>)</span><br></pre></td></tr></table></figure>
<p>获取数据,</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">match</span>.<span class="property">params</span>.<span class="property">content</span></span><br></pre></td></tr></table></figure>

<ol start="23">
<li>搜索服务器</li>
</ol>
<p>创建<code>mock/data/search/index.js</code></br><br>在<code>mock/router.js</code>创建搜索接口</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 搜索接口</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/search&quot;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">    <span class="comment">// 接受参数:city,searchcontent</span></span><br><span class="line">    <span class="keyword">var</span> cityName = url.<span class="title function_">parse</span>(req.<span class="property">url</span>, <span class="literal">true</span>).<span class="property">query</span>.<span class="property">city</span>;</span><br><span class="line">    <span class="keyword">var</span> searchContent = url.<span class="title function_">parse</span>(req.<span class="property">url</span>, <span class="literal">true</span>).<span class="property">query</span>.<span class="property">content</span>;</span><br><span class="line">    <span class="keyword">var</span> page = url.<span class="title function_">parse</span>(req.<span class="property">url</span>, <span class="literal">true</span>).<span class="property">query</span>.<span class="property">page</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;城市：&quot;</span>+cityName,<span class="string">&quot;搜索内容：&quot;</span>+searchContent,<span class="string">&quot;页码：&quot;</span>+page);</span><br><span class="line">    res.<span class="title function_">send</span>(searchData)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ol start="24">
<li>添加API</li>
</ol>
<p>创建<code>api/search</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 搜索接口</span></span><br><span class="line"><span class="keyword">import</span> base <span class="keyword">from</span> <span class="string">&quot;./base&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;getData&#125; <span class="keyword">from</span> <span class="string">&quot;../utils/http&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> search = &#123;</span><br><span class="line">    <span class="title function_">searchData</span>(<span class="params">city,content</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getData</span>(base.<span class="property">search</span>+<span class="string">&quot;?city=&quot;</span>+city+<span class="string">&quot;&amp;content=&quot;</span>+content)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> search</span><br></pre></td></tr></table></figure>
<p><code>/api/index</code>中引入再导出.</p>
<ol start="25">
<li>Search页面</li>
</ol>
<p>创建处理搜索结果的页面SearchList</br><br>SearchList下创建SearchListView</br><br>SearchListView下创建Item</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//SearchList</span></span><br><span class="line"><span class="title function_">componentDidMount</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//获取城市</span></span><br><span class="line">    <span class="keyword">const</span> city = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">city</span></span><br><span class="line">    <span class="comment">//获取搜索内容</span></span><br><span class="line">    <span class="keyword">const</span> content = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">content</span></span><br><span class="line">    api.<span class="property">search</span>.<span class="title function_">searchData</span>(city,content)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">                <span class="attr">searchData</span>: data</span><br><span class="line">            &#125;)               </span><br><span class="line">        &#125;)</span><br><span class="line">&#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;</span></span><br><span class="line"><span class="language-xml">                 this.state.searchData.data ?</span></span><br><span class="line"><span class="language-xml">                 <span class="tag">&lt;<span class="name">SearchListView</span> <span class="attr">data</span>=<span class="string">&#123;this.state.searchData.data&#125;/</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">                 : <span class="tag">&lt;<span class="name">div</span>&gt;</span>数据正在加载<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#125;</span></span><br><span class="line"><span class="language-xml">           <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>SearchListView中将得到的data使用map方法return出Item进行展示.</br><br>Item将data传入组件内.</br><br>组件内将传入的data拆解,渲染.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Item</span></span><br><span class="line"><span class="keyword">const</span> item = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">data</span></span><br><span class="line"><span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;list-item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;item.img&#125;</span> <span class="attr">alt</span>=<span class="string">&#x27;&#x27;</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;mask&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;left&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;item.title&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;item.houseType&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;btn&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    &#123;item.rentType&#125;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span> <span class="attr">dangerouslySetInnerHTML</span>=<span class="string">&#123;&#123;__html:</span> <span class="attr">item.price</span>+&quot;/<span class="attr">月</span>&quot;&#125;&#125;/&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h4 id="再次请求的刷新问题"><a href="#再次请求的刷新问题" class="headerlink" title="再次请求的刷新问题"></a>再次请求的刷新问题</h4><p>在生命周期的<code>componentDidUpdate</code>中再次请求</br><br>这时组件渲染之后加载</br><br>将多次使用的api函数封装成一个函数</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">http</span>(<span class="params">city,content</span>)&#123;</span><br><span class="line">        api.<span class="property">search</span>.<span class="title function_">searchData</span>(city,content)</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">        .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">                <span class="attr">searchData</span>: data</span><br><span class="line">            &#125;)               </span><br><span class="line">        &#125;)</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>
<p>将上面的函数在<code>componentDidMount</code>和<code>componentDidUpdate</code>中分别调用.</br><br>注意这里容易死循环,组件更新后data被setState重新赋值,然后更新,更新后得到新的参数,又继续更新.死循环.</br></p>
<blockquote>
<p>解决办法:<br>加上判断,componentDidUpdate有两个参数,prevProps和prevState,表示上一次的属性和state.</br><br>比较本次搜索的content和上次是否相等,如果是,就return.</br><br>否则,发起网络请求.</br></p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">componentDidUpdate</span>(<span class="params">prevProps,prevState</span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> city = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">city</span></span><br><span class="line">    <span class="keyword">const</span> content = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">content</span></span><br><span class="line">    <span class="keyword">if</span>(prevProps.<span class="property">content</span> === content)&#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">http</span>(city, content)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="26">
<li>搜索详情页的瀑布流</li>
</ol>
<p>封装上拉加载组件<code>LoadMore</code></br><br>判断是否加载到<code>LoadMore</code>，监听滚动事件.</br><br>获取元素偏移量,创建<code>Refs</code>.</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">super</span>()</span><br><span class="line">     <span class="variable language_">this</span>.<span class="property">load</span> = <span class="title class_">React</span>.<span class="title function_">crateRef</span>()</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">componentDidMount</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">onScroll</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">load</span>.<span class="property">current</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&#123;this.load&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>滚动事件需要加上函数防抖,只要滚动就不加载触发函数,稍等100ms后加载一次.这就是函数防抖<code>debounce</code>.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//loadMore.js</span></span><br><span class="line"><span class="title function_">componentDidMount</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="comment">//事件防抖</span></span><br><span class="line"><span class="keyword">let</span> timer = <span class="literal">null</span></span><br><span class="line"><span class="keyword">const</span> winHeight = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onscroll</span> = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(timer)&#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(timer)</span><br><span class="line">    &#125;</span><br><span class="line">    timer = <span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">load</span>.<span class="property">current</span>.<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span> &lt; winHeight)&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">onLoadMore</span>()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,<span class="number">100</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">componentWillUnmount</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 取消滚动事件</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">onscroll</span> = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>数据加载时是会更新数据,需要把新数据和旧数据拼接在一起.注意要设置初始化的state.</br><br>状态上再添加hasMore,判断是否还有数据.</br><br>将SearchData全部更改为[],获取时也就只要获取对象里的data.</br></p>
<p>在SearchList中增加生命周期componentWillUnmount,将请求取消.</br><br>因为页面如果被点击而跳转到其他页面,请求是异步操作,有可能还没返回.</br><br>等回来了数据发现没有state接收请求了,会报错.需要在页面卸载时取消请求.</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//searchList.js</span></span><br><span class="line"><span class="title function_">http</span>(<span class="params">city,content,page</span>)&#123;</span><br><span class="line">    api.<span class="property">search</span>.<span class="title function_">searchData</span>(city,content,page)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">            <span class="attr">searchData</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">searchData</span>.<span class="title function_">concat</span>(data.<span class="property">data</span>),</span><br><span class="line">            <span class="attr">page</span>: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">page</span> + <span class="number">1</span>,</span><br><span class="line">            <span class="attr">hasMore</span>: data.<span class="property">hasMore</span></span><br><span class="line">        &#125;)               </span><br><span class="line">    &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//如果数据请求未完成就跳转到其他页面需要取消网络请求,否则报错</span></span><br><span class="line"><span class="title function_">componentWillUnmount</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// 取消网络请求</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">setState</span> = <span class="function">(<span class="params">state,callback</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>增加页码,修改服务器.<br>注意修改api</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//api/search.js</span></span><br><span class="line"><span class="keyword">const</span> search = &#123;</span><br><span class="line">    <span class="title function_">searchData</span>(<span class="params">city,content,page</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getData</span>(base.<span class="property">search</span>+<span class="string">&quot;?city=&quot;</span>+city+<span class="string">&quot;&amp;content=&quot;</span>+content+<span class="string">&quot;&amp;page=&quot;</span>+page)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>每次做网络请求,page+1.<br>添加hasMore参数,判断是否还有数据.</p>
<ol start="27">
<li>详情页路由配置</li>
</ol>
<p>创建<code>pages/Details</code>.路由中增加详情页.</br><br>在Item页面进行路由传参,item由Link包裹.<code>&lt;Link to=&#123;</code>&#x2F;detail&#x2F;${item.id}<code>&#125;&gt;</code></p>
<ol start="28">
<li>详情页服务端配置</li>
</ol>
<p>创建<code>mock/data/details/index.js</code>.</br><br>在<code>mock/router.js</code>中增加详情接口.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mock/router.js</span></span><br><span class="line"><span class="comment">//详情接口</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/details&quot;</span>, <span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">  <span class="comment">//接收商品id</span></span><br><span class="line">  <span class="keyword">var</span> id = url.<span class="title function_">parse</span>(req.<span class="property">url</span>, <span class="literal">true</span>).<span class="property">query</span>.<span class="property">id</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(id)</span><br><span class="line">  res.<span class="title function_">send</span>(detailData)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>同时导入detailData数据.</p>
<ol start="29">
<li><p>详情页API部分</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//api/details.js</span></span><br><span class="line"><span class="keyword">import</span> base <span class="keyword">from</span> <span class="string">&quot;./base&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123; getData &#125; <span class="keyword">from</span> <span class="string">&quot;../utils/http&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> details = &#123;</span><br><span class="line">    <span class="title function_">detailsData</span>(<span class="params">id</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">getData</span>(base.<span class="property">details</span>+<span class="string">&quot;?id=&quot;</span>+id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> details;</span><br></pre></td></tr></table></figure>
<p>其他文件中增加detail的选项.</p>
</li>
<li><p>detailData分离</p>
</li>
</ol>
<p>创建<code>page/Details/DetailsData</code>.用来请求数据.</br><br>在detail中把id传递进去.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">class</span> <span class="title class_">index</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">datas</span>: &#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> id = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">id</span>;</span><br><span class="line">    api.<span class="property">detail</span></span><br><span class="line">      .<span class="title function_">detailsData</span>(id)</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">      .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">          <span class="attr">datas</span>: data</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;this.state.datas.img ? (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">DetailsDataView</span> <span class="attr">data</span>=<span class="string">&#123;this.state.datas&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        ) : (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span>&gt;</span>数据请求中<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建<code>page/Details/DetailsDataView</code>.用来将请求数据展示出来.</br><br>再把请求到的datas传递给DetailsDataView.</br><br>DetailsDataView需要多个公共组件,可以直接引入.</br></p>
<ol start="31">
<li>Tab切换</li>
</ol>
<p>创建公共组件Tabs.</br><br>使用React.children.map()去遍历子元素.</br><br>绑定onClick事件给点击的绑定高亮.将index赋值给currentIndex.</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;div className=<span class="string">&quot;Tab_title_wrap&quot;</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="title class_">React</span>.<span class="property">Children</span>.<span class="title function_">map</span>(<span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">children</span>, <span class="function">(<span class="params">element,index</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>(</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;this.check_title_index(index)&#125;</span> </span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onClick</span>=<span class="string">&#123;this.tabHandler.bind(this,index)&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;element.props.tabname&#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用函数赋值给className的显隐切换.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">check_title_index = <span class="function"><span class="params">index</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> index === <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">currentIndex</span> ? <span class="string">&quot;Tab_title active&quot;</span> : <span class="string">&quot;Tab_title&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">check_item_index = <span class="function"><span class="params">index</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> index === <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">currentIndex</span> ? <span class="string">&quot;show&quot;</span> : <span class="string">&quot;hide&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="32">
<li><p>将信息放到Tabs内</p>
</li>
<li><p>增加评论服务端数据</p>
</li>
</ol>
<p>创建<code>mock/data/comment</code>.<br>增加<code>mock/router</code>评论接口.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//评论接口</span></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/comment&quot;</span>, <span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">  <span class="comment">//获取商品ID</span></span><br><span class="line">  <span class="keyword">var</span> id = url.<span class="title function_">parse</span>(req.<span class="property">url</span>, <span class="literal">true</span>).<span class="property">query</span>.<span class="property">id</span></span><br><span class="line">  res.<span class="title function_">send</span>(commentData)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ol start="34">
<li><p>增加api中comment</p>
</li>
<li><p>创建详情页DetailData的CommentView组件</br><br>将其中的Item拆分出来</p>
</li>
<li><p>Star组件</p>
</li>
</ol>
<p>创建公共组件Star.</br><br>使用数组判断星星是否高亮.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(star &gt;= <span class="number">5</span>)&#123;</span><br><span class="line">        star = <span class="number">5</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;star-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;[1,2,3,4,5].map((item,index)=&gt;&#123;</span></span><br><span class="line"><span class="language-xml">                let lightClass = star &gt;= item ? &#x27; light&#x27; : &#x27;&#x27;</span></span><br><span class="line"><span class="language-xml">                return(</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">i</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">className</span>=<span class="string">&#123;</span>&#x27;<span class="attr">icon-star</span>&#x27; + <span class="attr">lightClass</span>&#125;&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                )</span></span><br><span class="line"><span class="language-xml">            &#125;)&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="37">
<li>登录页面</li>
</ol>
<p>创建<code>pages/Login</code>页面,储存到Redux.</br><br>引入到路由.</br><br>创建<code>actions/userinfo.js</code></br><br>创建<code>reducers/userinfo.js</code>,将userinfo写到<code>reducers/index.js</code>中.</br></p>
<p>创建<code>pages/Login/LoginView</code>页面.展示登录界面.</br><br>绑定到Login页面,通过绑定事件loginHandler获取user</p>
<ol start="38">
<li>收藏功能</li>
</ol>
<p>新增<code>pages/Details/DetailsData/StoreBuy/StoreBuyView</code>.</br><br>在DetailsDataView中引入.</br><br>收藏页面也增加Redux的连接.点击收藏存在redux中.</br><br>创建Redux一套流程.</br><br>注意此时actions中的收藏初始数据应为数组.</br><br>state存储也是数组形式,</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> collectActions <span class="keyword">from</span> <span class="string">&quot;../constants/collect&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> initState = [];</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">collect</span>(<span class="params">state = initState, action</span>) &#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.<span class="property">type</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> collectActions.<span class="property">COLLECT</span>:</span><br><span class="line">            state.<span class="title function_">push</span>(action.<span class="property">data</span>)</span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">        <span class="keyword">case</span> collectActions.<span class="property">UNCOLLECT</span>:</span><br><span class="line">            <span class="keyword">return</span> state.<span class="title function_">filter</span>(<span class="function">(<span class="params">element</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">//filter作用把当前数组的element遍历,如果和当前所选不等,就是为true</span></span><br><span class="line">                <span class="comment">//就把该element添加到新数组里,否则,不添加,这样就排除了所选元素</span></span><br><span class="line">                <span class="keyword">if</span> (element.<span class="property">id</span> !== action.<span class="property">data</span>.<span class="property">id</span>) &#123;</span><br><span class="line">                    <span class="keyword">return</span> element;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>判断是否收藏.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//StoreBuy</span></span><br><span class="line">storeHandler = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> username = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">userinfo</span>.<span class="property">name</span></span><br><span class="line">    <span class="keyword">const</span> goods_id = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">id</span></span><br><span class="line">    <span class="keyword">if</span>(username)&#123;</span><br><span class="line">        <span class="comment">//调用函数判断</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="title function_">isStore</span>())&#123;</span><br><span class="line">            <span class="comment">//为true,说明有,取消收藏</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">collectActions</span>.<span class="title function_">cancelCollect</span>(&#123;</span><br><span class="line">                <span class="attr">id</span>: goods_id</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//收藏实现</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">collectActions</span>.<span class="title function_">setCollect</span>(&#123;</span><br><span class="line">                <span class="attr">id</span>: goods_id</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//去登陆</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">history</span>.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//收藏判断</span></span><br><span class="line">isStore = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> id = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">id</span></span><br><span class="line">    <span class="keyword">const</span> collects = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">collect</span></span><br><span class="line">    <span class="comment">//some判断集合中是否有该id,有返回true</span></span><br><span class="line">    <span class="keyword">return</span> collects.<span class="title function_">some</span>(<span class="function">(<span class="params">element</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> element.<span class="property">id</span> === id </span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="39">
<li>购物车功能</li>
</ol>
<p>创建<code>pages/ShopCart</code>.</br><br>子组件在创建<code>OrderView</code>和<code>UserView</code></br><br>给<code>HomeHeader</code>中购物车图标增加<code>Link</code>标签跳转.</br><br>进入组件之前判断登录状态.关联redux.</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ShopCart</span></span><br><span class="line"><span class="title function_">componentWillMount</span>(<span class="params"></span>)&#123;</span><br><span class="line"><span class="keyword">const</span> userinfo = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">userinfo</span>.<span class="property">name</span></span><br><span class="line">    <span class="keyword">if</span>(userinfo)&#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//重定向到登录</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">history</span>.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="40">
<li>新增order的服务端数据</li>
</ol>
<p>创建<code>mock/data/order</code>文件夹.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//order</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = [</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>().<span class="title function_">slice</span>(<span class="number">2</span>),</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;东城区 安外大街3号院&quot;</span>,</span><br><span class="line">        <span class="attr">houseType</span>: <span class="string">&quot;1室1厅1卫 - 48m²&quot;</span>,</span><br><span class="line">        <span class="attr">price</span>: <span class="string">&quot;4800&quot;</span>,</span><br><span class="line">        <span class="attr">rentType</span>: <span class="string">&quot;整租&quot;</span>,</span><br><span class="line">        <span class="attr">commentState</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">img</span>: <span class="string">&quot;http://iwenwiki.com/api/livable/shop/z1.jpg&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>().<span class="title function_">slice</span>(<span class="number">2</span>),</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;整租 · 义宾北区2居室-南北&quot;</span>,</span><br><span class="line">        <span class="attr">houseType</span>: <span class="string">&quot;2室1厅1卫 - 78m²&quot;</span>,</span><br><span class="line">        <span class="attr">price</span>: <span class="string">&quot;7200&quot;</span>,</span><br><span class="line">        <span class="attr">rentType</span>: <span class="string">&quot;整租&quot;</span>,</span><br><span class="line">        <span class="attr">commentState</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">img</span>: <span class="string">&quot;http://iwenwiki.com/api/livable/shop/z5.jpg&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="title class_">Math</span>.<span class="title function_">random</span>().<span class="title function_">toString</span>().<span class="title function_">slice</span>(<span class="number">2</span>),</span><br><span class="line">        <span class="attr">title</span>: <span class="string">&quot;整租 · 杨庄北区2居室-南北&quot;</span>,</span><br><span class="line">        <span class="attr">houseType</span>: <span class="string">&quot;1室1厅1卫 - 48m²&quot;</span>,</span><br><span class="line">        <span class="attr">price</span>: <span class="string">&quot;4300&quot;</span>,</span><br><span class="line">        <span class="attr">rentType</span>: <span class="string">&quot;整租&quot;</span>,</span><br><span class="line">        <span class="attr">commentState</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">img</span>: <span class="string">&quot;http://iwenwiki.com/api/livable/shop/z6.jpg&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<p><code>mock/router.js</code>中新增order.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 购物车</span></span><br><span class="line"></span><br><span class="line">router.<span class="title function_">get</span>(<span class="string">&quot;/car&quot;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> user =  url.<span class="title function_">parse</span>(req.<span class="property">url</span>, <span class="literal">true</span>).<span class="property">query</span>.<span class="property">user</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;用户：&quot;</span>+user);</span><br><span class="line">  res.<span class="title function_">send</span>(orderComment)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/ordercomment&quot;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> info = req.<span class="property">body</span>.<span class="property">info</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;评论信息：&quot;</span>+info);</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">msg</span>:<span class="string">&#x27;评价成功&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ol start="41">
<li>新增order的api</li>
</ol>
<p>创建<code>api/order</code>和<code>api/ordercomment</code>.</br><br>在<code>base.js</code>中新增order和ordercomment的路由.</br><br>在<code>index.js</code>中新增order和ordercomment的引入.</br><br>购物车评价接口需要写入数据,所以是postData.</br></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ordercomment.js</span></span><br><span class="line"><span class="comment">// 订单评价接口</span></span><br><span class="line"><span class="keyword">import</span> base <span class="keyword">from</span> <span class="string">&quot;./base&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;postData&#125; <span class="keyword">from</span> <span class="string">&quot;../utils/http&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> orderComment = &#123;</span><br><span class="line">    <span class="title function_">orderCommentData</span>(<span class="params">info</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">postData</span>(base.<span class="property">ordercomment</span>,info)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> orderComment</span><br></pre></td></tr></table></figure>

<ol start="42">
<li>网络请求</li>
</ol>
<p>引入api,在登录后发送网络请求</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//shopcar</span></span><br><span class="line"><span class="title function_">componentWillMount</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> userinfo = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">userinfo</span>.<span class="property">name</span></span><br><span class="line">    <span class="keyword">if</span>(userinfo)&#123;</span><br><span class="line">    <span class="comment">//网络请求</span></span><br><span class="line">    api.<span class="property">order</span>.<span class="title function_">orderData</span>(userinfo)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>res.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">data</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">            <span class="attr">order</span>: data</span><br><span class="line">        &#125;)       </span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//重定向到登录</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">history</span>.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>把数据order传给<code>&lt;OrderView /&gt;</code>.</br><br>还是先判断数据是否到来</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">order</span>.<span class="property">length</span> &gt; <span class="number">0</span> ?</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">OrderView</span> <span class="attr">data</span>=<span class="string">&#123;this.state.order&#125;</span> /&gt;</span></span></span><br><span class="line">    : <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>数据加载中<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="43">
<li>数据接收渲染</li>
</ol>
<p>OrderView接收上级传过来的数据,使用map渲染到页面.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">order</span></span><br><span class="line">    <span class="keyword">return</span>(</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;data.map(item, index)=&gt;&#123;</span></span><br><span class="line"><span class="language-xml">                return <span class="tag">&lt;<span class="name">Item</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">data</span>=<span class="string">&#123;item&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<ol start="44">
<li>Item渲染<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> data = <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">data</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;clear-fix order-item-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;order-item-img float-left&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;data.img&#125;</span> <span class="attr">alt</span>=<span class="string">&#123;data.title&#125;/</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;order-item-comment float-right&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#123;</span></span><br><span class="line"><span class="language-xml">                    data.commentState === 0?</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>评价<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    : <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&quot;btn  unselected-btn&quot;</span>&gt;</span>已评价<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                &#125;</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;order-item-content&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>商户:&#123;data.title&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>类型:&#123;data.houseType&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>价格:&#123;data.price&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>添加评价</li>
</ol>
<p>给评价绑定事件.</br><br>评价状态commentState的值0,1,2分别代表未评价,评价中,已评价.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">commentState</span> === <span class="number">0</span> ?</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;this.commentHandler</span> &#125;&gt;</span>评价<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">: <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">commentState</span> === <span class="number">1</span> ?</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&quot;btn&quot;</span>&gt;</span>评价中<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">: <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&quot;btn  unselected-btn&quot;</span>&gt;</span>已评价<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<ol start="46">
<li><p>添加评价框</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">commentState</span> === <span class="number">1</span> ?</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;comment-text-container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> &#x27;<span class="attr">100</span>%&#x27;, <span class="attr">height:</span> &#x27;<span class="attr">80px</span>&#x27; &#125;&#125; <span class="attr">className</span>=<span class="string">&quot;comment-text&quot;</span> <span class="attr">ref</span>=<span class="string">&#123;</span> <span class="attr">this.commentText</span> &#125;&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&quot;btn&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;this.submitCommentHandler&#125;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="symbol">&amp;nbsp;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&quot;btn unseleted-btn&quot;</span> <span class="attr">onClick</span>=<span class="string">&#123;this.hideComment&#125;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">:  <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>评价事件提交到后台</p>
</li>
</ol>
<p>后台mock&#x2F;router里创建评价接口.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mock/router.js</span></span><br><span class="line">router.<span class="title function_">post</span>(<span class="string">&quot;/ordercomment&quot;</span>,<span class="keyword">function</span>(<span class="params">req,res</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> info = req.<span class="property">body</span>.<span class="property">info</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;评论信息：&quot;</span>+info);</span><br><span class="line">  res.<span class="title function_">send</span>(&#123;</span><br><span class="line">      <span class="attr">msg</span>:<span class="string">&#x27;评价成功&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p><code>mock/index.js</code>中添加解析.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//mock/index.js</span></span><br><span class="line"><span class="keyword">var</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;</span><br><span class="line">    <span class="attr">extended</span>: <span class="literal">true</span></span><br><span class="line">&#125;))</span><br></pre></td></tr></table></figure>
<ol start="51">
<li>增加相关API</li>
</ol>
<p>创建<code>api/ordercomment</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 订单评价接口</span></span><br><span class="line"><span class="keyword">import</span> base <span class="keyword">from</span> <span class="string">&quot;./base&quot;</span></span><br><span class="line"><span class="keyword">import</span> &#123;postData&#125; <span class="keyword">from</span> <span class="string">&quot;../utils/http&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> orderComment = &#123;</span><br><span class="line">    <span class="title function_">orderCommentData</span>(<span class="params">info</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">postData</span>(base.<span class="property">ordercomment</span>,info)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> orderComment</span><br></pre></td></tr></table></figure>
<ol start="52">
<li>创建非受控组件<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">commentText</span> = <span class="title class_">React</span>.<span class="title function_">createRef</span>()</span><br><span class="line"></span><br><span class="line"><span class="title function_">submitCommentHandler</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">commentState</span>:<span class="number">2</span></span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">// 发送网络请求</span></span><br><span class="line">    api.<span class="property">orderComment</span>.<span class="title function_">orderCommentData</span>(&#123;</span><br><span class="line">        <span class="attr">info</span>:<span class="variable language_">this</span>.<span class="property">commentText</span>.<span class="property">current</span>.<span class="property">value</span></span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">res</span> =&gt;</span> res.<span class="title function_">json</span>())</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function"><span class="params">data</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="title function_">alert</span>(data.<span class="property">msg</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&lt;textarea ref=&#123;<span class="variable language_">this</span>.<span class="property">commentText</span>&#125;&gt;&lt;/textarea&gt;</span><br></pre></td></tr></table></figure>
页面暂时写这么多.</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2020/09/03/React%E7%A7%BB%E5%8A%A8%E7%AB%AF%E9%A1%B9%E7%9B%AE-%E5%AE%9C%E5%B1%85%E7%A7%9F%E6%88%BF/" data-id="cl9xpujqp001bdmopd20ha6sw" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/02/22/yuque/node%E7%88%AC%E8%99%AB%E5%85%A5%E9%97%A8/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          node爬虫入门
        
      </div>
    </a>
  
  
    <a href="/2020/08/28/Todo/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Todo</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">分类</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/HTML/">HTML</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HTML/HTML%E5%9F%BA%E7%A1%80/">HTML基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTML/HTTP%E5%9F%BA%E7%A1%80/">HTTP基础</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTML5/">HTML5</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/HTML5/canvas/">canvas</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/">JS</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/JS/ES6/">ES6</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/JS%E5%9F%BA%E7%A1%80/">JS基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/JS%E8%BF%9B%E9%98%B6/">JS进阶</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/jQuery/">jQuery</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/JS/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/">前端工程化</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/css/">css</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/css/css3/">css3</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%90%8E%E7%AB%AF/">后端</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/%E5%90%8E%E7%AB%AF/Node-js/">Node.js</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTML/" rel="tag">HTML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP%E5%AE%89%E5%85%A8/" rel="tag">HTTP安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP%E8%BF%9B%E9%98%B6/" rel="tag">HTTP进阶</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS/" rel="tag">JS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS%E6%B7%B1%E5%85%A5/" rel="tag">JS深入</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JS%E8%BF%9B%E9%98%B6/" rel="tag">JS进阶</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue-SSR/" rel="tag">Vue-SSR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue-js/" rel="tag">Vue.js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue-js%E5%9F%BA%E7%A1%80/" rel="tag">Vue.js基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Vue-js%E8%BF%9B%E9%98%B6/" rel="tag">Vue.js进阶</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/" rel="tag">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css3/" rel="tag">css3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html5/" rel="tag">html5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%8E%E7%AB%AF/" rel="tag">后端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%BA%E7%A1%80/" rel="tag">基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">小程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/" rel="tag">移动端</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" rel="tag">面试题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE/" rel="tag">项目</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/HTML/" style="font-size: 18.57px;">HTML</a> <a href="/tags/HTTP%E5%AE%89%E5%85%A8/" style="font-size: 10px;">HTTP安全</a> <a href="/tags/HTTP%E8%BF%9B%E9%98%B6/" style="font-size: 10px;">HTTP进阶</a> <a href="/tags/JS/" style="font-size: 12.86px;">JS</a> <a href="/tags/JS%E6%B7%B1%E5%85%A5/" style="font-size: 10px;">JS深入</a> <a href="/tags/JS%E8%BF%9B%E9%98%B6/" style="font-size: 11.43px;">JS进阶</a> <a href="/tags/React/" style="font-size: 17.14px;">React</a> <a href="/tags/Vue-SSR/" style="font-size: 15.71px;">Vue-SSR</a> <a href="/tags/Vue-js/" style="font-size: 20px;">Vue.js</a> <a href="/tags/Vue-js%E5%9F%BA%E7%A1%80/" style="font-size: 11.43px;">Vue.js基础</a> <a href="/tags/Vue-js%E8%BF%9B%E9%98%B6/" style="font-size: 17.14px;">Vue.js进阶</a> <a href="/tags/android/" style="font-size: 11.43px;">android</a> <a href="/tags/css/" style="font-size: 14.29px;">css</a> <a href="/tags/css3/" style="font-size: 11.43px;">css3</a> <a href="/tags/html5/" style="font-size: 12.86px;">html5</a> <a href="/tags/javascript/" style="font-size: 15.71px;">javascript</a> <a href="/tags/%E5%90%8E%E7%AB%AF/" style="font-size: 11.43px;">后端</a> <a href="/tags/%E5%9F%BA%E7%A1%80/" style="font-size: 11.43px;">基础</a> <a href="/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/" style="font-size: 11.43px;">小程序</a> <a href="/tags/%E7%A7%BB%E5%8A%A8%E7%AB%AF/" style="font-size: 10px;">移动端</a> <a href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/" style="font-size: 14.29px;">面试题</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 12.86px;">项目</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/11/">十一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/10/">十月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/09/">九月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/08/">八月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/07/">七月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/06/">六月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/02/">二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/01/">一月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/12/">十二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/11/">十一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/09/">九月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">八月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/06/">六月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">三月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">二月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/11/01/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2022/10/25/yuque/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/">自动化构建工具</a>
          </li>
        
          <li>
            <a href="/2022/10/25/yuque/%E8%84%9A%E6%89%8B%E6%9E%B6/">脚手架</a>
          </li>
        
          <li>
            <a href="/2022/10/24/yuque/React%20Query/">React Query</a>
          </li>
        
          <li>
            <a href="/2022/10/19/yuque/%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6/">常用组件</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Zax Tseng<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>