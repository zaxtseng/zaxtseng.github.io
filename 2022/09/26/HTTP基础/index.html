<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.13.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="title: HTTP基础 date: 2019-08-21 14:53:32 tags: HTML categories:  # 这里写的分类会自动汇集到 categories 页面上，分类可以多级  HTML # 一级分类 HTTP基础 # 二级分类   ajaxajax 是一种技术方案，核心依赖浏览器提供的 XMLHttpRequest 对象，是这个对象使得浏览器可以发出 http 请求与">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTP基础">
<meta property="og:url" content="http://example.com/2022/09/26/HTTP%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="ZAX">
<meta property="og:description" content="title: HTTP基础 date: 2019-08-21 14:53:32 tags: HTML categories:  # 这里写的分类会自动汇集到 categories 页面上，分类可以多级  HTML # 一级分类 HTTP基础 # 二级分类   ajaxajax 是一种技术方案，核心依赖浏览器提供的 XMLHttpRequest 对象，是这个对象使得浏览器可以发出 http 请求与">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2022-09-26T13:08:25.000Z">
<meta property="article:modified_time" content="2022-11-11T06:46:38.299Z">
<meta property="article:author" content="Zax Tseng">
<meta property="article:tag" content="javascript, React, Vue, HTML5">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/2022/09/26/HTTP%E5%9F%BA%E7%A1%80/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"http://example.com/2022/09/26/HTTP%E5%9F%BA%E7%A1%80/","path":"2022/09/26/HTTP基础/","title":"HTTP基础"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>HTTP基础 | ZAX</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">ZAX</p>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ajax"><span class="nav-number">1.</span> <span class="nav-text">ajax</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E4%B8%8E%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92"><span class="nav-number">1.1.</span> <span class="nav-text">如何与后端交互</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E6%96%B9%E6%B3%95"><span class="nav-number">1.1.1.</span> <span class="nav-text">实现方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8C%83%E4%BE%8B"><span class="nav-number">1.1.2.</span> <span class="nav-text">范例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Fetch"><span class="nav-number">1.1.3.</span> <span class="nav-text">Fetch</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#API"><span class="nav-number">1.1.4.</span> <span class="nav-text">API</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B7%A8%E5%9F%9F"><span class="nav-number">2.</span> <span class="nav-text">跨域</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%8C%E6%BA%90%E7%AD%96%E7%95%A5"><span class="nav-number">2.0.1.</span> <span class="nav-text">同源策略</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E8%B7%A8%E5%9F%9F%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">3.</span> <span class="nav-text">实现跨域的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#JSONP"><span class="nav-number">3.1.</span> <span class="nav-text">JSONP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%85%E8%80%83%E9%9D%A2%E8%AF%95%E9%A2%98%EF%BC%9AJSONP-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E6%94%AF%E6%8C%81-POST-%E8%AF%B7%E6%B1%82"><span class="nav-number">3.1.1.</span> <span class="nav-text">必考面试题：JSONP 为什么不支持 POST 请求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#jquery-%E7%9A%84%E5%86%99%E6%B3%95"><span class="nav-number">3.1.2.</span> <span class="nav-text">jquery 的写法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#axios-%E5%86%99%E6%B3%95"><span class="nav-number">3.1.3.</span> <span class="nav-text">axios 写法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CORS"><span class="nav-number">3.2.</span> <span class="nav-text">CORS</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#postMessage"><span class="nav-number">3.3.</span> <span class="nav-text">postMessage</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%A8%E6%84%8F%E7%82%B9%EF%BC%81%EF%BC%81%EF%BC%81"><span class="nav-number">3.3.1.</span> <span class="nav-text">注意点！！！</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#window-postMessage-%E4%B8%AD%E7%9A%84-window-%E5%88%B0%E5%BA%95%E6%98%AF%E5%95%A5%EF%BC%9F"><span class="nav-number">3.3.1.1.</span> <span class="nav-text">window.postMessage()中的 window 到底是啥？</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9C%80%E8%A6%81%E7%89%B9%E5%88%AB%E6%B3%A8%E6%84%8F%E7%9A%84%E5%9D%91"><span class="nav-number">3.3.2.</span> <span class="nav-text">需要特别注意的坑</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#websocket-%E5%8D%8F%E8%AE%AE%E8%B7%A8%E5%9F%9F"><span class="nav-number">4.</span> <span class="nav-text">websocket 协议跨域</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%A0%87%E7%AD%BE"><span class="nav-number">5.</span> <span class="nav-text">标签</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#iframe"><span class="nav-number">5.1.</span> <span class="nav-text">iframe</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#canvas"><span class="nav-number">5.2.</span> <span class="nav-text">canvas</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#source"><span class="nav-number">5.3.</span> <span class="nav-text">source</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#command"><span class="nav-number">5.4.</span> <span class="nav-text">command</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#figure"><span class="nav-number">5.5.</span> <span class="nav-text">figure</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#nav"><span class="nav-number">5.6.</span> <span class="nav-text">nav</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#section"><span class="nav-number">5.7.</span> <span class="nav-text">section</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTP-%E6%8A%A5%E6%96%87"><span class="nav-number">6.</span> <span class="nav-text">HTTP 报文</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#URI-%E5%92%8C-URL"><span class="nav-number">6.1.</span> <span class="nav-text">URI 和 URL</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%A5%E6%96%87%E7%BB%84%E6%88%90"><span class="nav-number">6.2.</span> <span class="nav-text">报文组成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%A5%E6%96%87%E8%AF%AD%E6%B3%95"><span class="nav-number">6.3.</span> <span class="nav-text">报文语法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8A%B6%E6%80%81%E7%A0%81"><span class="nav-number">6.4.</span> <span class="nav-text">状态码</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E7%B1%BB"><span class="nav-number">6.4.1.</span> <span class="nav-text">分类:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP-%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95"><span class="nav-number">6.5.</span> <span class="nav-text">HTTP 请求方法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98"><span class="nav-number">7.</span> <span class="nav-text">浏览器缓存</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#cache-control"><span class="nav-number">7.0.1.</span> <span class="nav-text">cache-control</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ETag"><span class="nav-number">7.0.2.</span> <span class="nav-text">ETag</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#cookie"><span class="nav-number">8.</span> <span class="nav-text">cookie</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#session"><span class="nav-number">9.</span> <span class="nav-text">session</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#localStorage"><span class="nav-number">10.</span> <span class="nav-text">localStorage</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#localStorage-%E7%9A%84%E5%AD%98%E5%82%A8-%E8%8E%B7%E5%8F%96-%E5%88%A0%E9%99%A4"><span class="nav-number">10.1.</span> <span class="nav-text">localStorage 的存储,获取,删除</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#sessionstorage"><span class="nav-number">11.</span> <span class="nav-text">sessionstorage</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6%E9%80%9A%E4%BF%97%E8%AF%AD%E8%A8%80%E7%89%88-%E8%87%AA%E6%88%91%E7%90%86%E8%A7%A3"><span class="nav-number">11.1.</span> <span class="nav-text">浏览器缓存机制通俗语言版(自我理解)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%A5%E8%B0%A8%E8%AF%B4%E6%B3%95"><span class="nav-number">11.2.</span> <span class="nav-text">严谨说法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#HTTPS-%E5%8E%9F%E7%90%86"><span class="nav-number">12.</span> <span class="nav-text">HTTPS 原理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%EF%BC%9A"><span class="nav-number">12.1.</span> <span class="nav-text">加密算法：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E9%80%9A%E4%BF%A1%E6%B5%81%E7%A8%8B"><span class="nav-number">13.</span> <span class="nav-text">简单通信流程</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">14.</span> <span class="nav-text">存在的问题</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%81%E4%B9%A6%E5%8F%AF%E8%83%BD%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-number">14.1.</span> <span class="nav-text">证书可能存在的问题</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2%E4%BB%8E%E8%BE%93%E5%85%A5-URL-%E5%88%B0%E9%A1%B5%E9%9D%A2%E5%8A%A0%E8%BD%BD%E6%98%BE%E7%A4%BA%E5%AE%8C%E6%88%90%EF%BC%8C%E8%BF%99%E4%B8%AA%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%83%BD%E5%8F%91%E7%94%9F%E4%BA%86%E4%BB%80%E4%B9%88%EF%BC%9F%EF%BC%88%E6%B5%81%E7%A8%8B%E8%AF%B4%E7%9A%84%E8%B6%8A%E8%AF%A6%E7%BB%86%E8%B6%8A%E5%A5%BD%EF%BC%89"><span class="nav-number">15.</span> <span class="nav-text">一个页面从输入 URL 到页面加载显示完成，这个过程中都发生了什么？（流程说的越详细越好）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AF%A6%E7%BB%86%E7%89%88%EF%BC%9A"><span class="nav-number">15.1.</span> <span class="nav-text">详细版：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AE%80%E6%B4%81%E7%89%88%EF%BC%9A"><span class="nav-number">15.2.</span> <span class="nav-text">简洁版：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WebSocket-%E5%8D%8F%E8%AE%AE"><span class="nav-number">16.</span> <span class="nav-text">WebSocket 协议</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81-WebSocket"><span class="nav-number">16.1.</span> <span class="nav-text">1.为什么需要 WebSocket</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-WebSocket-%E7%89%B9%E7%82%B9"><span class="nav-number">16.2.</span> <span class="nav-text">2.WebSocket 特点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%A4%BA%E4%BE%8B"><span class="nav-number">16.2.1.</span> <span class="nav-text">客户端示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WebSocket-%E5%AE%A2%E6%88%B7%E7%AB%AF-API"><span class="nav-number">16.3.</span> <span class="nav-text">WebSocket 客户端 API</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#WebSocket-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="nav-number">16.3.1.</span> <span class="nav-text">WebSocket 构造函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WebSocket-readyState"><span class="nav-number">16.3.2.</span> <span class="nav-text">WebSocket.readyState</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WebSocket-onopen"><span class="nav-number">16.3.3.</span> <span class="nav-text">WebSocket.onopen</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WebSocket-onclose"><span class="nav-number">16.3.4.</span> <span class="nav-text">WebSocket.onclose</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Zax Tseng</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">109</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/HTTP%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="HTTP基础 | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HTTP基础
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:08:25" itemprop="dateCreated datePublished" datetime="2022-09-26T21:08:25+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-11-11 14:46:38" itemprop="dateModified" datetime="2022-11-11T14:46:38+08:00">2022-11-11</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <hr>
<p>title: HTTP基础</p>
<p>date: 2019-08-21 14:53:32</p>
<p>tags: HTML</p>
<p>categories:  # 这里写的分类会自动汇集到 categories 页面上，分类可以多级</p>
<ul>
<li>HTML # 一级分类</li>
<li>HTTP基础 # 二级分类</li>
</ul>
<hr>
<h1 id="ajax"><a href="#ajax" class="headerlink" title="ajax"></a>ajax</h1><p>ajax 是一种技术方案，核心依赖浏览器提供的 XMLHttpRequest 对象，是这个对象使得浏览器可以发出 http 请求与接受响应。</p>
<h2 id="如何与后端交互"><a href="#如何与后端交互" class="headerlink" title="如何与后端交互"></a>如何与后端交互</h2><ol>
<li>form 表单提交.缺点会跳转，无后台反馈</li>
<li>ajax</li>
<li>websocket</li>
</ol>
<h3 id="实现方法"><a href="#实现方法" class="headerlink" title="实现方法"></a>实现方法</h3><ol>
<li>XMLHttpRequest 对象(该对象支持同步和异步请求)</li>
<li>fetch</li>
</ol>
<h3 id="范例"><a href="#范例" class="headerlink" title="范例"></a>范例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequst</span>()</span><br><span class="line"><span class="comment">//true默认是异步的方式,false是同步的方式</span></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;get&quot;</span>, <span class="string">&quot;/xxx.com&quot;</span>, <span class="literal">true</span>)</span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> ((xhr.<span class="property">status</span> &gt;= <span class="number">200</span> &amp;&amp; xhr.<span class="property">status</span> &lt; <span class="number">300</span>) || xhr.<span class="property">status</span> === <span class="number">304</span>) &#123;</span><br><span class="line">            <span class="comment">//成功</span></span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(xhr.<span class="property">responseText</span>)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;服务器异常&quot;</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//发送请求</span></span><br><span class="line">xhr.<span class="title function_">send</span>()</span><br></pre></td></tr></table></figure>

<h3 id="Fetch"><a href="#Fetch" class="headerlink" title="Fetch"></a>Fetch</h3><p>fetch 基于 promise</p>
<p>当接受到错误状态码时,conf<code>fetch()</code>返回的 promise 不会标记为 reject</p>
<p>默认情况下,fetch 不会从服务端发送或接收任何 cookies.</p>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span> <span class="keyword">let</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>();</span><br><span class="line"><span class="number">2.</span> xhr.<span class="title function_">open</span>(<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;/xxx&#x27;</span>)  <span class="comment">//初始化xhr</span></span><br><span class="line"><span class="number">3.</span> xhr.<span class="title function_">send</span>()  <span class="comment">//发送请求</span></span><br><span class="line"><span class="number">4.</span> xhr.<span class="property">onreadystatechange</span>  <span class="comment">//监听请求状态的变化&lt;readystatechange&gt;是一个事件</span></span><br><span class="line"><span class="number">5.</span> xhr.<span class="property">readyState</span> === <span class="number">1</span>  <span class="comment">//xhr.open()已经完成</span></span><br><span class="line"><span class="number">6.</span> xhr.<span class="property">readyState</span> === <span class="number">2</span>  <span class="comment">//xhr.send()已经完成</span></span><br><span class="line"><span class="number">7.</span> xhr.<span class="property">readyState</span> === <span class="number">3</span>  <span class="comment">//xhr.responseText正在下载</span></span><br><span class="line"><span class="number">5.</span> xhr.<span class="property">readyState</span> === <span class="number">4</span>  <span class="comment">//响应完成</span></span><br><span class="line"><span class="number">6.</span> xhr.<span class="property">status</span>  <span class="comment">//HTTP状态码</span></span><br><span class="line"><span class="number">7.</span> <span class="keyword">var</span> string = xhr.<span class="property">responseText</span>  <span class="comment">//响应的内容</span></span><br><span class="line"><span class="number">8.</span> <span class="keyword">var</span> value = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(xhr.<span class="property">responseText</span>)  <span class="comment">//把符合JSON语法的字符串转换成JS，解析响应返回的内容</span></span><br><span class="line"><span class="number">9.</span> value.<span class="property">node</span>   <span class="comment">//若value是对象，这就是对象里内容</span></span><br><span class="line"><span class="number">10.</span> value.<span class="property">node</span>.<span class="property">name</span>  <span class="comment">//对象里的name的值</span></span><br></pre></td></tr></table></figure>

<p><strong>post</strong>形式需要将数据放入到 send 中</p>
<h1 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h1><h3 id="同源策略"><a href="#同源策略" class="headerlink" title="同源策略"></a>同源策略</h3><p>同协议，域名，端口</p>
<h1 id="实现跨域的方法"><a href="#实现跨域的方法" class="headerlink" title="实现跨域的方法"></a>实现跨域的方法</h1><h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h2><p>JSON with padding</p>
<blockquote>
<p>通过 script 标签加载数据的方式获取数据当做 js 代码来执行。jsonp 需要对应接口的后端配合才可以实现。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">addScriptTag</span>(<span class="params">src</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line">  script.<span class="title function_">setAttribute</span>(<span class="string">&quot;type&quot;</span>, <span class="string">&quot;text/javascript&quot;</span>);</span><br><span class="line">  script.<span class="property">src</span> = src;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">addScriptTag</span>(<span class="string">&quot;http://example.com/ip?callback=foo&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Your public IP address is: &quot;</span> + data.<span class="property">ip</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>上面代码通过动态添加<code>&lt;script&gt;</code>元素，向服务器 example.com 发出请求。注意，该请求的查询字符串有一个 callback 参数，用来指定回调函数的名字，这对于 JSONP 是必需的。</p>
</blockquote>
<p>服务器收到这个请求以后，会将数据放在回调函数的参数位置返回。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">foo</span>(&#123;</span><br><span class="line">  <span class="attr">ip</span>: <span class="string">&quot;8.8.8.8&quot;</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>由于<code>&lt;script&gt;</code>元素请求的脚本，直接作为代码运行。这时，只要浏览器定义了 foo 函数，该函数就会立即调用。作为参数的 JSON 数据被视为 JavaScript 对象，而不是字符串，因此避免了使用<code>JSON.parse</code>的步骤。</p>
</blockquote>
<h3 id="必考面试题：JSONP-为什么不支持-POST-请求"><a href="#必考面试题：JSONP-为什么不支持-POST-请求" class="headerlink" title="必考面试题：JSONP 为什么不支持 POST 请求"></a>必考面试题：JSONP 为什么不支持 POST 请求</h3><p>答：因为 JSONP 是通过动态创建 script 的方法进行的，而 script 只能发送 get 请求不能发送 post 请求。</p>
<h3 id="jquery-的写法"><a href="#jquery-的写法" class="headerlink" title="jquery 的写法"></a>jquery 的写法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$.<span class="title function_">ajax</span>(&#123;</span><br><span class="line">        <span class="attr">url</span>:<span class="string">&quot;http://jack.com:8002/pay&quot;</span>,</span><br><span class="line">        <span class="attr">dataType</span>: <span class="string">&quot;jsonp&quot;</span>,</span><br><span class="line">        <span class="attr">success</span>:<span class="keyword">function</span> (<span class="params">response</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(response)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure>

<h3 id="axios-写法"><a href="#axios-写法" class="headerlink" title="axios 写法"></a>axios 写法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$http</span> = axios;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$http</span></span><br><span class="line">  .<span class="title function_">jsonp</span>(<span class="string">&quot;http://www.domain2.com:8080/login&quot;</span>, &#123;</span><br><span class="line">    <span class="attr">params</span>: &#123;&#125;,</span><br><span class="line">    <span class="attr">jsonp</span>: <span class="string">&quot;handleCallback&quot;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res);</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h2><p>跨域资源共享，是一种 ajax 跨域请求资源的方式。</p>
<p>写法就是普通的 ajax 写法.不过在浏览器请求上加点处理.而且是浏览器自动处理的.</p>
<p>当使用 XMLHttpRequest 发送请求时，浏览器发现该请求不符合同源策略，会给请求加一个请求头:<code>Origin</code>。</p>
<p>后台进行处理，如果确定接受请求，则在返回结果中加响应头：<code>Access-Control-Allow-Origin</code>。</p>
<p>浏览器判断该响应头中是否包含<code>Origin</code>的值，如果有，浏览器会处理响应，就可以拿到响应数据。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> <span class="title class_">XMLHttpRequest</span>(); <span class="comment">// IE8/9需用window.XDomainRequest兼容</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 前端设置是否带cookie</span></span><br><span class="line">xhr.<span class="property">withCredentials</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">xhr.<span class="title function_">open</span>(<span class="string">&quot;post&quot;</span>, <span class="string">&quot;http://www.domain2.com:8080/login&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">xhr.<span class="title function_">setRequestHeader</span>(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/x-www-form-urlencoded&quot;</span>);</span><br><span class="line">xhr.<span class="title function_">send</span>(<span class="string">&quot;user=admin&quot;</span>);</span><br><span class="line"></span><br><span class="line">xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (xhr.<span class="property">readyState</span> == <span class="number">4</span> &amp;&amp; xhr.<span class="property">status</span> == <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(xhr.<span class="property">responseText</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="postMessage"><a href="#postMessage" class="headerlink" title="postMessage"></a>postMessage</h2><ol>
<li><strong>A 页面</strong></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;message&#x27;</span>, <span class="variable language_">this</span>.<span class="property">receiveMessage</span>, <span class="literal">false</span>)</span><br><span class="line">    <span class="keyword">const</span> iframeImg = <span class="variable language_">this</span>.<span class="property">iframe</span>.<span class="property">contentWindow</span></span><br><span class="line">    iframeImg.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        iframeImg.<span class="title function_">postMessage</span>(<span class="string">&#x27;message&#x27;</span>, <span class="string">&#x27;http://www.blogoog.com:8088&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">receiveMessage = <span class="function">(<span class="params">event</span>) =&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">const</span> origin = event.<span class="property">origin</span> || event.<span class="property">originalEvent</span>.<span class="property">origin</span></span><br><span class="line">        <span class="keyword">const</span> thisData = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(event.<span class="property">data</span>)</span><br><span class="line">        <span class="keyword">const</span> imgUrl = <span class="title class_">Object</span>.<span class="title function_">values</span>(thisData)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123; imgUrl &#125;)</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span>&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">closeIframe</span>();</span><br><span class="line">            message.<span class="title function_">success</span>(<span class="string">&#x27;上传成功&#x27;</span>)</span><br><span class="line">        &#125;,<span class="number">1000</span>)</span><br><span class="line">        <span class="keyword">if</span> (origin !== <span class="string">&#x27;http://www.blogoog.com:80881) &#123;</span></span><br><span class="line"><span class="string">          window.location.hash = &#x27;</span>#/exception/<span class="number">404</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe</span><br><span class="line">  className=&#123;styles.<span class="property">iframeWrap</span>&#125;</span><br><span class="line">  src=<span class="string">&quot;http://www.blogoog.com:8088&quot;</span></span><br><span class="line">  name=<span class="string">&quot;imgIframe&quot;</span></span><br><span class="line">  frameBorder=<span class="string">&quot;0&quot;</span></span><br><span class="line">  scrolling=<span class="string">&quot;auto&quot;</span></span><br><span class="line">  ref=&#123;<span class="function">(<span class="params">dom</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">iframe</span> = dom;</span><br><span class="line">  &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">  您的浏览器不支持iframe</span><br><span class="line">&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<ol>
<li>A 页面使用的语法</li>
</ol>
<p><strong>window.postMessage()</strong></p>
<p><code>otherWindow.postMessage(message, targetOrigin, [transfer])</code></p>
<ul>
<li>otherWindow：其他窗口的一个引用（在这里我使用了 iframe 的 contentWindow 属性）</li>
<li>message：将要发送到其他 window 的数据（可以不受限制的将数据对象安全的传送给目标窗口而无需自己序列化，原因是因为采用了结构化克隆算法）</li>
<li>targetOrigin：接收信息的 URL（在这里我当然填的 B 页面的 URL）</li>
<li>transfer：可选参数</li>
</ul>
<p><strong>window.addEventListener(‘message’, receiveMessage, false)</strong></p>
<p><code>target.addEventListener(type, listener, options)</code></p>
<ul>
<li>type：表示监听事件类型的字符串</li>
<li>listener：当所监听的事件类型触发时，会通知的一个对象或者一个函数</li>
<li>potions：可选参数（在此我用 false，表示在 listener 被调用之后不会自动移除）</li>
</ul>
<p><strong>receiveMessage &#x3D; (event) &#x3D;&gt; {}</strong></p>
<ul>
<li>event.data：从另一个 window 传递过来的对象（包含传递过来的所有信息）</li>
<li>event.origin||event.originalEvent.origin：window.postMessage()发送消息的目标 URL</li>
<li>event.source：对发送消息的窗口对象的引用</li>
</ul>
<h3 id="注意点！！！"><a href="#注意点！！！" class="headerlink" title="注意点！！！"></a>注意点！！！</h3><ul>
<li>在页面内嵌入 iframe 页面的情况下，需要等到页面内的 iframe 页面，也就是 B 页面加载完成之后，才能进行 postMessage 跨域通信</li>
<li>event.origin 中的 origin 不能保证是该窗口的当前 origin 或者未来 origin，因为 postMessage 被调用后，可能会被导航到不同的位置，所以需要做个异常情况判断处理<code>origin !== &#39;http://www.blogoog.com:8088&#39;</code></li>
</ul>
<ol start="2">
<li><strong>B 页面</strong></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">addEventListener</span>&#123;<span class="string">&quot;message&quot;</span>, <span class="variable language_">this</span>.<span class="property">receiveMessage</span>, <span class="literal">false</span>)</span><br><span class="line">    &#125;,</span><br><span class="line"><span class="title function_">receiveMessage</span>(<span class="params">e</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (e origin === <span class="string">&#x27;http://www.blogoog.com:8080&#x27;</span> || e.<span class="property">origin</span> === <span class="string">&#x27;http://www.blogoog.com:8088&#x27;</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">sendBtnShow</span> = <span class="literal">true</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">originSource</span> = e.<span class="property">origin</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">magicBuildData</span> = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(e.<span class="property">data</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">sendMsg</span>(<span class="params"></span>) &#123;</span><br><span class="line">        top.<span class="title function_">postMessage</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(data), <span class="string">&#x27;http://www.blogoog.com:8000&#x27;</span>)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>B 页面使用到的语法</li>
</ol>
<p><code>top.postMessage(&#39;data&#39;, &#39;http://www.blogoog.com:8000&#39;)</code></p>
<p>参考上面 A 页面的语法</p>
<p>为什么用 top 而不用 window 下面再讲</p>
<p><code>window.addEventListener(&#39;message&#39;, receiveMessage, false)</code></p>
<p>参考上面 A 页面的语法</p>
<p><code>receiveMessage = (event) =&gt; &#123;&#125;</code></p>
<p>参考上面 A 页面的语法</p>
<h4 id="window-postMessage-中的-window-到底是啥？"><a href="#window-postMessage-中的-window-到底是啥？" class="headerlink" title="window.postMessage()中的 window 到底是啥？"></a>window.postMessage()中的 window 到底是啥？</h4><p>始终是你需要通信的目标窗口</p>
<ul>
<li>A 页面中：A 页面向 B 页面发送跨域信息，window 就是在 A 页面中嵌入的 iframe 指向的 B 页面的 window，即：iframe.contentWindow</li>
<li>B 页面中：B 页面想 A 页面发送跨域信息，window 就是 A 页面的 window，在这里因为 B 页面时嵌入到 A 页面中的，对于 B 页面来讲，window 就是 top 或者 parent</li>
</ul>
<h3 id="需要特别注意的坑"><a href="#需要特别注意的坑" class="headerlink" title="需要特别注意的坑"></a>需要特别注意的坑</h3><ol>
<li>一定要等 A 页面嵌入的 B 页面加载完成之后，再进行 postMessage 跨域通信</li>
<li>一定要对 origin 做判断，去掉不是来自我们目标窗口的 origin，防止来自其他 origin 的攻击</li>
<li>着重注意 window.postMessage()中 window 的用法，明确目标窗口的 window</li>
</ol>
<h1 id="websocket-协议跨域"><a href="#websocket-协议跨域" class="headerlink" title="websocket 协议跨域"></a>websocket 协议跨域</h1><p>WebSocket protocol 是 HTML5 一种新的协议。它实现了浏览器与服务器全双工通信，同时允许跨域通讯，是 server push 技术的一种很好的实现。</p>
<p>原生 WebSocket API 使用起来不太方便，我们使用 Socket.io，它很好地封装了 webSocket 接口，提供了更简单、灵活的接口，也对不支持 webSocket 的浏览器提供了向下兼容。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;user input：&lt;input type=<span class="string">&quot;text&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcss.com/socket.io/2.2.0/socket.io.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> socket = <span class="title function_">io</span>(<span class="string">&#x27;http://www.domain2.com:8080&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="comment">// 连接成功处理</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">socket.<span class="title function_">on</span>(<span class="string">&#x27;connect&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 监听服务端消息</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    socket.<span class="title function_">on</span>(<span class="string">&#x27;message&#x27;</span>, <span class="keyword">function</span>(<span class="params">msg</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;data from server: ---&gt; &#x27;</span> + msg);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="comment">// 监听服务端关闭</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    socket.<span class="title function_">on</span>(<span class="string">&#x27;disconnect&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server socket has closed.&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;input&#x27;</span>)[<span class="number">0</span>].<span class="property">onblur</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    socket.<span class="title function_">send</span>(<span class="variable language_">this</span>.<span class="property">value</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>后端 node</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> socket = <span class="built_in">require</span>(<span class="string">&quot;socket.io&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 启http服务</span></span><br><span class="line"><span class="keyword">var</span> server = http.<span class="title function_">createServer</span>(<span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">writeHead</span>(<span class="number">200</span>, &#123;</span><br><span class="line">    <span class="string">&quot;Content-type&quot;</span>: <span class="string">&quot;text/html&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  res.<span class="title function_">end</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="string">&quot;8080&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Server is running at port 8080...&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听socket连接</span></span><br><span class="line">socket.<span class="title function_">listen</span>(server).<span class="title function_">on</span>(<span class="string">&quot;connection&quot;</span>, <span class="keyword">function</span> (<span class="params">client</span>) &#123;</span><br><span class="line">  <span class="comment">// 接收信息</span></span><br><span class="line">  client.<span class="title function_">on</span>(<span class="string">&quot;message&quot;</span>, <span class="keyword">function</span> (<span class="params">msg</span>) &#123;</span><br><span class="line">    client.<span class="title function_">send</span>(<span class="string">&quot;hello：&quot;</span> + msg);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;data from client: ---&gt; &quot;</span> + msg);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 断开处理</span></span><br><span class="line">  client.<span class="title function_">on</span>(<span class="string">&quot;disconnect&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Client socket has closed.&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="标签"><a href="#标签" class="headerlink" title="标签"></a>标签</h1><h2 id="iframe"><a href="#iframe" class="headerlink" title="iframe"></a>iframe</h2><p>HTML 内联框架元素<code>&lt;iframe&gt;</code> 表示嵌套的 browsing context。它能够将另一个 HTML 页面嵌入到当前页面中。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe</span><br><span class="line">  src=<span class="string">&quot;https://mdn-samples.mozilla.org/snippets/html/iframe-simple-contents.html&quot;</span></span><br><span class="line">  title=<span class="string">&quot;iframe example 1&quot;</span></span><br><span class="line">  width=<span class="string">&quot;400&quot;</span></span><br><span class="line">  height=<span class="string">&quot;300&quot;</span></span><br><span class="line">&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Your browser does not support iframes.<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<h2 id="canvas"><a href="#canvas" class="headerlink" title="canvas"></a>canvas</h2><p>标签定义图形，比如图表和其他图像。该标签基于 JavaScript 的绘图 API</p>
<h2 id="source"><a href="#source" class="headerlink" title="source"></a>source</h2><p>定义多媒体资源 <code>&lt;video&gt;</code> 和<code>&lt;audio&gt;</code></p>
<h2 id="command"><a href="#command" class="headerlink" title="command"></a>command</h2><p>定义命令按钮，比如单选按钮、复选框或按钮</p>
<h2 id="figure"><a href="#figure" class="headerlink" title="figure"></a>figure</h2><p>规定独立的流内容（图像、图表、照片、代码等等）</p>
<h2 id="nav"><a href="#nav" class="headerlink" title="nav"></a>nav</h2><p>导航</p>
<h2 id="section"><a href="#section" class="headerlink" title="section"></a>section</h2><p>定义文档中的节（section、区段）</p>
<h1 id="HTTP-报文"><a href="#HTTP-报文" class="headerlink" title="HTTP 报文"></a>HTTP 报文</h1><p>HTTP 报文是在 HTTP 应用程序之间发送的数据块。这些数据块以一些文本形式的元信息开头，描述报文的内容及含义，后面跟着可选的数据部分</p>
<h2 id="URI-和-URL"><a href="#URI-和-URL" class="headerlink" title="URI 和 URL"></a>URI 和 URL</h2><p>URI：统一资源标识符</p>
<p>URL：统一资源定位符</p>
<h2 id="报文组成"><a href="#报文组成" class="headerlink" title="报文组成"></a>报文组成</h2><ol>
<li>对报文进行描述的起始行 —— start line</li>
<li>包含属性的首部块 —— header</li>
<li>可选的包含数据的主体部分 —— body</li>
</ol>
<h2 id="报文语法"><a href="#报文语法" class="headerlink" title="报文语法"></a>报文语法</h2><ol>
<li>请求报文：</li>
</ol>
<p>向 web 服务器请求一个动作</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;method&gt;&lt;request-<span class="variable constant_">URL</span>&gt;&lt;version&gt;</span><br><span class="line">&lt;headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;entity-body&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>响应报文</li>
</ol>
<p>把请求结果返回给客户端</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;version&gt;&lt;status&gt;&lt;reason-phrase&gt;</span><br><span class="line">&lt;headers&gt;</span><br><span class="line"></span><br><span class="line">&lt;entity-body&gt;</span><br></pre></td></tr></table></figure>

<h2 id="状态码"><a href="#状态码" class="headerlink" title="状态码"></a>状态码</h2><p>服务器和浏览器之间的约定</p>
<h3 id="分类"><a href="#分类" class="headerlink" title="分类:"></a>分类:</h3><p>100-199 用于指定客户端应相应的某些动作。</p>
<p>200-299 用于表示请求成功。</p>
<p>300-399 用于已经移动的文件并且常被包含在定位头信息中指定新的地址信息。</p>
<p>400-499 用于指出客户端的错误。</p>
<p>500-599 用于支持服务器错误。</p>
<table>
<thead>
<tr>
<th align="left">状态码</th>
<th align="left">状态信息</th>
<th align="left">解释</th>
</tr>
</thead>
<tbody><tr>
<td align="left">100</td>
<td align="left">Continue</td>
<td align="left">初始请求已接受,继续发送</td>
</tr>
<tr>
<td align="left">101</td>
<td align="left">switching Protocols</td>
<td align="left">服务器遵从客户请求转换到另一种协议</td>
</tr>
<tr>
<td align="left"><strong>200</strong></td>
<td align="left"><strong>OK</strong></td>
<td align="left"><strong>请求成功</strong></td>
</tr>
<tr>
<td align="left">201</td>
<td align="left">Created</td>
<td align="left">服务器已经创建了文档,Location 头给出了他的 URL</td>
</tr>
<tr>
<td align="left">202</td>
<td align="left">Accepted</td>
<td align="left">已接受请求,但处理尚未完成</td>
</tr>
<tr>
<td align="left">203</td>
<td align="left">Non-Authoritative Information</td>
<td align="left">文档已正常返回但一些应答头可能不正确,因为使用的是文档的拷贝</td>
</tr>
<tr>
<td align="left"><strong>204</strong></td>
<td align="left"><strong>No Content</strong></td>
<td align="left"><strong>服务器接到请求已经处理完毕,但浏览器页面不会刷新</strong></td>
</tr>
<tr>
<td align="left">205</td>
<td align="left">Reset Content</td>
<td align="left">没有新内容,但浏览器应该重置它所显示的内容,用来强制浏览器清除表单输入内容.</td>
</tr>
<tr>
<td align="left">206</td>
<td align="left">Partial Content</td>
<td align="left">客户发送了一个带有 Range 头的 GET 请求,服务器完成了它</td>
</tr>
<tr>
<td align="left">300</td>
<td align="left">Multiple Choices</td>
<td align="left">客户请求的文档可以在多个位置找到,这些位置已经在返回的文档中列出.如果服务器要提出优先选择,则应该在 Location 应答头指明</td>
</tr>
<tr>
<td align="left"><strong>301</strong></td>
<td align="left"><strong>Moved Permanently</strong></td>
<td align="left"><strong>永久重定向,请求的网页已经永久移动到新位置</strong></td>
</tr>
<tr>
<td align="left"><strong>302</strong></td>
<td align="left"><strong>Found</strong></td>
<td align="left"><strong>临时重定向,POST 方法的重定向在未询问用户的情况下就会变成 GET</strong></td>
</tr>
<tr>
<td align="left"><strong>303</strong></td>
<td align="left"><strong>See Other</strong></td>
<td align="left"><strong>类似 301&#x2F;302,不同之处在于,原来的请求是 POST,现在是 GET</strong></td>
</tr>
<tr>
<td align="left"><strong>304</strong></td>
<td align="left"><strong>Not Modified</strong></td>
<td align="left"><strong>自从上次请求后,网页未被修改过</strong></td>
</tr>
<tr>
<td align="left">305</td>
<td align="left">Use Proxy</td>
<td align="left">使用代理服务器</td>
</tr>
<tr>
<td align="left"><strong>307</strong></td>
<td align="left"><strong>Temporary Redirect</strong></td>
<td align="left"><strong>临时重定向，不同之处,把 POST 转为 GET</strong></td>
</tr>
<tr>
<td align="left"><strong>400</strong></td>
<td align="left"><strong>Bad Request</strong></td>
<td align="left"><strong>请求出现语法错误</strong></td>
</tr>
<tr>
<td align="left"><strong>401</strong></td>
<td align="left"><strong>Unauthorized</strong></td>
<td align="left"><strong>用户未授权,需要用户验证</strong></td>
</tr>
<tr>
<td align="left"><strong>403</strong></td>
<td align="left"><strong>Forbidden</strong></td>
<td align="left"><strong>服务器已经理解请求,但是拒绝执行</strong></td>
</tr>
<tr>
<td align="left"><strong>404</strong></td>
<td align="left"><strong>Not Found</strong></td>
<td align="left"><strong>服务器找不到请求的网页</strong></td>
</tr>
<tr>
<td align="left">405</td>
<td align="left">Method Not Allowed</td>
<td align="left">请求方法（GET、POST、HEAD、DELETE、PUT、TRACE 等）对指定的资源不适用。</td>
</tr>
<tr>
<td align="left">406</td>
<td align="left">Not Acceptable</td>
<td align="left">指定的资源已经找到，但它的 MIME 类型和客户在 Accpet 头中所指定的不兼容</td>
</tr>
<tr>
<td align="left">407</td>
<td align="left">Proxy Authentication Required</td>
<td align="left">类似于 401，表示客户必须先经过代理服务器的授权</td>
</tr>
<tr>
<td align="left">408</td>
<td align="left">Request Timeout</td>
<td align="left">请求超时</td>
</tr>
<tr>
<td align="left"><strong>500</strong></td>
<td align="left"><strong>Internal Server Error</strong></td>
<td align="left"><strong>服务器遇到错误,无法完成请求</strong></td>
</tr>
<tr>
<td align="left"><strong>503</strong></td>
<td align="left"><strong>Service Unavailable</strong></td>
<td align="left"><strong>由于临时的服务器维护或过载,暂时无法处理请求</strong></td>
</tr>
<tr>
<td align="left">504</td>
<td align="left">Gateway Timeout</td>
<td align="left">由作为代理或网关的服务器使用，表示不能及时地从远程服务器获得应答</td>
</tr>
<tr>
<td align="left">505</td>
<td align="left">HTTP Version Not Supported</td>
<td align="left">服务器不支持请求中所指明的 HTTP 版本。</td>
</tr>
</tbody></table>
<h2 id="HTTP-请求方法"><a href="#HTTP-请求方法" class="headerlink" title="HTTP 请求方法"></a>HTTP 请求方法</h2><ol>
<li><strong>GET</strong></li>
</ol>
<p>请求服务器发送某个资源</p>
<ol start="2">
<li><strong>HEAD</strong></li>
</ol>
<p>与 GET 方法类似,但是在服务器的响应中没有资源的内容,只有资源的一些基本信息,主要用于</p>
<ul>
<li>在不获取资源的情况下获取信息(类型,大小等)</li>
<li>通过状态码看资源是否存在</li>
<li>通过查看首部,测试资源是否被修改</li>
</ul>
<ol start="3">
<li><strong>PUT</strong></li>
</ol>
<p>和 GET 从服务器获取资源相反,PUT 用于向服务器写入资源.PUT 的语义就是让服务器用请求的主体部分创建一个请求 URL 命名的文档.如果存在就替换</p>
<ol start="4">
<li><strong>POST</strong></li>
</ol>
<p>POST 用于向服务器发送数据,通常用来支持 HTML 的表单(input,select,textarea),表单中的数据会被发送到服务器</p>
<ol start="5">
<li><strong>TRACE</strong></li>
</ol>
<p>客户端发送一个请求,这个请求可能会穿过防火墙,代理,网关,和一些其他应用程序,每个中间节点都可以修改 HTTP 请求,TRACE 方法允许客户端在最终请求发往服务器的时候,看看他变成了什么样子</p>
<p>TRACE 请求会在目的服务器端发送一个”闭环”诊断,行程最后一站服务器会弹回一条 TRACE 响应,并在响应主题中携带他收到的原始请求报文</p>
<ol start="5">
<li><strong>DELETE</strong></li>
</ol>
<p>用于要求服务器删除请求的 URL,和 PUT 一样,服务器可能不支持</p>
<ol start="6">
<li><strong>OPTIONS</strong></li>
</ol>
<p>用于请求服务器告知其支持的各种功能</p>
<h1 id="浏览器缓存"><a href="#浏览器缓存" class="headerlink" title="浏览器缓存"></a>浏览器缓存</h1><p>缓存是一种保存资源副本并在下次请求时直接使用该副本的技术.</p>
<p>HTTP 缓存有多种规则，根据是否需要重新向服务器发起请求来分类，分为两大类(<strong>强制缓存，协商缓存</strong>)</p>
<p>http 缓存机制主要在 http 响应头中设定，响应头中相关字段为<strong>Expires、Cache-Control、Last-Modified、Etag</strong>。</p>
<h3 id="cache-control"><a href="#cache-control" class="headerlink" title="cache-control"></a>cache-control</h3><p>cache-control 通常用于优化网页性能,适当使用可减少重复读取相同内容</p>
<p>可以在服务端 setHeader 设置 cache-control</p>
<p>可以设置让该字段存于缓存中,浏览器下次访问时不发起请求,直接从缓存中读取该资源</p>
<h3 id="ETag"><a href="#ETag" class="headerlink" title="ETag"></a>ETag</h3><p>ETag 通常用于优化网页性能,适当使用可减少重复读取相同内容</p>
<p>可通过服务端 setHeader 设置 etag 为相应的字段的 md5 值</p>
<p>浏览器访问时,request.headers 会带有 if-none-match 属性(为上述 MD5),若不等于则说明服务器上的</p>
<p>该资源与本地存储的该资源不相同,需要重新从服务器加载;若相等则说明两者资源相同,则直接从本地</p>
<p>缓存获取.后端应设置 statusCode&#x3D;304.与 cache-control 不同的是:etag 始终都要发请求和收响应,而</p>
<p>cache-control 不发请求.</p>
<h1 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h1><p>存储信息到浏览器，可以用 js 设置，也可以在服务器端通过 set-cookie 让浏览器种下 cookie，存在于响应头里。</p>
<p>每次请求都会带上 cookie，最大容量 4k</p>
<p>用途：记录用户名</p>
<p>设置 cookie 时的参数：</p>
<ol>
<li><code>path</code>: cookie 影响到的路径，匹配该路径才发送 cookie</li>
<li><code>expires</code>和<code>maxAge</code>:告诉浏览器 cookie 多久过期</li>
</ol>
<p>不设置就会产生 session cookie，当关闭浏览器，cookie 就被清除 3. <code>secure</code>: 为 true 时，在 http 无效，在 https 生效 4. <code>httpOnly</code>: 浏览器不允许通过 js 修改 cookie</p>
<h1 id="session"><a href="#session" class="headerlink" title="session"></a>session</h1><p>用来保存状态。当用户输入用户名密码提交给服务器后，服务器验证通过后创建 session 用于记录用户信息，session 可保存在服务器，也可以保存在数据库</p>
<ol>
<li>创建 session 后，会把关联的 session_id 通过是 set-cookie 添加到响应头</li>
<li>浏览器加载页面发现有 set-cookie 字段，就把这个 cookie 种到指定域名下</li>
<li>下次刷新页面，发送的请求带上 cookie，服务器接受后根据 session_id 来识别用户</li>
</ol>
<blockquote>
<p>cookie 和 session 的区别:</p>
</blockquote>
<p>cookie 是存储在浏览器中的一小段数据,session 是让服务器识别某个用户的机制 session.在实现过程中需要使用 cookie.二者不是同一维度的东西.</p>
<h1 id="localStorage"><a href="#localStorage" class="headerlink" title="localStorage"></a>localStorage</h1><ol>
<li>本地存储，永不过期，除非手动 js 删除。5M 大小。</li>
<li>不参与网络传输</li>
<li>一般用于性能优化</li>
</ol>
<h2 id="localStorage-的存储-获取-删除"><a href="#localStorage-的存储-获取-删除" class="headerlink" title="localStorage 的存储,获取,删除"></a>localStorage 的存储,获取,删除</h2><p>只支持字符串存储.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//存储</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;myCat&quot;</span>, <span class="string">&quot;Tom&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//读取</span></span><br><span class="line"><span class="variable language_">localStorage</span>.<span class="title function_">getItem</span>(<span class="string">&quot;Tom&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//移除</span></span><br><span class="line">localstorage.<span class="title function_">removeItem</span>(<span class="string">&quot;myCat&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//移除所有</span></span><br><span class="line">localstorage.<span class="title function_">clear</span>();</span><br></pre></td></tr></table></figure>

<h1 id="sessionstorage"><a href="#sessionstorage" class="headerlink" title="sessionstorage"></a>sessionstorage</h1><p>与 localstorage 类似,属于本地存储与上面的 session 无关.但是关闭浏览器失效.</p>
<h2 id="浏览器缓存机制通俗语言版-自我理解"><a href="#浏览器缓存机制通俗语言版-自我理解" class="headerlink" title="浏览器缓存机制通俗语言版(自我理解)"></a>浏览器缓存机制通俗语言版(自我理解)</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Cache-Control: max-age=300；</span><br><span class="line">ETag:W/&quot;e-cbxLFQW5zapn79tQwb/g6Q&quot;</span><br></pre></td></tr></table></figure>

<p>浏览器第一次请求 a.jpg 这张图片,服务器发回一张图片,并且附送一个<code>ETag</code>(相当于一个用于验证的文件).浏览器把这张图片和 ETag 缓存到本地.如果在 300 秒内,浏览器又请求这张图片,那么直接从缓存中读取这张图.如果超过 300 秒,浏览器发现已经过了时间了,就重新向服务器发请求,并且附带之前给的 ETag.服务器拿着当前文件计算后的<code>ETag</code>和浏览器发回的<code>ETag</code>比较,如果一样,说明图片没换,发回一个响应头(不包含图片,304,表示文件没修改,还能用).如果不一样,就把新的文件和新的<code>ETag</code>发回去.</p>
<p>另外还有<code>Last-Modified/If-Modified-Since</code>.和<code>ETag</code>功能类似.因为服务器可能不止一个,文件存储在不同的服务器,那就给请求文件上附带上<code>Last-Modified</code>声明,请求时带上<code>If-Modified-Since</code>,表明服务器上一次修改这个文件的时间,拿来和服务器上记录的最后修改时间对比.如果修改时间比较新,说明被动过,发回一个新文件.如果时间比较旧,说明不用换,发回 304,使用缓存即可.</p>
<h2 id="严谨说法"><a href="#严谨说法" class="headerlink" title="严谨说法"></a>严谨说法</h2><p>浏览器缓存控制分为<strong>强缓存</strong>和<strong>协商缓存</strong>，<strong>协商缓存</strong>必须配合<strong>强缓存</strong>使用。</p>
<p>首先浏览器第一次跟服务器请求一个资源，服务器在返回这个资源和 response header 的同时，会根据开发者要求或者浏览器默认，在 response 的 header 加上相关字段的 http response header。</p>
<p>一、当浏览器对某个资源的请求命中了<strong>强缓存</strong>时，利用[Expires]或者[Cache-Control]这两个 http response header 实现</p>
<p>。</p>
<ol>
<li><p>[Expires]：描述的是一个绝对时间，根据的是客户端时间。用 GMT 格式的字符串表示，如：Expires:Thu, 31 Dec 2037 23:55:55 GMT 下次浏览器再次请求同一资源时。先从客户端缓存中寻找，找到这个资源后，拿出它的[Expires]跟当前的请求时间比较。如果请求时间在[Expires]指定的失效时间之前，就能命中缓存，这样就不用再次到服务器上去缓存一遍，节省了资源。但是正因为是绝对时间，如果客户端时间被随意更改下，这个机制就失效了。所以我们需要[Cache-Control]。</p>
</li>
<li><p>[Cache-Control]：描述的是一个相对时间，在进行缓存命中时，都是利用浏览器时间判断。</p>
</li>
</ol>
<p>这两个 header 可以只启用一个，也可以同时启用，当 response header 中，[Expires]和[Cache-Control]同时存在时，[Cache-Control]优先级高于[Expires]。</p>
<p>二、当浏览器对某个资源的请求没有命中<strong>强缓存</strong>，就会发一个请求到服务器，验证<strong>协商缓存</strong>是否命中。</p>
<p>如果命中，则还是从客户端缓存中加载。<strong>协商缓存</strong>利用的是[Last-Modified，If-Modified-Since]和[ETag、If-None-Match]这两对 Header 来管理的。</p>
<ol>
<li><p>[Last-Modified]：原理和上面的[expires]相同，区别是它是根据服务器时间返回的 header 来判断缓存是否存在。但是有时候也会服务器上资源其实有变化，但是最后修改时间却没有变化的情况（这种问题也不容易被定位），这时候我们需要[ETag、If-None-Match]。</p>
</li>
<li><p>[ETag、If-None-Match]：原理与上相同，区别是浏览器跟服务器请求一个资源，服务器在返回这个资源的同时，在 respone 的 header 加上 ETag 的 header，这个 header 是服务器根据当前请求的资源生成的一个唯一标识，这个唯一标识是一个字符串，只要资源有变化这个串就不同。</p>
</li>
<li><p>[ETag、If-None-Match]这么厉害我们为什么还需要[Last-Modified、If-Modified-Since]呢？有一个例子就是分布式系统尽量关闭掉 ETag(每台机器生成的 ETag 都会不一样）</p>
</li>
</ol>
<p>[Last-Modified，If-Modified-Since]和[ETag、If-None-Match]一般都是同时启用。</p>
<h1 id="HTTPS-原理"><a href="#HTTPS-原理" class="headerlink" title="HTTPS 原理"></a>HTTPS 原理</h1><p>HTTP+SSL&#x2F;TLS， 即 HTTP 下加入 SSL 层，HTTPS 的安全基础是 SSL，因此加密的详细内容就需要 SSL，用于安全的 HTTP 数据传输。</p>
<h2 id="加密算法："><a href="#加密算法：" class="headerlink" title="加密算法："></a>加密算法：</h2><ol>
<li>对称加密</li>
</ol>
<p>有流式、分组两种，加密和解密都是使用的同一个密钥。 2. 非对称加密</p>
<p>加密使用的密钥和解密使用的密钥是不相同的，分别称为：公钥、私钥，公钥和算法都是公开的，私钥是保密的。非对称加密算法性能较低，但是安全性超强，由于其加密特性，非对称加密算法能加密的数据长度也是有限的 3. 哈希算法</p>
<p>将任意长度的信息转换为较短的固定长度的值，通常其长度要比信息小得多，且算法不可逆。 4. 数字签名</p>
<p>签名就是在信息的后面再加上一段内容（信息经过 hash 后的值），可以证明信息没有被修改过。hash 值一般都会加密后（也就是签名）再和信息一起发送，以保证这个 hash 值不被修改。</p>
<h1 id="简单通信流程"><a href="#简单通信流程" class="headerlink" title="简单通信流程"></a>简单通信流程</h1><p>概括来说，整个简化的加密通信的流程就是：</p>
<ol>
<li>小明访问网站，网站将自己的证书给到小明（其实是给到浏览器，小明不会有感知）</li>
<li>浏览器从证书中拿到网站的公钥 A</li>
<li>浏览器生成一个只有自己知道的对称密钥 B，用公钥 A 加密，并传给网站（其实是有协商的过程，这里为了便于理解先简化）</li>
<li>网站通过私钥解密，拿到对称密钥 B</li>
<li>浏览器、网站 之后的数据通信，都用密钥 B 进行加密</li>
</ol>
<h1 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h1><h2 id="证书可能存在的问题"><a href="#证书可能存在的问题" class="headerlink" title="证书可能存在的问题"></a>证书可能存在的问题</h2><p>证书是伪造的：压根不是 CA 颁发的</p>
<p>证书被篡改过：比如将 XX 网站的公钥给替换了</p>
<p>解决方法: <strong>数字签名和摘要</strong></p>
<p>“摘要”就是对传输的内容，通过 hash 算法计算出一段固定长度的串。然后，在通过 CA 的私钥对这段摘要进行加密，加密后得到的结果就是“数字签名.这段数字签名只有 CA 的公钥才能够解密。</p>
<h1 id="一个页面从输入-URL-到页面加载显示完成，这个过程中都发生了什么？（流程说的越详细越好）"><a href="#一个页面从输入-URL-到页面加载显示完成，这个过程中都发生了什么？（流程说的越详细越好）" class="headerlink" title="一个页面从输入 URL 到页面加载显示完成，这个过程中都发生了什么？（流程说的越详细越好）"></a>一个页面从输入 URL 到页面加载显示完成，这个过程中都发生了什么？（流程说的越详细越好）</h1><h2 id="详细版："><a href="#详细版：" class="headerlink" title="详细版："></a>详细版：</h2><p>1、浏览器会开启一个线程来处理这个请求，对 URL 分析判断如果是 http 协议就按照 Web 方式来处理;</p>
<p>2、调用浏览器内核中的对应方法，比如 WebView 中的 loadUrl 方法;</p>
<p>3、通过 DNS 解析获取网址的 IP 地址，设置 UA 等信息发出第二个 GET 请求;</p>
<p>4、进行 HTTP 协议会话，客户端发送报头(请求报头);</p>
<p>5、进入到 web 服务器上的 Web Server，如 Apache、Tomcat、Node.JS 等服务器;</p>
<p>6、进入部署好的后端应用，如 PHP、Java、JavaScript、Python 等，找到对应的请求处理;</p>
<p>7、处理结束回馈报头，此处如果浏览器访问过，缓存上有对应资源，会与服务器最后修改时间对比，一致则返回 304;</p>
<p>8、浏览器开始下载 html 文档(响应报头，状态码 200)，同时使用缓存;</p>
<p>9、文档树建立，根据标记请求所需指定 MIME 类型的文件（比如 css、js）,同时设置了 cookie;</p>
<p>10、页面开始渲染 DOM，JS 根据 DOM API 操作 DOM,执行事件绑定等，页面显示完成。</p>
<h2 id="简洁版："><a href="#简洁版：" class="headerlink" title="简洁版："></a>简洁版：</h2><p>浏览器根据请求的 URL 交给 DNS 域名解析，找到真实 IP，向服务器发起请求；</p>
<p>服务器交给后台处理完成后返回数据，浏览器接收文件（HTML、JS、CSS、图象等）；</p>
<p>浏览器对加载到的资源（HTML、JS、CSS 等）进行语法解析，建立相应的内部数据结构（如 HTML 的 DOM）；</p>
<p>载入解析到的资源文件，渲染页面，完成。</p>
<h1 id="WebSocket-协议"><a href="#WebSocket-协议" class="headerlink" title="WebSocket 协议"></a>WebSocket 协议</h1><h2 id="1-为什么需要-WebSocket"><a href="#1-为什么需要-WebSocket" class="headerlink" title="1.为什么需要 WebSocket"></a>1.为什么需要 WebSocket</h2><p>HTTP 协议只能由客户端发起,WebSocket 可以实现双向对话,服务端和客户端都可以发送信息.</p>
<h2 id="2-WebSocket-特点"><a href="#2-WebSocket-特点" class="headerlink" title="2.WebSocket 特点"></a>2.WebSocket 特点</h2><ol>
<li>建立在 TCP 协议之上,服务端实现容易.</li>
<li>与 HTTP 协议有着良好的兼容性,并且握手阶段采用 HTTP 协议,因此握手阶段不容易屏蔽,可通过 HTTP 代理服务器.</li>
<li>数据格式轻量,性能开销小,通信高效.</li>
<li>可以发送文本和二进制数据.</li>
<li>没有同源限制.</li>
<li>协议标识符是 ws(加密是 wss),服务器网址是 URL.</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ws</span>:<span class="comment">//example.com:80/some/path</span></span><br></pre></td></tr></table></figure>

<h3 id="客户端示例"><a href="#客户端示例" class="headerlink" title="客户端示例"></a>客户端示例</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&quot;wss://echo.websocket.org&quot;</span>);</span><br><span class="line"></span><br><span class="line">ws.<span class="property">onopen</span> = <span class="keyword">function</span> (<span class="params">evt</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Connection open ...&quot;</span>);</span><br><span class="line">  ws.<span class="title function_">send</span>(<span class="string">&quot;Hello WebSockets!&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ws.<span class="property">onmessage</span> = <span class="keyword">function</span> (<span class="params">evt</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Received Message: &quot;</span> + evt.<span class="property">data</span>);</span><br><span class="line">  ws.<span class="title function_">close</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">ws.<span class="property">onclose</span> = <span class="keyword">function</span> (<span class="params">evt</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Connection closed.&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="WebSocket-客户端-API"><a href="#WebSocket-客户端-API" class="headerlink" title="WebSocket 客户端 API"></a>WebSocket 客户端 API</h2><h3 id="WebSocket-构造函数"><a href="#WebSocket-构造函数" class="headerlink" title="WebSocket 构造函数"></a>WebSocket 构造函数</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ws = <span class="keyword">new</span> <span class="title class_">WebSocket</span>(<span class="string">&quot;ws://localhost:8080&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>执行上面语句之后，客户端就会与服务器进行连接。</p>
<h3 id="WebSocket-readyState"><a href="#WebSocket-readyState" class="headerlink" title="WebSocket.readyState"></a>WebSocket.readyState</h3><p>readyState 属性返回实例对象的当前状态,共用四种.</p>
<ul>
<li>CONNECTING: 值为 0,表示正在连接.</li>
<li>OPEN: 值为 1,表示连接成功,可以通信.</li>
<li>CLOSEING: 值为 2,表示正在关闭.</li>
<li>CLOSED: 值为 3,表示连接已经关闭,或者打开失败.</li>
</ul>
<p>示例</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span> (ws.<span class="property">readyState</span>) &#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="title class_">WebSocket</span>.<span class="property">CONNECTING</span>:</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="title class_">WebSocket</span>.<span class="property">OPEN</span>:</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="title class_">WebSocket</span>.<span class="property">CLOSING</span>:</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> <span class="title class_">WebSocket</span>.<span class="property">CLOSED</span>:</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="attr">default</span>:</span><br><span class="line">    <span class="comment">// this never happens</span></span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="WebSocket-onopen"><a href="#WebSocket-onopen" class="headerlink" title="WebSocket.onopen"></a>WebSocket.onopen</h3><p>实例对象的<code>onopen</code>属性,用于指定连接成功后的回调函数.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ws.<span class="property">onopen</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  ws.<span class="title function_">send</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>如果指定多个函数,可以使用<code>addEventListener</code>方法.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ws.<span class="title function_">addEventListener</span>(<span class="string">&quot;open&quot;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  ws.<span class="title function_">send</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="WebSocket-onclose"><a href="#WebSocket-onclose" class="headerlink" title="WebSocket.onclose"></a>WebSocket.onclose</h3><p>实例对象的<code>onclose</code>属性，用于指定连接关闭后的回调函数。</p>

    </div>

    
    
    

    <footer class="post-footer">

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2022/09/26/React-Hooks/" rel="prev" title="React-Hooks">
                  <i class="fa fa-chevron-left"></i> React-Hooks
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2022/10/12/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" rel="next" title="单元测试">
                  单元测试 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zax Tseng</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
