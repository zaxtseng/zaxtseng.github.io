<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" integrity="sha256-AbA177XfpSnFEvgpYu1jMygiLabzPCJCRIBtR5jGc0k=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"example.com","root":"/","images":"/images","scheme":"Mist","darkmode":true,"version":"8.13.1","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="ZAX">
<meta property="og:url" content="http://example.com/page/4/index.html">
<meta property="og:site_name" content="ZAX">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Zax Tseng">
<meta property="article:tag" content="javascript, React, Vue, HTML5">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://example.com/page/4/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"en","comments":"","permalink":"","path":"page/4/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>ZAX</title>
  






  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">ZAX</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Zax Tseng</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">121</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/React%E8%B7%AF%E7%94%B1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/React%E8%B7%AF%E7%94%B1/" class="post-title-link" itemprop="url">React路由</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:08:15" itemprop="dateCreated datePublished" datetime="2022-09-26T21:08:15+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:51" itemprop="dateModified" datetime="2022-12-27T11:12:51+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<h2 id="title-React-路由-date-2020-05-10-13-59-49"><a href="#title-React-路由-date-2020-05-10-13-59-49" class="headerlink" title="title: React 路由 date: 2020-05-10 13:59:49"></a>title: React 路由 date: 2020-05-10 13:59:49</h2><p>tags: React</p>
<h2 id="安装-react-router-dom"><a href="#安装-react-router-dom" class="headerlink" title="安装 react-router-dom"></a>安装 react-router-dom</h2><p>可以使用<code>&lt;Link&gt;,&lt;NavLink&gt;</code>标签</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-router-dom --save</span><br></pre></td></tr></table></figure>

<h2 id="创建路由模式"><a href="#创建路由模式" class="headerlink" title="创建路由模式"></a>创建路由模式</h2><ol>
<li>hash 模式</li>
<li>history 模式</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//hash模式</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span>, <span class="title class_">Link</span>, <span class="title class_">Route</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="comment">//history模式</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Link</span>, <span class="title class_">Route</span>, <span class="title class_">HashRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><code>as</code>类似于起别名,方便简化名称.</p>
<h2 id="创建路由"><a href="#创建路由" class="headerlink" title="创建路由"></a>创建路由</h2><blockquote>
<p>需要通过使<code>Route</code>进行对组件的声明配置,才能被<code>Link</code>找到.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="comment">// histoty</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span>, <span class="title class_">Link</span>, <span class="title class_">Route</span>, <span class="title class_">Switch</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="comment">// hash</span></span><br><span class="line"><span class="comment">// import &#123; Link, Route, HashRouter as Router &#125; from &#x27;react-router-dom&#x27;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Page1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是Page1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Page2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是Page2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Page3</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>我是Page3<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;page1&quot;</span>&gt;</span>Page1<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;page2&quot;</span>&gt;</span>Page2<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;page3&quot;</span>&gt;</span>Page3<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/page1&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Page1&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/page2&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Page2&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/page3&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Page3&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<h2 id="函数式-带组件"><a href="#函数式-带组件" class="headerlink" title="函数式(带组件)"></a>函数式(带组件)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//router.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">BrowserRouter</span> <span class="keyword">as</span> <span class="title class_">Router</span>, <span class="title class_">Route</span>, <span class="title class_">Switch</span>, <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&quot;./pages/login&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&quot;./pages/home&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&quot;./pages/app&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数式</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> <span class="title function_">ARouter</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/&quot;</span> <span class="attr">component</span>=<span class="string">&#123;App&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/home&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Home&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Route</span> <span class="attr">path</span>=<span class="string">&quot;/login&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Login&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">Switch</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">Link</span> &#125; <span class="keyword">from</span> <span class="string">&quot;react-router-dom&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">App</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span>&gt;</span>去首页<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span>&gt;</span>去登陆<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//有状态组件点击跳转</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  handleJump = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">histroy</span>.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/login&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;/home&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Button</span> <span class="attr">onClick</span>=<span class="string">&#123;handleJump&#125;</span>&gt;</span>点击去登陆<span class="tag">&lt;/<span class="name">Button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p>如果用<code>Switch</code>，浏览器输入<code>/home</code>也只会加载 App 页，因为<code>/home</code>先匹配了<code>/</code></p>
<p>加上 <code>exact</code> 可以精准匹配</p>
<p>如果导入的是<code>HashRouter</code>，会自动加上<code>#</code> 如 <code>http://localhost:3000/login#/</code></p>
<h2 id="手动跳转"><a href="#手动跳转" class="headerlink" title="手动跳转"></a>手动跳转</h2><p>当你使用 History 路由的时候，某些时候需要主动的跳转道某个路由，</p>
<p>这时又不能去触发节点行为，所以这个时候就可以通过 API 的方式，进行跳转.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 跳转页面</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">history</span>.<span class="title function_">push</span>(参数和to的内容相似);</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">history</span>.<span class="title function_">push</span>(<span class="string">&quot;page1&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重定向页面</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">history</span>.<span class="title function_">replace</span>(<span class="string">&quot;page2&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>当然还有 hash 的 go 方法。</p>
<h2 id="动态路由"><a href="#动态路由" class="headerlink" title="动态路由"></a>动态路由</h2><h2 id="路由传值"><a href="#路由传值" class="headerlink" title="路由传值"></a>路由传值</h2><p>路由传参(传值)一般使用<code>params</code>和<code>query</code>.</p>
<p>通过给<code>to</code>传递一个对象的方式进行数据传递.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;div className=<span class="string">&quot;App&quot;</span>&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">Router</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">to</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">pathname:</span> &quot;/<span class="attr">page1</span>/<span class="attr">10</span>&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">search:</span> &quot;?<span class="attr">roles</span>=<span class="string">[10,</span> <span class="attr">20</span>]&quot;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">state:</span> &#123; <span class="attr">name:</span> &quot;<span class="attr">Tom</span>&quot; &#125;,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &gt;</span></span></span><br><span class="line"><span class="language-xml">          Page1</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;page2&quot;</span>&gt;</span>Page2<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">Link</span> <span class="attr">to</span>=<span class="string">&quot;page3&quot;</span>&gt;</span>Page3<span class="tag">&lt;/<span class="name">Link</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/page1/:id&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Page1&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/page2&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Page2&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">Route</span> <span class="attr">exact</span> <span class="attr">path</span>=<span class="string">&quot;/page3&quot;</span> <span class="attr">component</span>=<span class="string">&#123;Page3&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Route</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">Router</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>可以看到，向<code>page1</code>的路由上添加了一个<code>:id</code>表示需要传递<code>param</code>的<code>id</code>的值，</p>
<p>同时声明了<code>search</code>的文本和<code>state</code>对象多种方式传递了参数。以便根据不同的场景使用。</p>
<h2 id="路由-Hooks"><a href="#路由-Hooks" class="headerlink" title="路由 Hooks"></a>路由 Hooks</h2><h3 id="useParams-获取参数-内部封装"><a href="#useParams-获取参数-内部封装" class="headerlink" title="useParams: 获取参数(内部封装)"></a>useParams: 获取参数(内部封装)</h3><p>如果在有状态组件(也就是 class 声明的类中)获取参数,需要通过<code>this.props.match.parmas.id</code>.</p>
<p>而在函数式组件(无状态组件)中获取,需要通过<code>useParams()</code></p>
<h3 id="useHistory-通过-JS-Api-操作路由跳转"><a href="#useHistory-通过-JS-Api-操作路由跳转" class="headerlink" title="useHistory: 通过 JS Api 操作路由跳转"></a>useHistory: 通过 JS Api 操作路由跳转</h3><p>函数式组件没有作用域,this 为 undefined.所以需要使用 useHistory 进行跳转.</p>
<p>如果在有状态组件中,需要<code>this.props.history.push(&#39;/&#39;)</code>进行跳转.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Detail</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> params = <span class="title function_">useParams</span>();</span><br><span class="line">  <span class="keyword">const</span> history = <span class="title function_">useHistory</span>();</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>当前的参数值为: &#123;params.goodId&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">          history.push(&quot;/&quot;);</span></span><br><span class="line"><span class="language-xml">        &#125;&#125;</span></span><br><span class="line"><span class="language-xml">      &gt;</span></span><br><span class="line"><span class="language-xml">        跳转</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/React%E5%85%A5%E9%97%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/React%E5%85%A5%E9%97%A8/" class="post-title-link" itemprop="url">React入门</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:08:10" itemprop="dateCreated datePublished" datetime="2022-09-26T21:08:10+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:51" itemprop="dateModified" datetime="2022-12-27T11:12:51+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<h2 id="title-React-入门-date-2020-05-05-09-48-17"><a href="#title-React-入门-date-2020-05-05-09-48-17" class="headerlink" title="title: React 入门 date: 2020-05-05 09:48:17"></a>title: React 入门 date: 2020-05-05 09:48:17</h2><p>tags: React</p>
<p>React 是一个 MVC 框架.</p>
<h1 id="React-特点"><a href="#React-特点" class="headerlink" title="React 特点"></a>React 特点</h1><ol>
<li>声明式写法</li>
<li>组件化</li>
<li>可开发多种任务</li>
</ol>
<h1 id="开发环境"><a href="#开发环境" class="headerlink" title="开发环境"></a>开发环境</h1><h2 id="官方脚手架-creat-react-app"><a href="#官方脚手架-creat-react-app" class="headerlink" title="官方脚手架 creat-react-app"></a>官方脚手架 creat-react-app</h2><p>需求: node &gt; 6.0</p>
<p>安装命令<code>npm install create-react-app</code></p>
<p>创建命令<code>create-reate-app my-project</code></p>
<p>运行命令<code>npm start</code></p>
<h1 id="文件入口"><a href="#文件入口" class="headerlink" title="文件入口"></a>文件入口</h1><p><code>/src/App.js</code></p>
<h2 id="基本语法"><a href="#基本语法" class="headerlink" title="基本语法"></a>基本语法</h2><p>ReactDOM.render()</p>
<p>React.CreateElement()</p>
<p>React.Component</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//括号内分别为标签名,属性,默认值</span></span><br><span class="line"><span class="keyword">const</span> hello = <span class="title class_">React</span>.<span class="title class_">CreatElement</span>(</span><br><span class="line">  <span class="string">&quot;h1&quot;</span>,</span><br><span class="line">  &#123; <span class="attr">className</span>: <span class="string">&quot;red&quot;</span>, <span class="attr">name</span>: <span class="string">&quot;Tom&quot;</span> &#125;,</span><br><span class="line">  <span class="string">&quot;hello world&quot;</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//括号内为所要渲染元素,挂载位置</span></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(hello, <span class="variable language_">document</span>.<span class="title function_">getELementById</span>(<span class="string">&quot;app&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>特点:</p>
<p>当插入很多数据,ReactDOM.render 会通过虚拟 DOM 方式生成一个 diff,只插入一次.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用大括号形式将js函数编入HTML</span></span><br><span class="line"><span class="keyword">const</span> name = <span class="string">&quot;Tom&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> ele = (</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">className</span>=<span class="string">&quot;red&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Tom&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    hello,&#123;name&#125;</span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line">);</span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(ele, <span class="variable language_">document</span>.<span class="title function_">getELementById</span>(<span class="string">&quot;app&quot;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="书写格式"><a href="#书写格式" class="headerlink" title="书写格式"></a>书写格式</h2><p>src 下新建一个组件 Demo.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/Demo.js</span></span><br><span class="line"><span class="comment">//引入react</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="comment">//新建类class</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">    <span class="comment">//render方法渲染</span></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &lt;h1&gt; <span class="title class_">Hello</span> <span class="title class_">React</span> &lt;h1&gt;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Demo</span></span><br></pre></td></tr></table></figure>

<h3 id="组件挂载"><a href="#组件挂载" class="headerlink" title="组件挂载"></a>组件挂载</h3><p>将组件挂载到 ReactDOM 节点上</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ReactDOM</span> <span class="keyword">from</span> <span class="string">&quot;react-dom&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Demo</span> <span class="keyword">from</span> <span class="string">&quot;./Demo&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDom</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Demo</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;root&quot;</span>));</span><br></pre></td></tr></table></figure>

<h1 id="JSX"><a href="#JSX" class="headerlink" title="JSX"></a>JSX</h1><p>javascript 语法扩展.</p>
<p>在花括号{}中可以添加任意 js 的表达式(expressions).</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Demo.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Demo</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> todoList = [<span class="string">&quot;Learn React&quot;</span>, <span class="string">&quot;Learn Redux&quot;</span>];</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello React<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;todoList.map((item) =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Demo</span>;</span><br></pre></td></tr></table></figure>

<h2 id="JSX-实质"><a href="#JSX-实质" class="headerlink" title="JSX 实质"></a>JSX 实质</h2><p>JSX 是语法糖–<code>React.createElement()</code></p>
<p>JSX 返回 ReactElement 对象</p>
<h1 id="实操总结"><a href="#实操总结" class="headerlink" title="实操总结"></a>实操总结</h1><p>&#x2F;&#x2F;jsx 中函数必须用{}括起来,不要有空格,否则失效</p>
<p>&#x2F;&#x2F;jsx 中调用类中的函数要加 this</p>
<p>&#x2F;&#x2F;在 jsx 之前要把要用的参数提前解构出来</p>
<p>&#x2F;&#x2F;函数中调用也要解构</p>
<h1 id="组件通信-属性传值-Props-x2F-State-x2F-Forms"><a href="#组件通信-属性传值-Props-x2F-State-x2F-Forms" class="headerlink" title="组件通信(属性传值)Props&#x2F;State&#x2F;Forms"></a>组件通信(属性传值)Props&#x2F;State&#x2F;Forms</h1><h2 id="组件和-Props-属性"><a href="#组件和-Props-属性" class="headerlink" title="组件和 Props(属性)"></a>组件和 Props(属性)</h2><ul>
<li>组件像函数一样,接受特定的输入(props),产生特定的输出(React Elements)</li>
<li>V &#x3D; f(props)</li>
<li>props 像纯函数一样,只读,不可变化</li>
</ul>
<p><code>props.children</code>可以拿到 div 下的首尾标签的子元素</p>
<p>示例:</p>
<h2 id="class-形式带状态组件"><a href="#class-形式带状态组件" class="headerlink" title="class 形式带状态组件"></a>class 形式带状态组件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">NameCard</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="comment">//使用render()进行渲染</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; name, number, isHuman, tags &#125; = <span class="variable language_">this</span>.<span class="property">props</span>;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h4</span>&gt;</span>&#123;name&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>电话: &#123;number&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;isHuman ? &quot;人类&quot; : &quot;外星人&quot;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;tags.map((tag, index) =&gt; (</span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">span</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;tag&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            ))&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">NameCard</span>;</span><br></pre></td></tr></table></figure>

<h3 id="函数式组件-无状态组件"><a href="#函数式组件-无状态组件" class="headerlink" title="函数式组件(无状态组件)"></a>函数式组件(无状态组件)</h3><p>无状态,没有生命周期</p>
<h4 id="示例一"><a href="#示例一" class="headerlink" title="示例一"></a>示例一</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Hello</span>(<span class="params">props</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>hello,&#123;props.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>年龄: &#123;props.age&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Hello</span> <span class="attr">name</span>=<span class="string">&quot;Tom&quot;</span> <span class="attr">age</span>=<span class="string">&quot;12&quot;</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;app&quot;</span>));</span><br></pre></td></tr></table></figure>

<h4 id="示例二"><a href="#示例二" class="headerlink" title="示例二"></a>示例二</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">NameCard</span> = (<span class="params">props</span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;name, number, isHuman, tags &#125; = <span class="variable language_">this</span>.<span class="property">props</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">h4</span>&gt;</span>&#123;name&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>电话: &#123;number&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123; isHuman ? &#x27;人类&#x27; : &#x27;外星人&#x27; &#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">hr</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        &#123; tags.map((tag,index) =&gt; (</span></span><br><span class="line"><span class="language-xml">                            <span class="tag">&lt;<span class="name">span</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;tag&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                        ))&#125;</span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="State-状态"><a href="#State-状态" class="headerlink" title="State(状态)"></a>State(状态)</h2><ul>
<li>组件内部的数据可以动态改变</li>
<li><code>this.setState()</code>是更新 state 的唯一途径</li>
</ul>
<h3 id="示例-LikesButton"><a href="#示例-LikesButton" class="headerlink" title="示例:LikesButton"></a>示例:LikesButton</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//cpmponents/LikesButton.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LikesButton</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">likes</span>: <span class="number">0</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//如果未使用箭头函数说明this,需绑定this</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">increaseLikes</span> = <span class="variable language_">this</span>.<span class="property">increaseLikes</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">type</span>=<span class="string">&quot;button&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          // <span class="attr">函数要使用驼峰式</span>,<span class="attr">最好使用箭头函数</span>,<span class="attr">否则this指向不明</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">            this.increaseLikes();</span></span><br><span class="line"><span class="language-xml">          &#125;&#125;</span></span><br><span class="line"><span class="language-xml">        &gt;</span></span><br><span class="line"><span class="language-xml">          点赞 &#123;this.state.likes&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">LikesButton</span>;</span><br></pre></td></tr></table></figure>

<h2 id="生命周期"><a href="#生命周期" class="headerlink" title="生命周期"></a>生命周期</h2><ul>
<li>组件挂载</li>
<li>组件更新</li>
<li>组件卸载</li>
<li>错误处理</li>
</ul>
<p><img src="https://s1.ax1x.com/2020/06/28/NgZCwD.png#alt="></p>
<h3 id="挂载"><a href="#挂载" class="headerlink" title="挂载"></a>挂载</h3><p>当组件实例被创建并插入 DOM 中,生命周期调用顺序为</p>
<ul>
<li><code>constructor()</code></li>
</ul>
<p>构造函数初始化,最先被执行,初始化<code>state</code>等</p>
<ul>
<li><code>static getDerivedStateFromProps()</code></li>
</ul>
<p>这是一个静态方法，需要在前面增加 static 的属性</p>
<ul>
<li><code>render()</code></li>
</ul>
<p>渲染函数，返回渲染的内容，当页面产生更新也会触发该方法。</p>
<p><code>render()</code>方法是<code>class</code>组件中唯一必须实现的方法。</p>
<ul>
<li><code>componentDidMount</code></li>
</ul>
<p>组件挂载之后，这个时候组件已经挂载完毕了</p>
<h3 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h3><p>当组件的<code>props</code>或<code>state</code>发生变化时会触发更新。组件更新的生命周期调用顺序如下：</p>
<ul>
<li><code>static getDrivedStateFromProps()</code></li>
</ul>
<p>组件即将被更新，这里参数分别对应前后被修改的内容，通过返回一个布尔值告知是否需要更新视图。</p>
<ul>
<li><code>shouldComponentUpdate()</code></li>
</ul>
<p>如果<code>shouldComponentUpdate()</code>返回<code>false</code>，则不会调用<code>render()</code>。</p>
<ul>
<li><code>render()</code></li>
</ul>
<p>当视图更新，那么 Render 也会重新更新</p>
<ul>
<li><code>getSnapshotBeforeUpdate</code></li>
</ul>
<p><code>getSnapshotBeforeUpdate</code>在<code>render</code>之后<code>componentDidUpdate</code>之前输出，类似于中间件用来做一些捕获操作。</p>
<ul>
<li><code>componentDidUpdate</code></li>
</ul>
<p><code>componentDidUpdate(prevProps, prevState, snapshot)</code>,三个参数 prevProps，prevState，snapshot，表示之前的 props，之前的 state，和 snapshot。snapshot 是 getSnapshotBeforeUpdate 返回的值.</p>
<h3 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h3><p>当组件从 DOM 中移除时会调用如下方法：</p>
<p><code>componentWillUnmount</code></p>
<p>组件卸载，我们可以清除一些定时器,取消网络请求。</p>
<h3 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h3><p>当渲染过程，生命周期，或子组件的构造函数中抛出错误时，会调用如下方法：</p>
<ul>
<li><code>static getDrivedStateFromError()</code></li>
<li><code>componentDidCatch()</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">constructor</span> (props) &#123;</span><br><span class="line">  <span class="variable language_">super</span>(props)</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">state</span> = &#123;&#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1.constructor构造函数&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">componentDidMount () &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentDidMount&#x27;</span>)</span><br><span class="line">  <span class="title class_">Store</span>.<span class="title function_">subscribe</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;&#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> getDerivedStateFromProps (nextProps, prevState) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;getDerivedStateFromProps&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(nextProps, prevState)</span><br><span class="line">  <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">getSnapshotBeforeUpdate (prevProps, prevState) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(prevProps, prevState)</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&#x27;top: 200&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">componentDidUpdate (prevProps, prevState, snapshot) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(prevProps, prevState, snapshot)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">componentWillUnmount () &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;componentWillUnmount&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">changeText () &#123;</span><br><span class="line">  <span class="title class_">Store</span>.<span class="title function_">dispatch</span>(&#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&#x27;changeName&#x27;</span>,</span><br><span class="line">    <span class="attr">value</span>: <span class="string">&#x27;我是ClassDemo中修改的名字： wangly&#x27;</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">render () &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;3.render函数&#x27;</span>)</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123; Store.getState().redux_name &#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123; this.state.redux_name &#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.changeText.bind</span>(<span class="attr">this</span>) &#125;&gt;</span>更改文本<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="示例-电子钟表"><a href="#示例-电子钟表" class="headerlink" title="示例: 电子钟表"></a>示例: 电子钟表</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//components/DigitalClock.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DigitalClock</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="comment">//初始化props</span></span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="comment">//初始化状态</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="comment">//初始值</span></span><br><span class="line">      <span class="attr">date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(),</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//加载前可以发起ajax请求,拉取接口数据</span></span><br><span class="line">  <span class="title function_">componentWillMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;组件加载前&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//挂载后使用定时器更新时间</span></span><br><span class="line">  <span class="title function_">componentDidMount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">timer</span> = setIntervalo(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">        <span class="attr">date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(),</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//结束时,卸载</span></span><br><span class="line">  <span class="title function_">componentWillUnmount</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">timer</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//组件是否应该更新</span></span><br><span class="line">  <span class="title function_">shouldCompnentUpdate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//为true时执行数据更新</span></span><br><span class="line">  <span class="title function_">componentWillUpdate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;数据将要更新&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">componentDidUpdate</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;数据已经更新&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;this.state.date.toLocalTimeString()&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">DigitalClock</span>;</span><br></pre></td></tr></table></figure>

<h2 id="事件处理中-this-的绑定"><a href="#事件处理中-this-的绑定" class="headerlink" title="事件处理中 this 的绑定"></a>事件处理中 this 的绑定</h2><ol>
<li>箭头函数</li>
<li>class 中 bind 绑定</li>
<li>事件中使用箭头函数</li>
<li>事件中使用 bind 绑定</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Hello</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="comment">//初始化props</span></span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="comment">//初始化状态</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;Tom&quot;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">12</span>,</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//或者在class内部通过bind绑定this</span></span><br><span class="line">    <span class="comment">//this.updateUser = this.updateUser.bind(this)</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//数据更新</span></span><br><span class="line">  updateUser = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//使用箭头函数将this指向当前实例</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;Jack&quot;</span>,</span><br><span class="line">      <span class="attr">age</span>: <span class="number">13</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">//外部就可以拿到this</span></span><br><span class="line">  <span class="comment">//就可以使用普通函数定义</span></span><br><span class="line">  <span class="comment">/*updateUser()&#123;</span></span><br><span class="line"><span class="comment">        this.setState(&#123;</span></span><br><span class="line"><span class="comment">            name: &#x27;Jack&#x27;,</span></span><br><span class="line"><span class="comment">            age: 12</span></span><br><span class="line"><span class="comment">        &#125;)</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">//渲染</span></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello,&#123;this.state.name&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>年龄: &#123;this.state.age&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.updateUser&#125;</span>&gt;</span>更新数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        //或者在此处改为</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.updateUser()&#125;&gt;更新数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.updateUser.bind(this)&#125;</span>&gt;</span>更新数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Hello</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;app&quot;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h2><p>通常使用三元运算符</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;isLogin ? <span class="tag">&lt;<span class="name">Login</span> /&gt;</span> : <span class="tag">&lt;<span class="name">Logout</span> /&gt;</span>&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br></pre></td></tr></table></figure>

<h2 id="组件通信-组件传值"><a href="#组件通信-组件传值" class="headerlink" title="组件通信(组件传值)"></a>组件通信(组件传值)</h2><h3 id="子组件获取父组件的值-Props"><a href="#子组件获取父组件的值-Props" class="headerlink" title="子组件获取父组件的值 Props"></a>子组件获取父组件的值 Props</h3><p>通过 Props 可以快捷的拿到父组件的值.</p>
<ol>
<li>在子组件上添加属性名和数据</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;classDemo name=<span class="string">&quot;Tom&quot;</span>&gt;&lt;/classDemo&gt;&gt;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>在 class 中使用 Props</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">constructor</span>(<span class="params">props</span>)&#123;</span><br><span class="line">    <span class="variable language_">super</span>(props)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">        <span class="attr">defaultText</span>: <span class="string">&quot;默认文字&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>通过<code>this.props.父组件绑定的属性名</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;&#123;<span class="variable language_">this</span>.<span class="property">props</span>.<span class="property">name</span>&#125;&lt;/p&gt;</span><br></pre></td></tr></table></figure>

<h3 id="子组件传递父组件"><a href="#子组件传递父组件" class="headerlink" title="子组件传递父组件"></a>子组件传递父组件</h3><p>通过 props 传递一个函数,当子组件需要改变父组件的值时,通过<code>this.props.[自定义函数]</code>执行回调.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">childText</span>: <span class="string">&quot;123&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  onPropChange = <span class="function">(<span class="params">val</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">childText</span>: val,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;this.state.childText&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ClassDemo</span> <span class="attr">onChange</span>=<span class="string">&#123;this.onPropChange&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">ClassDemo</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ClassDemo</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>)&#123;</span><br><span class="line">        <span class="variable language_">super</span>(props)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">            <span class="attr">defaultText</span>: <span class="string">&#x27;默认文字&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    changeText = <span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">props</span>.<span class="title function_">onChange</span>(<span class="string">&#x27;321&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;</span> <span class="attr">this.changeText</span> &#125;&gt;</span>修改文本<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="列表渲染-循环"><a href="#列表渲染-循环" class="headerlink" title="列表渲染(循环)"></a>列表渲染(循环)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">List</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">list</span>: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>],</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> arr = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">list</span>;</span><br><span class="line">    <span class="keyword">const</span> listItem = [];</span><br><span class="line">    <span class="comment">//使用map方法遍历</span></span><br><span class="line">    <span class="comment">//将初始值加上li标签填入新的list中</span></span><br><span class="line">    arr.<span class="title function_">map</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">      listItem.<span class="title function_">push</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//使用return渲染出新的listItem</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;listItem&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">List</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;app&quot;</span>));</span><br></pre></td></tr></table></figure>

<h2 id="Forms-表单应用"><a href="#Forms-表单应用" class="headerlink" title="Forms 表单应用"></a>Forms 表单应用</h2><p>数据发生变化后需要使用 this.setSate 进行更改数据,否则不会生效</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Forms</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">list</span>: [],</span><br><span class="line">      <span class="attr">val</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  handleChange = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 错误写法 val = event.target.value</span></span><br><span class="line">    <span class="comment">//数据发生变化后需要使用this.setSate进行更改数据</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">val</span>: event.<span class="property">target</span>.<span class="property">value</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  handleAdd = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">//从state中获取val和list</span></span><br><span class="line">    <span class="keyword">const</span> &#123; val, list &#125; = <span class="variable language_">this</span>.<span class="property">state</span>;</span><br><span class="line">    <span class="comment">//将输入的新值添加到list中</span></span><br><span class="line">    list.<span class="title function_">push</span>(val);</span><br><span class="line">    <span class="comment">//重新赋值state</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      list,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> arr = <span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">list</span>;</span><br><span class="line">    <span class="keyword">const</span> listItem = [];</span><br><span class="line">    arr.<span class="title function_">map</span>(<span class="function">(<span class="params">item, index</span>) =&gt;</span> &#123;</span><br><span class="line">      listItem.<span class="title function_">push</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span>);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">value</span>=<span class="string">&#123;this.state.val&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onChange</span>=<span class="string">&#123;this.handleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleAdd&#125;</span>&gt;</span>点击添加<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">ul</span>&gt;</span>&#123;listItem&#125;<span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">ReactDOM</span>.<span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Form</span> /&gt;</span></span>, <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;app&quot;</span>));</span><br></pre></td></tr></table></figure>

<h3 id="受控组件和非受控组件"><a href="#受控组件和非受控组件" class="headerlink" title="受控组件和非受控组件"></a>受控组件和非受控组件</h3><p>受控组件: React 控制输入的表单元素</p>
<p>实例: 留言框</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CommentBox.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CommentBox</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">value</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//如果不使用bind绑定,可以在函数声明时使用箭头函数方法</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handleChange</span> = <span class="variable language_">this</span>.<span class="property">handleChange</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handleSubmit</span> = <span class="variable language_">this</span>.<span class="property">handleSubmit</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">handleChange</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">value</span>: event.<span class="property">target</span>.<span class="property">value</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">handleSubmit</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">value</span>);</span><br><span class="line">    event.<span class="title function_">preventDefault</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">&#123;this.handleSubmit&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">label</span>&gt;</span>留言内容<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">placeholder</span>=<span class="string">&quot;请输入内容&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">onChange</span>=<span class="string">&#123;this.handlechange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">value</span>=<span class="string">&#123;this.state.value&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>留言<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">CommonBox</span>;</span><br></pre></td></tr></table></figure>

<p>非受控组件写法</p>
<p>将真实数据保存在 DOM 中</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CommentBox.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CommentBox</span> <span class="keyword">extends</span> <span class="title class_ inherited__">React.Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">handleSubmit</span> = <span class="variable language_">this</span>.<span class="property">handleSubmit</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">handleSubmit</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">textInput</span>.<span class="property">value</span>);</span><br><span class="line">    event.<span class="title function_">preventDefault</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">&#123;this.handleSubmit&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">label</span>&gt;</span>留言内容<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">placeholder</span>=<span class="string">&quot;请输入内容&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">ref</span>=<span class="string">&#123;(textInput)</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-xml">              this.textInput = textInput;</span></span><br><span class="line"><span class="language-xml">            &#125;&#125;</span></span><br><span class="line"><span class="language-xml">          /&gt;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span>留言<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">CommonBox</span>;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/this%E4%BB%96%E5%96%B5%E7%9A%84%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E4%B9%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/this%E4%BB%96%E5%96%B5%E7%9A%84%E5%88%B0%E5%BA%95%E6%98%AF%E4%BB%80%E4%B9%88/" class="post-title-link" itemprop="url">this他喵的到底是什么</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:08:05" itemprop="dateCreated datePublished" datetime="2022-09-26T21:08:05+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:52" itemprop="dateModified" datetime="2022-12-27T11:12:52+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<h2 id="title-this-他喵的到底是什么-date-2020-07-09-15-20-43"><a href="#title-this-他喵的到底是什么-date-2020-07-09-15-20-43" class="headerlink" title="title: this 他喵的到底是什么 date: 2020-07-09 15:20:43"></a>title: this 他喵的到底是什么 date: 2020-07-09 15:20:43</h2><p>tags:</p>
<blockquote>
<p>原文地址：WTF is this - Understanding the this keyword, call, apply, and bind in JavaScript</p>
</blockquote>
<p>原文作者：Tyler McGinnis</p>
<p>译文出自：掘金翻译计划</p>
<p>本文永久链接：github.com&#x2F;xitu&#x2F;gold-m…</p>
<p>译者：CoolRice</p>
<p>校对者：周家未</p>
<p>在深入了解 JavaScript 中的 this 关键字之前，有必要先退一步，看一下为什么 this 关键字很重要。this 允许复用函数时使用不同的上下文。换句话说，“this” 关键字允许在调用函数或方法时决定哪个对象应该是焦点。 之后讨论的所有东西都是基于这个理念。我们希望能够在不同的上下文或在不同的对象中复用函数或方法。</p>
<p>我们要关注的第一件事是如何判断 this 关键字的引用。当你试图回答这个问题时，你需要问自己的第一个也是最重要的问题是“这个函数在哪里被调用？”。判断 this 引用什么的 唯一 方法就是看使用 this 关键字的这个方法在哪里被调用的。</p>
<p>用一个你已经十分熟悉的例子来展示这一点，比如我们有一个 greet 方法，它接受一个名字参数并显示有欢迎消息的警告框。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果我问你 greet 会具体警告什么内容，你会怎样回答？只给出函数定义是不可能知道答案的。为了知道 name 是什么，你必须看看 greet 函数的调用过程。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">greet</span>(<span class="string">&quot;Tyler&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>判断 this 关键字引用什么也是同样的道理，你甚至可以把 this 当成一个普通的函数参数对待 — 它会随着函数调用方式的变化而变化。</p>
<p>现在我们知道为了判断 this 的引用必须先看函数的定义，在实际地查看函数定义时，我们设立了四条规则来查找引用，它们是</p>
<ol>
<li>隐式绑定</li>
<li>显式绑定</li>
<li>new 绑定</li>
<li>window 绑定</li>
</ol>
<h2 id="隐式绑定"><a href="#隐式绑定" class="headerlink" title="隐式绑定"></a>隐式绑定</h2><p>请记住，这里的目标是查看使用 this 关键字的函数定义，并判断 this 的指向。执行绑定的第一个也是最常见的规则称为 隐式绑定。80% 的情况下它会告诉你 this 关键字引用的是什么。</p>
<p>假如我们有一个这样的对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Tyler&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">27</span>,</span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>现在，如果你要调用 user 对象上的 greet 方法，你会用到点号。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user.<span class="title function_">greet</span>();</span><br></pre></td></tr></table></figure>

<p>这就把我们带到隐式绑定规则的主要关键点。为了判断 this 关键字的引用，函数被调用时先看一看点号左侧。如果有“点”就查看点左侧的对象，这个对象就是 this 的引用。</p>
<p>在上面的例子中，user 在“点号左侧”意味着 this 引用了 user 对象。所以就好像 在 greet 方法的内部 JavaScript 解释器把 this 变成了 user。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// alert(`Hello, my name is $&#123;this.name&#125;`)</span></span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;user.name&#125;</span>`</span>) <span class="comment">// Tyler</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们来看一个类似但稍微高级点的例子。现在，我们的对象不仅要拥有 name、age 和 greet 属性，还要被添加一个 mother 属性，并且此属性也拥有 name 和 greet 属性。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Tyler&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">27</span>,</span><br><span class="line">  <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">mother</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Stacey&quot;</span>,</span><br><span class="line">    <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">alert</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>现在问题变成下面的每个函数调用会警告什么？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user.<span class="title function_">greet</span>();</span><br><span class="line">user.<span class="property">mother</span>.<span class="title function_">greet</span>();</span><br></pre></td></tr></table></figure>

<p>每当判断 this 的引用时，我们都需要查看调用过程，并确认“点的左侧”是什么。第一个调用，user 在点左侧意味着 this 将引用 user。第二次调用中，mother 在点的左侧意味着 this 引用 mother。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">user.<span class="title function_">greet</span>(); <span class="comment">// Tyler</span></span><br><span class="line">user.<span class="property">mother</span>.<span class="title function_">greet</span>(); <span class="comment">// Stacey</span></span><br></pre></td></tr></table></figure>

<p>如前所述，大约有 80% 的情况下在“点的左侧”都会有一个对象。这就是为什么在判断 this 指向时“查看点的左侧”是你要做的第一件事。但是，如果没有点呢？这就为我们引出了下一条规则</p>
<h2 id="显式绑定"><a href="#显式绑定" class="headerlink" title="显式绑定"></a>显式绑定</h2><p>如果 greet 函数不是 user 对象的函数，只是一个独立的函数。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(<span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Tyler&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">27</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>我们知道为了判断 this 的引用我们首先必须查看这个函数的调用位置。现在就引出了一个问题，我们怎样能让 greet 方法调用的时候将 this 指向 user 对象？。我们不能再像之前那样简单的使用 user.greet()，因为 user 并没有 greet 方法。在 JavaScript 中，每个函数都包含了一个能让你恰好解决这个问题的方法，这个方法的名字叫做 call。</p>
<blockquote>
<p><code>call</code>是每个函数都有的一个方法，它允许你在调用函数时为函数指定上下文。</p>
</blockquote>
<p>考虑到这一点，用下面的代码可以在调用 greet 时用 user 做上下文。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">greet.<span class="title function_">call</span>(user);</span><br></pre></td></tr></table></figure>

<p>再强调一遍，call 是每个函数都有的一个属性，并且传递给它的第一个参数会作为函数被调用时的上下文。换句话说，this 将会指向传递给 call 的第一个参数。</p>
<p>这就是第 2 条规则的基础（显示绑定），因为我们明确地（使用 .call）指定了 this 的引用。</p>
<p>现在让我们对 greet 方法做一点小小的改动。假如我们想传一些参数呢？不仅提示他们的名字，还要提示他们知道的语言。就像下面这样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">lang1, lang2, lang3</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(</span><br><span class="line">    <span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span> and I know <span class="subst">$&#123;lang1&#125;</span>, <span class="subst">$&#123;lang2&#125;</span>, and <span class="subst">$&#123;lang3&#125;</span>`</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>现在为了将这些参数传递给使用 <code>.call</code> 调用的函数，你需要在指定上下文（第一个参数）后一个一个地传入。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">lang1, lang2, lang3</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(</span><br><span class="line">    <span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span> and I know <span class="subst">$&#123;lang1&#125;</span>, <span class="subst">$&#123;lang2&#125;</span>, and <span class="subst">$&#123;lang3&#125;</span>`</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Tyler&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">27</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> languages = [<span class="string">&quot;JavaScript&quot;</span>, <span class="string">&quot;Ruby&quot;</span>, <span class="string">&quot;Python&quot;</span>];</span><br><span class="line"></span><br><span class="line">greet.<span class="title function_">call</span>(user, languages[<span class="number">0</span>], languages[<span class="number">1</span>], languages[<span class="number">2</span>]);</span><br></pre></td></tr></table></figure>

<p>方法奏效，它显示了如何将参数传递给使用 <code>.call</code> 调用的函数。不过你可能注意到，必须一个一个传递 languages 数组的元素，这样有些恼人。如果我们可以把整个数组作为第二个参数并让 JavaScript 为我们自动展开就好了。有个好消息，这就是 <code>.apply</code> 干的事情。<code>.apply</code> 和 <code>.call</code> 本质相同，但不是一个一个传递参数，你可以用数组传参而且 <code>.apply</code> 会在函数中为你自动展开。</p>
<p>那么现在用 <code>.apply</code>，我们的代码可以改为下面这个，其他一切都保持不变。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> languages = [<span class="string">&quot;JavaScript&quot;</span>, <span class="string">&quot;Ruby&quot;</span>, <span class="string">&quot;Python&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// greet.call(user, languages[0], languages[1], languages[2])</span></span><br><span class="line">greet.<span class="title function_">apply</span>(user, languages);</span><br></pre></td></tr></table></figure>

<p>到目前为止，我们学习了关于 <code>.call</code> 和 <code>.apply</code> 的“显式绑定”规则，用此规则调用的方法可以让你指定 this 在方法内的指向。关于这个规则的最后一个部分是 <code>.bind</code>。<code>.bind</code> 和 <code>.call</code> 完全相同，除了不会立刻调用函数，而是返回一个能以后调用的新函数。因此，如果我们看看之前所写的代码，换用 <code>.bind</code>，它看起来就像这样</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">greet</span>(<span class="params">lang1, lang2, lang3</span>) &#123;</span><br><span class="line">  <span class="title function_">alert</span>(</span><br><span class="line">    <span class="string">`Hello, my name is <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span> and I know <span class="subst">$&#123;lang1&#125;</span>, <span class="subst">$&#123;lang2&#125;</span>, and <span class="subst">$&#123;lang3&#125;</span>`</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Tyler&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">27</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> languages = [<span class="string">&quot;JavaScript&quot;</span>, <span class="string">&quot;Ruby&quot;</span>, <span class="string">&quot;Python&quot;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> newFn = greet.<span class="title function_">bind</span>(user, languages[<span class="number">0</span>], languages[<span class="number">1</span>], languages[<span class="number">2</span>]);</span><br><span class="line"><span class="title function_">newFn</span>(); <span class="comment">// alerts &quot;Hello, my name is Tyler and I know JavaScript, Ruby, and Python&quot;</span></span><br></pre></td></tr></table></figure>

<h3 id="new-绑定"><a href="#new-绑定" class="headerlink" title="new 绑定"></a>new 绑定</h3><p>第三条判断 this 引用的规则是 new 绑定。若你不熟悉 JavaScript 中的 new 关键字，其实每当用 new 调用函数时，JavaScript 解释器都会在底层创建一个全新的对象并把这个对象当做 this。如果用 new 调用一个函数，this 会自然地引用解释器创建的新对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">User</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="comment">/*</span></span><br><span class="line"><span class="comment">    JavaScript 会在底层创建一个新对象 `this`，它会代理不在 User 原型链上的属性。</span></span><br><span class="line"><span class="comment">    如果一个函数用 new 关键字调用，this 就会指向解释器创建的新对象。</span></span><br><span class="line"><span class="comment">  */</span></span><br><span class="line"></span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> me = <span class="keyword">new</span> <span class="title class_">User</span>(<span class="string">&quot;Tyler&quot;</span>, <span class="number">27</span>);</span><br></pre></td></tr></table></figure>

<h2 id="window-绑定"><a href="#window-绑定" class="headerlink" title="window 绑定"></a>window 绑定</h2><p>假如我们有下面这段代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sayAge</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`My age is <span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Tyler&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">27</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>如前所述，如果你想用 user 做上下文调用 sayAge，你可以使用 .call、.apply 或 .bind。但如果我们没有用这些方法，而是直接和平时一样直接调用 sayAge 会发生什么呢？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">sayAge</span>(); <span class="comment">// My age is undefined</span></span><br></pre></td></tr></table></figure>

<p>不出意外，你会得到 My name is undefined，因为 this.age 是 undefined。事情开始变得神奇了。实际上这是因为点的左侧没有任何东西，我们也没有用 .call、.apply、.bind 或者 new 关键字，JavaScript 会默认 this 指向 window 对象。这意味着如果我们向 window 对象添加 age 属性并再次调用 sayAge 方法，this.age 将不再是 undefined 并且变成 window 对象的 age 属性值。不相信？让我们运行这段代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">age</span> = <span class="number">27</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sayAge</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`My age is <span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>非常神奇，不是吗？这就是第 4 条规则为什么是 window 绑定 的原因。如果其它规则都没满足，JavaScript 就会默认 this 指向 window 对象。</p>
<blockquote>
<p>在 ES5 添加的 严格模式 中，JavaScript 不会默认 this 指向 window 对象，而会正确地把 this 保持为 undefined。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&quot;use strict&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">age</span> = <span class="number">27</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sayAge</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`My age is <span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">sayAge</span>(); <span class="comment">// TypeError: Cannot read property &#x27;age&#x27; of undefined</span></span><br></pre></td></tr></table></figure>

<p>因此，将所有规则付诸实践，每当我在函数内部看到 this 关键字时，这些就是我为了判断它的引用而采取的步骤。</p>
<ol>
<li>查看函数在哪被调用。</li>
<li>点左侧有没有对象？如果有，它就是 “this” 的引用。如果没有，继续第 3 步。</li>
<li>该函数是不是用 “call”、“apply” 或者 “bind” 调用的？如果是，它会显式地指明 “this” 的引用。如果不是，继续第 4 步。</li>
<li>该函数是不是用 “new” 调用的？如果是，“this” 指向的就是 JavaScript 解释器新创建的对象。如果不是，继续第 5 步。</li>
<li>是否在“严格模式”下？如果是，“this” 就是 undefined，如果不是，继续第 6 步。</li>
<li>JavaScript 很奇怪，“this” 会指向 “window” 对象。</li>
</ol>
<h2 id="class-中-this-的绑定"><a href="#class-中-this-的绑定" class="headerlink" title="class 中 this 的绑定"></a>class 中 this 的绑定</h2><p>前景提要：当我们打印<code>typeof Cat</code>可知是函数类型，ES6 中的 class 类其实只是个语法糖，皆可以用 ES5 来实现。由构造函数 Cat 创建的实例 cat 是一个对象。在初始化 cat 实例的时候，在 constructor 中就会把 this 上的属性挂载到实例对象上面。</p>
<p>另外牢记，this 的指向与作用域无关，与调用执行函数时的上下文相关。</p>
<p>示例一：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">run</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;run&quot;</span>, <span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> cat = <span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="string">&quot;米粒&quot;</span>, <span class="string">&quot;5个月&quot;</span>);</span><br><span class="line">cat.<span class="property">name</span>; <span class="comment">// &#x27;米粒&#x27;</span></span><br><span class="line">cat.<span class="title function_">run</span>(); <span class="comment">// run Cat &#123;name: &quot;米粒&quot;&#125;</span></span><br></pre></td></tr></table></figure>

<p>当调用<code>cat.run()</code>的时候，当前上下文是 cat,所以其 this 指向的是 cat 这个实例。</p>
<p>示例二:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">jump</span> = <span class="variable language_">this</span>.<span class="property">jump</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">drink</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;drink&quot;</span>, <span class="variable language_">this</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">run</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;run&quot;</span>, <span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">jump</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;jump&quot;</span>, <span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">go</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;go&quot;</span>, <span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Cat</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">walk</span> = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;walk&quot;</span>, <span class="variable language_">this</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> cat = <span class="keyword">new</span> <span class="title class_">Cat</span>(<span class="string">&quot;米粒&quot;</span>, <span class="string">&quot;5个月&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> run = cat.<span class="property">run</span>;</span><br><span class="line"><span class="keyword">let</span> jump = cat.<span class="property">jump</span>;</span><br><span class="line"><span class="keyword">let</span> go = <span class="title class_">Cat</span>.<span class="property">go</span>;</span><br><span class="line"><span class="keyword">let</span> walk = cat.<span class="property">walk</span>;</span><br><span class="line"><span class="keyword">let</span> drink = cat.<span class="property">drink</span>;</span><br><span class="line"></span><br><span class="line"><span class="title function_">run</span>(); <span class="comment">// run undefined</span></span><br><span class="line"><span class="title function_">jump</span>(); <span class="comment">// jump Cat &#123;name: &quot;米粒&quot;, jump: ƒ&#125;</span></span><br><span class="line"><span class="title class_">Cat</span>.<span class="title function_">go</span>(); <span class="comment">// go class Cat &#123;&#125;</span></span><br><span class="line"><span class="title function_">go</span>(); <span class="comment">// go undefined</span></span><br><span class="line">cat.<span class="title function_">walk</span>(); <span class="comment">// walk Window</span></span><br><span class="line"><span class="title function_">walk</span>(); <span class="comment">// walk Window</span></span><br><span class="line">cat.<span class="title function_">drink</span>(); <span class="comment">// drink Cat &#123;name: &quot;米粒&quot;, jump: ƒ, drink: ƒ&#125;</span></span><br><span class="line"><span class="title function_">drink</span>(); <span class="comment">// drink Cat &#123;name: &quot;米粒&quot;, jump: ƒ, drink: ƒ&#125;</span></span><br></pre></td></tr></table></figure>

<p>先看 run 方法：当把实例中的方法赋值给一个变量，但是只是赋予了方法的引用，所以当变量在执行方法的时候，其实改变了方法的执行时的上下文。原来执行的上下文是实例 cat，后来赋值之后再执行，上下文就变成了全局，this 默认绑定。class 中使用的是严格模式，在该模式下，全局的 this 默认绑定的是 undefined，不是在严格模式下的时候，若在浏览器中执行，则 this 默认绑定 window。</p>
<p>jump 方法：因为在构造函数执行的时候，显式绑定了 jump 执行的上下文——cat 实例。由文章开头 this 绑定的优先级可知，显式绑定&gt;默认绑定。所以 jump 的执行上下文依然是 cat 实例</p>
<p>go 方法：go 方法使用静态方法定义，无法共享个实例 cat，只能在构造函数 Cat 上直接调用。</p>
<p>walk 与 drink 方法：这两个方法是用箭头函数定义的。箭头函数的 this 是在定义函数时绑定的，不是在执行过程中绑定的。简单的说，函数在定义时，this 就继承了定义函数的对象。</p>
<p>所以 walk 是在<code>Cat.prototype.walk</code>时定义的，此时的 this 指向是 window。无论之后赋值给哪个变量，也只是函数的引用，所以其 this 还是 window。</p>
<p>同理，drink 在定义的时候，this 指向的是该构造函数。</p>
<blockquote>
<p>在 class 中 ，this 默认指向类的实例。但是，如果将这个方法提取出来单独使用，this 会指向该方法运行时所在的环境。</p>
</blockquote>
<p>那么问题来了，既然是全局环境的话，那么此时的 this 应该是输出 window，但是却不是 window 而是 undefined。</p>
<p>那么问题出在哪？</p>
<p>其实，就是在 class 中，定义类的时候默认使用的是严格模式。</p>
<p>所以在严格模式下，由于 this 不能指向全局变量，因此这里就变成了 undefined。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/ES6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/ES6/" class="post-title-link" itemprop="url">ES6</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:07:55" itemprop="dateCreated datePublished" datetime="2022-09-26T21:07:55+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:52" itemprop="dateModified" datetime="2022-12-27T11:12:52+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<p>title: ES6</p>
<p>date: 2019-09-05 13:59:32</p>
<p>tags: javascript</p>
<p>categories:  # 这里写的分类会自动汇集到 categories 页面上，分类可以多级</p>
<ul>
<li>JS # 一级分类</li>
<li>ES6 # 二级分类</li>
</ul>
<hr>
<p>ES6 常见语法</p>
<h1 id="let-和-const"><a href="#let-和-const" class="headerlink" title="let 和 const"></a>let 和 const</h1><p><code>let</code>定义局部变量</p>
<p><code>var</code>定义全局变量.用<code>var</code>定义的全部变量，有时候会污染整个 js 的作用域。</p>
<p><code>const</code>定义常量</p>
<p>在全局作用域下使用<code>let</code>和<code>const</code>声明变量，变量并不会挂载到<code>window</code></p>
<ol>
<li>var 可声明前置(变量提升)</li>
</ol>
<p>变量会提升，函数也会提升，并且函数优先于变量提升，函数提升会把整个函数提到作用域顶部，变量提升只会把声明提上去.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">var</span> a;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">4</span>;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>let 不可声明前置</li>
</ol>
<p>暂时性死区：不能在变量声明之前使用变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">3</span>; <span class="comment">//报错</span></span><br><span class="line"><span class="keyword">let</span> a;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>let 不可重复声明</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> a = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">let</span> a = <span class="number">4</span>; <span class="comment">//报错</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">5</span>; <span class="comment">//报错</span></span><br></pre></td></tr></table></figure>

<ol start="4">
<li>存在块级作用域</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">//块级作用域只在大括号内,出了大括号,i并没有声明,会报错</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">//报错</span></span><br></pre></td></tr></table></figure>

<p>暂时性死区: 在 let 声明变量之前都是该变量的死区,在死区内该变量不可使用.不能被声明也不能被获取.</p>
<ol start="5">
<li>const 声明的常量不可改变</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line">a = <span class="number">2</span>; <span class="comment">//报错</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> obj = &#123; <span class="attr">a</span>: <span class="number">1</span> &#125;;</span><br><span class="line">obj.<span class="property">a</span> = <span class="number">2</span>; <span class="comment">//正常</span></span><br><span class="line">obj = &#123; <span class="attr">a</span>: <span class="number">2</span> &#125;; <span class="comment">//报错</span></span><br></pre></td></tr></table></figure>

<p>const 对象等于引用类型,obj 存的是<code>&#123;a: 1&#125;</code>的地址,里面的东西改变并不影响地址.而<code>obj = &#123;a: 2&#125;</code>是赋给一个新的地址,发生了改变,会报错.</p>
<ol start="6">
<li>适用于<code>let</code>同样适用于<code>const</code></li>
</ol>
<p><code>let</code>和<code>const</code>作用基本一致，<code>const</code>声明的变量不能再次赋值</p>
<p>ES6 可以大量使用<code>let</code>,如果认定模块不改变,可以使用<code>const</code></p>
<h1 id="解构赋值"><a href="#解构赋值" class="headerlink" title="解构赋值"></a>解构赋值</h1><h2 id="关于数组的解构赋值"><a href="#关于数组的解构赋值" class="headerlink" title="关于数组的解构赋值"></a>关于数组的解构赋值</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a, b, c);</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [a, [b], c] = [<span class="number">2</span>, [<span class="number">3</span>], <span class="number">4</span>];</span><br><span class="line">a; <span class="comment">//2</span></span><br><span class="line">b; <span class="comment">//3</span></span><br><span class="line">c; <span class="comment">//4</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [a] = <span class="number">1</span>; <span class="comment">//报错,因为[a]是一个数组,把值赋值给数组就报错了</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>默认值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [a, b = <span class="number">2</span>] = [<span class="number">3</span>]</span><br><span class="line">a <span class="comment">// 3</span></span><br><span class="line">b <span class="comment">// 2,因为b没有对应值,所以是undefined,使用默认值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [a, b = <span class="number">2</span>] = [<span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">a <span class="comment">//3</span></span><br><span class="line">b <span class="comment">//4</span></span><br><span class="line">数组对应对值有没有？如果没有（数组对没有指<span class="literal">undefined</span>）就使用默认值，如果有就使用对应值</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> [a=<span class="number">2</span>, b=<span class="number">3</span>] = [<span class="literal">undefined</span>, <span class="literal">null</span>]</span><br><span class="line">a <span class="comment">//2</span></span><br><span class="line">b <span class="comment">//null</span></span><br><span class="line"><span class="keyword">let</span> [a=<span class="number">1</span>, b=a] = [<span class="number">2</span>]</span><br><span class="line">a <span class="comment">//2</span></span><br><span class="line">b <span class="comment">//2,因为b没有对应值,所以是undefined,使用默认值,此时a的默认值为2</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>对象的解构赋值</li>
</ol>
<p>前置知识</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [name, age] = [<span class="string">&quot;hunger&quot;</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">let</span> p1 = &#123; name, age &#125;;</span><br><span class="line"><span class="comment">//等同于</span></span><br><span class="line"><span class="keyword">let</span> p2 = &#123; <span class="attr">name</span>: name, <span class="attr">age</span>: age &#125;;</span><br><span class="line">解构范例;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> &#123; name, age &#125; = &#123; <span class="attr">name</span>: <span class="string">&quot;jirengu&quot;</span>, <span class="attr">age</span>: <span class="number">4</span> &#125;;</span><br><span class="line">name; <span class="comment">//‘jirengu’</span></span><br><span class="line">age; <span class="comment">//4</span></span><br><span class="line">以上代码等同于;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> name;</span><br><span class="line"><span class="keyword">let</span> age;</span><br><span class="line">(&#123; <span class="attr">name</span>: name, <span class="attr">age</span>: age &#125; = &#123; <span class="attr">name</span>: <span class="string">&quot;jirengu&quot;</span>, <span class="attr">age</span>: <span class="number">4</span> &#125;);</span><br></pre></td></tr></table></figure>

<ol start="4">
<li>默认值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> &#123; x, y = <span class="number">5</span> &#125; = &#123; <span class="attr">x</span>: <span class="number">1</span> &#125;;</span><br><span class="line">x; <span class="comment">//1</span></span><br><span class="line">y; <span class="comment">//5</span></span><br></pre></td></tr></table></figure>

<ol start="5">
<li>函数解构</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">add</span>(<span class="params">[x = <span class="number">1</span>, y = <span class="number">2</span>]</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x + y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">add</span>(); <span class="comment">//Error</span></span><br><span class="line"><span class="title function_">add</span>([<span class="number">2</span>]); <span class="comment">//4</span></span><br><span class="line"><span class="title function_">add</span>([<span class="number">3</span>, <span class="number">4</span>]); <span class="comment">//7</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">&#123; x, y &#125; = &#123; x: <span class="number">0</span>, y: <span class="number">0</span> &#125;, &#123; a = <span class="number">1</span>, b = <span class="number">1</span> &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [x + a, y + b];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">sum</span>(&#123; <span class="attr">x</span>: <span class="number">1</span>, <span class="attr">y</span>: <span class="number">2</span> &#125;, &#123; <span class="attr">a</span>: <span class="number">2</span> &#125;); <span class="comment">//[3, 3]</span></span><br></pre></td></tr></table></figure>

<ol start="6">
<li>作用</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> [x, y] = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line">[x, y] = [y, x]</span><br><span class="line">x <span class="comment">//2</span></span><br><span class="line">y <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ajax</span>(<span class="params">&#123;url, type=‘GET’&#125;</span>)&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">ajax</span>(&#123;<span class="attr">url</span>: ‘<span class="attr">http</span>:<span class="comment">//localhost:3000/getData’&#125;)</span></span><br></pre></td></tr></table></figure>

<h1 id="字符串-数组-对象"><a href="#字符串-数组-对象" class="headerlink" title="字符串,数组,对象"></a>字符串,数组,对象</h1><h2 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h2><ol>
<li>多行字符串</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> str = <span class="string">`</span></span><br><span class="line"><span class="string">Hi,</span></span><br><span class="line"><span class="string">This is jirengu.com.</span></span><br><span class="line"><span class="string">You can study frontend here.</span></span><br><span class="line"><span class="string">`</span>;</span><br></pre></td></tr></table></figure>

<ol>
<li>字符串模板</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> website = <span class="string">&quot;jirengucom&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> who = <span class="string">&quot;You&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> str = <span class="string">`Hi</span></span><br><span class="line"><span class="string">This is <span class="subst">$&#123;website&#125;</span>.</span></span><br><span class="line"><span class="string"><span class="subst">$&#123;who&#125;</span> can study frontend here</span></span><br><span class="line"><span class="string">`</span>;</span><br><span class="line"><span class="comment">//$&#123;&#125;,可以替换变量</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> data = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"><span class="keyword">var</span> liArr = data.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> <span class="string">`&lt;li&gt;<span class="subst">$&#123;v&#125;</span>&lt;/li&gt;`</span>).<span class="title function_">join</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> html = <span class="string">`&lt;ul&gt;<span class="subst">$&#123;liArr&#125;</span>&lt;/ul&gt;`</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(html);</span><br><span class="line"><span class="comment">//&quot;&lt;ul&gt;&lt;li&gt;1&lt;/li&gt;&lt;li&gt;2&lt;/li&gt;&lt;li&gt;3&lt;/li&gt;&lt;li&gt;4&lt;/li&gt;&lt;/ul&gt;&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><ol>
<li>扩展运算符<code>...</code></li>
</ol>
<p><strong>主要作用</strong>是将数组或对象进行展开.</p>
<blockquote>
<p>对象中的扩展运算符(…)用于取出参数对象中的所有可遍历属性，拷贝到当前对象之中</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> a = [<span class="number">1</span>, <span class="number">2</span>];</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(...a); <span class="comment">// 1, 2,这三个点相当于脱壳,把数组的壳拿掉</span></span><br><span class="line"><span class="keyword">var</span> b = [...a, <span class="number">3</span>];</span><br><span class="line">b; <span class="comment">// [1, 2, 3]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> c = b.<span class="title function_">concat</span>([<span class="number">4</span>, <span class="number">5</span>]); <span class="comment">//b拼接[4,5]变成[1,2,3,4,5]</span></span><br><span class="line"><span class="keyword">var</span> d = [...b, <span class="number">4</span>, <span class="number">5</span>]; <span class="comment">//直接把脱壳后的1,2,3放入数组中</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>函数参数的扩展</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sort</span>(<span class="params">...arr</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(arr.<span class="title function_">sort</span>());</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">sort</span>(<span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>); <span class="comment">//[1, 3, 5]</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">max</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">max</span>(...arr);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">max</span>([<span class="number">3</span>, <span class="number">4</span>, <span class="number">1</span>]); <span class="comment">// 4</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>类数组对象转数组</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ps = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(ps).<span class="title function_">forEach</span>(<span class="function">(<span class="params">p</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="property">innerText</span>);</span><br><span class="line">&#125;);</span><br><span class="line">[...ps].<span class="title function_">forEach</span>(<span class="function">(<span class="params">p</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="property">innerText</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><ol>
<li>默认值</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sayHi</span>(<span class="params">name = <span class="string">&quot;jirengu&quot;</span></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`hi, <span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">sayHi</span>();</span><br><span class="line"><span class="title function_">sayHi</span>(<span class="string">&quot;ruoyu&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fetch</span>(<span class="params">url, &#123; body = <span class="string">&quot;&quot;</span>, method = <span class="string">&quot;GET&quot;</span>, headers = &#123;&#125; &#125; = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(method);</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&quot;http://example.com&quot;</span>); <span class="comment">//如果没有定义那么就是undefined,使用默认值,如果传入了参数,那就使用传入值</span></span><br></pre></td></tr></table></figure>

<p><em>以下两种写法的区别?</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ex1</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">m1</span>(<span class="params">&#123; x = <span class="number">0</span>, y = <span class="number">0</span> &#125; = &#123;&#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ex2</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">m2</span>(<span class="params">&#123; x, y &#125; = &#123; x: <span class="number">0</span>, y: <span class="number">0</span> &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [x, y];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数没有参数的情况</span></span><br><span class="line"><span class="title function_">m1</span>(); <span class="comment">// [0, 0]</span></span><br><span class="line"><span class="title function_">m2</span>(); <span class="comment">// [0, 0]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// x 和 y 都有值的情况</span></span><br><span class="line"><span class="title function_">m1</span>(&#123; <span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span> &#125;); <span class="comment">// [3, 8]</span></span><br><span class="line"><span class="title function_">m2</span>(&#123; <span class="attr">x</span>: <span class="number">3</span>, <span class="attr">y</span>: <span class="number">8</span> &#125;); <span class="comment">// [3, 8]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// x 有值，y 无值的情况</span></span><br><span class="line"><span class="title function_">m1</span>(&#123; <span class="attr">x</span>: <span class="number">3</span> &#125;); <span class="comment">// [3, 0]</span></span><br><span class="line"><span class="title function_">m2</span>(&#123; <span class="attr">x</span>: <span class="number">3</span> &#125;); <span class="comment">// [3, undefined]</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// x 和 y 都无值的情况</span></span><br><span class="line"><span class="title function_">m1</span>(&#123;&#125;); <span class="comment">// [0, 0];把&#123;&#125;赋给(x = 0,y = 0)</span></span><br><span class="line"><span class="title function_">m2</span>(&#123;&#125;); <span class="comment">// [undefined, undefined];把&#123;&#125;赋给&#123;x,y&#125;,也就是把undefined, undefined赋给&#123;x,y&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">m1</span>(&#123; <span class="attr">z</span>: <span class="number">3</span> &#125;); <span class="comment">// [0, 0]</span></span><br><span class="line"><span class="title function_">m2</span>(&#123; <span class="attr">z</span>: <span class="number">3</span> &#125;); <span class="comment">// [undefined, undefined]</span></span><br></pre></td></tr></table></figure>

<p>ex1：调用函数需要你传递一个对象，如果你没传对象就用默认值对象{}，默认值对象里面都是 undefined， 所以属性使用初始值</p>
<p>ex2：参数需要是一个对象，如果没传对象，就用默认值对象{ x: 0, y: 0 }如果传了对象，就使用你传递的对象</p>
<ol start="2">
<li>箭头函数</li>
</ol>
<p>箭头后面的内容，就相当于<code>return</code>的内容。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title function_">f</span> = (<span class="params">v</span>) =&gt; v + <span class="number">1</span>;</span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="keyword">function</span> (<span class="params">v</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> v + <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">f</span> = (<span class="params"></span>) =&gt; <span class="number">5</span>;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">var</span> f = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">5</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">sum</span> = (<span class="params">num1, num2</span>) =&gt; num1 + num2; <span class="comment">//适用于立刻返回,即把代码写成一行的情况</span></span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">var</span> sum = <span class="keyword">function</span> (<span class="params">num1, num2</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> num1 + num2;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//数组的平方</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">var</span> arr2 = arr.<span class="title function_">map</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> v * v);</span><br><span class="line">arr2; <span class="comment">//[1, 4, 9]</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>箭头函数里面的 this</li>
</ol>
<p>1.箭头函数会捕获其所在上下文的 this 值作为自己的 this 值,自己本身并没有 this 值.</p>
<p>2.箭头函数的 this 永远指向其上下文的 this,任何方法都改变不了其指向,如 call,bind,apply.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES6</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;id:&quot;</span>, <span class="variable language_">this</span>.<span class="property">id</span>);</span><br><span class="line">  &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  等同于如下ES5</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> _this = <span class="variable language_">this</span>;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;id:&quot;</span>, _this.<span class="property">id</span>);</span><br><span class="line">  &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> name = <span class="string">&quot;jirengu&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> age = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">var</span> people = &#123; name, age &#125;; <span class="comment">//&#123;name:&#x27;jirengu&#x27;, age:3&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> app = &#123;</span><br><span class="line">  <span class="attr">selector</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">  <span class="comment">//函数简写</span></span><br><span class="line">  <span class="title function_">init</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">  <span class="title function_">bind</span>(<span class="params"></span>) &#123;&#125;,</span><br><span class="line">&#125;;</span><br><span class="line">app.<span class="title function_">init</span>();</span><br></pre></td></tr></table></figure>

<h1 id="类和继承"><a href="#类和继承" class="headerlink" title="类和继承"></a>类和继承</h1><ol>
<li>构造函数</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`hello, <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>, i am <span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span> years old`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">等价于;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">sayHello</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`hello, <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>, i am <span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span> years old`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="title class_">Person</span>(<span class="string">&quot;hunger&quot;</span>, <span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<h2 id="静态方法"><a href="#静态方法" class="headerlink" title="静态方法"></a>静态方法</h2><p>静态方法调用直接在类上进行，不能在类的实例上调用。</p>
<p>下面的例子说明了这几点:</p>
<p>静态方法如何在类上实现。</p>
<p>具有静态成员的类，可以被子类化 。</p>
<p>什么情况下静态方法可以调用，什么情况下不能调用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Tripple</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">tripple</span>(<span class="params">n = <span class="number">1</span></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> n * <span class="number">3</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BiggerTripple</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Tripple</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">tripple</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">super</span>.<span class="title function_">tripple</span>(n) * <span class="variable language_">super</span>.<span class="title function_">tripple</span>(n);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Tripple</span>.<span class="title function_">tripple</span>()); <span class="comment">// 3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Tripple</span>.<span class="title function_">tripple</span>(<span class="number">6</span>)); <span class="comment">// 18</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> tp = <span class="keyword">new</span> <span class="title class_">Tripple</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">BiggerTripple</span>.<span class="title function_">tripple</span>(<span class="number">3</span>)); <span class="comment">// 81（不会受父类实例化的影响）</span></span><br><span class="line"><span class="comment">//super继承父类的方法super.tripple(n) = 3n,BiggerTripple.tripple(n) = (3n)^2.当n=3,输出81</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(tp.<span class="title function_">tripple</span>()); <span class="comment">// &#x27;tp.tripple 不是一个函数&#x27;.说明只能在类上实现.</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>继承</li>
</ol>
<p>js 中并不存在类，<code>class</code>只是语法糖，本质是函数</p>
<p>class 继承的核心在于使用<code>extends</code>表明继承自哪个父类，并在子类构造函数中必须调用<code>super</code></p>
<p>通过<code>super</code>获取父类的属性.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = age;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">sayHello</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//写的函数会直接放到原型上</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`hello, <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>, i am <span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span> years old`</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Person</span> &#123;</span><br><span class="line">  <span class="comment">//这里的constructor是Student的构造函数,内含三个参数</span></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">name, age, score</span>) &#123;</span><br><span class="line">    <span class="comment">//这里的super是继承自父类的参数</span></span><br><span class="line">    <span class="variable language_">super</span>(name, age);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">score</span> = score;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">sayScore</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">      <span class="string">`hello, <span class="subst">$&#123;<span class="variable language_">this</span>.name&#125;</span>, i am <span class="subst">$&#123;<span class="variable language_">this</span>.age&#125;</span> years old, i get <span class="subst">$&#123;<span class="variable language_">this</span>.score&#125;</span>`</span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="模块化"><a href="#模块化" class="headerlink" title="模块化"></a>模块化</h1><p>为什么使用模块化?</p>
<ol>
<li>解决命名冲突</li>
<li>提供复用性</li>
<li>提高代码可维护性</li>
</ol>
<p>写法 1</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// profile.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> firstName = <span class="string">&quot;Michael&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> lastName = <span class="string">&quot;Jackson&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> year = <span class="number">1958</span>;</span><br><span class="line"><span class="comment">//useage.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; firstName, lastName, year &#125; <span class="keyword">from</span> <span class="string">&quot;./profile&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(firstName);</span><br></pre></td></tr></table></figure>

<p>写法 2</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> firstName = <span class="string">&quot;Michael&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> lastName = <span class="string">&quot;Jackson&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> year = <span class="number">1958</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; firstName, lastName, year &#125;;</span><br><span class="line"><span class="comment">//useage.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; firstName, lastName, year &#125; <span class="keyword">from</span> <span class="string">&quot;./profile&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(firstName);</span><br></pre></td></tr></table></figure>

<p>写法 3</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//helper.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">getYear</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="comment">//main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; getName, getYear &#125; <span class="keyword">from</span> <span class="string">&quot;./helper&quot;</span>;</span><br><span class="line"><span class="title function_">getName</span>();</span><br></pre></td></tr></table></figure>

<p>写法 4</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//helper.js</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getName</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getYear</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; getName, getYear &#125;;</span><br><span class="line"><span class="comment">//main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; getName, getYear &#125; <span class="keyword">from</span> <span class="string">&quot;./helper&quot;</span>;</span><br><span class="line"><span class="title function_">getName</span>();</span><br></pre></td></tr></table></figure>

<p>写法 5</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// export-default.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// import-default.js</span></span><br><span class="line"><span class="keyword">import</span> getName <span class="keyword">from</span> <span class="string">&quot;./export-default&quot;</span>;</span><br><span class="line"><span class="title function_">getName</span>();</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/React%E8%BF%9B%E9%98%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/React%E8%BF%9B%E9%98%B6/" class="post-title-link" itemprop="url">React进阶</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:07:45" itemprop="dateCreated datePublished" datetime="2022-09-26T21:07:45+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:52" itemprop="dateModified" datetime="2022-12-27T11:12:52+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<h2 id="title-React-进阶-date-2020-05-09-11-43-23"><a href="#title-React-进阶-date-2020-05-09-11-43-23" class="headerlink" title="title: React 进阶 date: 2020-05-09 11:43:23"></a>title: React 进阶 date: 2020-05-09 11:43:23</h2><p>tags: React</p>
<h1 id="Context"><a href="#Context" class="headerlink" title="Context"></a>Context</h1><ul>
<li>props 属性是由上到下单向传递的</li>
<li>Context 提供了在组件中共享此类值的方法</li>
</ul>
<h3 id="案例-主题切换"><a href="#案例-主题切换" class="headerlink" title="案例:主题切换"></a>案例:主题切换</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//App.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> themes = &#123;</span><br><span class="line">  <span class="attr">light</span>: &#123;</span><br><span class="line">    <span class="attr">classnames</span>: <span class="string">&quot;btn btn-primary&quot;</span>,</span><br><span class="line">    <span class="attr">bgColor</span>: <span class="string">&quot;#eeeeee&quot;</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&quot;#000&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">dark</span>: &#123;</span><br><span class="line">    <span class="attr">classnames</span>: <span class="string">&quot;btn btn-light&quot;</span>,</span><br><span class="line">    <span class="attr">bgColor</span>: <span class="string">&quot;#222222&quot;</span>,</span><br><span class="line">    <span class="attr">color</span>: <span class="string">&quot;#fff&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">calssName</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">header</span> <span class="attr">className</span>=<span class="string">&quot;App-header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#theme-switcher&quot;</span> <span class="attr">className</span>=<span class="string">&quot;btn btn-light&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            浅色主题</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#theme-switcher&quot;</span> <span class="attr">className</span>=<span class="string">&quot;btn btn-secondary&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            深色色主题</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span>;</span><br></pre></td></tr></table></figure>

<p>新建 Context 文件,Context 是 object,不是 component.在 src 下.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//src/theme-context.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">ThemeContext</span> = <span class="title class_">React</span>.<span class="title function_">creatContext</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ThemeContext</span>;</span><br></pre></td></tr></table></figure>

<p>ThemeContext 返回两个值,一个是 Provider,一个是 Consumer.</p>
<p>ThemeContext.Provider 包裹根组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//App.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ThemeContext</span> <span class="keyword">from</span> <span class="string">&#x27;../theme-context&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> themes = &#123;</span><br><span class="line">    <span class="attr">light</span>: &#123;</span><br><span class="line">        <span class="attr">classnames</span>: <span class="string">&#x27;btn btn-primary&#x27;</span>,</span><br><span class="line">        <span class="attr">bgColor</span>: <span class="string">&#x27;#eeeeee&#x27;</span>,</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;#000&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">dark</span>: &#123;</span><br><span class="line">        <span class="attr">classnames</span>: <span class="string">&#x27;btn btn-light&#x27;</span>,</span><br><span class="line">        <span class="attr">bgColor</span>: <span class="string">&#x27;#222222&#x27;</span>,</span><br><span class="line">        <span class="attr">color</span>: <span class="string">&#x27;#fff&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>)&#123;</span><br><span class="line">        <span class="variable language_">super</span>(props)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">            <span class="attr">theme</span>: <span class="string">&#x27;light&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">changeTheme</span> = <span class="variable language_">this</span>.<span class="property">changeTheme</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">change</span>(<span class="params">theme</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">            theme</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">ThemeContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;themes.light&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">calssName</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">header</span> <span class="attr">className</span>=<span class="string">&quot;App-header&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">a</span>  <span class="attr">href</span>=<span class="string">&quot;#theme-switcher&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">className</span>=<span class="string">&quot;btn btn-light&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;this.changeTheme(&#x27;light&#x27;)&#125;&#125;</span></span><br><span class="line"><span class="language-xml">                        &gt;浅色主题<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">a</span>  <span class="attr">href</span>=<span class="string">&quot;#theme-switcher&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">className</span>=<span class="string">&quot;btn btn-secondary&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123;this.changeTheme(&#x27;dark&#x27;)&#125;</span></span><br><span class="line"><span class="language-xml">                        &gt;深色色主题<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">header</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">ThemeContext.Provider</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br></pre></td></tr></table></figure>

<p>新建组件 themeBar.js 组件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//component/themeBar.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ThemeContext</span> <span class="keyword">from</span> <span class="string">&quot;../theme-context&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">ThemeBar</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">themeContext.Consumer</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;(theme) =&gt; &#123;</span></span><br><span class="line"><span class="language-xml">        return (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">className</span>=<span class="string">&quot;alert mt-5&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">backgroundColor:</span> <span class="attr">theme.bgColor</span>, <span class="attr">color:</span> <span class="attr">theme.color</span> &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          &gt;</span></span></span><br><span class="line"><span class="language-xml">            样式区域</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;theme.classname&#125;</span>&gt;</span>样式按钮<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        );</span></span><br><span class="line"><span class="language-xml">      &#125;&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">themeContext.Consumer</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">ThemeBar</span>;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/React-CommonBox/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/React-CommonBox/" class="post-title-link" itemprop="url">React-CommonBox</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:07:40" itemprop="dateCreated datePublished" datetime="2022-09-26T21:07:40+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:52" itemprop="dateModified" datetime="2022-12-27T11:12:52+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<h2 id="title-React-CommentBoxdate-2020-05-08-11-44-09"><a href="#title-React-CommentBoxdate-2020-05-08-11-44-09" class="headerlink" title="title: React-CommentBoxdate: 2020-05-08 11:44:09"></a>title: React-CommentBoxdate: 2020-05-08 11:44:09</h2><p>tags: React</p>
<h1 id="综合实例-留言本"><a href="#综合实例-留言本" class="headerlink" title="综合实例-留言本"></a>综合实例-留言本</h1><h2 id="状态提升和单向数据流"><a href="#状态提升和单向数据流" class="headerlink" title="状态提升和单向数据流"></a>状态提升和单向数据流</h2><p><a target="_blank" rel="noopener" href="https://imgchr.com/i/YMTKXT"><img src="https://s1.ax1x.com/2020/05/09/YMTKXT.md.jpg#alt=commentBox.jpg"></a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//App.js</span></span><br><span class="line"><span class="comment">//将状态提升至App.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CommentBox</span> <span class="keyword">from</span> <span class="string">&quot;./components/CommentBox&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">CommentList</span> <span class="keyword">from</span> <span class="string">&quot;./components/Commentlist&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_ inherited__">Component</span> &#123;</span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">props</span>) &#123;</span><br><span class="line">    <span class="variable language_">super</span>(props);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">state</span> = &#123;</span><br><span class="line">      <span class="attr">commments</span>: [<span class="string">&quot;this id my first reply&quot;</span>],</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">addComment</span> = <span class="variable language_">this</span>.<span class="property">addComment</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">addComment</span>(<span class="params">comment</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">setState</span>(&#123;</span><br><span class="line">      <span class="attr">comments</span>: [...<span class="variable language_">this</span>.<span class="property">state</span>.<span class="property">comment</span>, comment],</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">render</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; comments &#125; = <span class="variable language_">this</span>.<span class="property">state</span>;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;App&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">CommentList</span> <span class="attr">comments</span>=<span class="string">&#123;comments&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">CommentBox</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">commentsLength</span>=<span class="string">&#123;comments.length&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">onAddComment</span>=<span class="string">&#123;this.addComment&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CommentList.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&quot;react&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">CommentList</span> = (<span class="params">&#123; comments &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;comment-list-component&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>评论列表<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">ul</span> <span class="attr">className</span>=<span class="string">&quot;list-group&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;comments.map((comment, index) =&gt; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">li</span> <span class="attr">key</span>=<span class="string">&#123;index&#125;</span> <span class="attr">className</span>=<span class="string">&quot;list-group-item&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            &#123;comment&#125;</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ))&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">CommentList</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//CommentBox.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">React</span> <span class="keyword">from</span> <span class="string">&#x27;react&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CommentBox</span> <span class="keyword">from</span> <span class="title class_">React</span>.<span class="property">Component</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">props</span>)&#123;</span><br><span class="line">        <span class="variable language_">super</span>(props)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">handleSubmit</span> = <span class="variable language_">this</span>.<span class="property">handleSubmit</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_">handleSubmit</span>(<span class="params">event</span>)&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">textInput</span>.<span class="property">value</span>)</span><br><span class="line">        event.<span class="title function_">preventDefault</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">render</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            <span class="language-xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">onSubmit</span>=<span class="string">&#123;this.handleSumit&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">label</span>&gt;</span>留言内容<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    <span class="tag">&lt;<span class="name">input</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">type</span>=<span class="string">&quot;text&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">className</span>=<span class="string">&quot;form-control&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">placeholder</span>=<span class="string">&quot;请输入评论&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                        <span class="attr">ref</span>=<span class="string">&#123;(textInput)</span> =&gt;</span> &#123;this.textInput = textInput&#125;&#125;</span></span><br><span class="line"><span class="language-xml">                    /&gt;</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                    留言</span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">p</span>&gt;</span>已有&#123;this.props.commentLength = &#123;this&#125;&#125;条评论<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><h2 id="React-开发思想以及和其他思想的异同"><a href="#React-开发思想以及和其他思想的异同" class="headerlink" title="React 开发思想以及和其他思想的异同"></a>React 开发思想以及和其他思想的异同</h2><ul>
<li>状态提升</li>
<li>自上而下的数据流</li>
<li>和双向绑定的区别</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/taichi/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/taichi/" class="post-title-link" itemprop="url">taichi</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:07:36" itemprop="dateCreated datePublished" datetime="2022-09-26T21:07:36+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:52" itemprop="dateModified" datetime="2022-12-27T11:12:52+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<h2 id="title-taichidate-2019-12-20-16-14-28"><a href="#title-taichidate-2019-12-20-16-14-28" class="headerlink" title="title: taichidate: 2019-12-20 16:14:28"></a>title: taichidate: 2019-12-20 16:14:28</h2><p>tags: android</p>
<h1 id="what-is-TaiChi"><a href="#what-is-TaiChi" class="headerlink" title="what is TaiChi?"></a>what is TaiChi?</h1><p>TaiChi is a framework that can use Xposed modules. Modules can change the behavior of systems and applications through it. TaiChi  App can run without needing to root, unlock the bootloader; and it supports Android 5.0 ~ 10.</p>
<p>In simple terms, TaiChi is an Xposed-like framework, which can load Xposed modules, modify the system and APP, intercept methods, and execute hook logic.</p>
<h1 id="Relationship-with-Xposed"><a href="#Relationship-with-Xposed" class="headerlink" title="Relationship with Xposed"></a>Relationship with Xposed</h1><p>TaiChi is an Xposed-like framework, but it has nothing to do with Xposed itself. The only thing that might be related is that TaiChi is compatible with the Xposed modules. Besides, the two are completely different in design thinking, implementation mechanism, and operation logic.</p>
<h1 id="Here-are-some-unique-features-of-TaiChi"><a href="#Here-are-some-unique-features-of-TaiChi" class="headerlink" title="Here are some unique features of TaiChi:"></a>Here are some unique features of TaiChi:</h1><h1 id="How-to-use-TaiChi"><a href="#How-to-use-TaiChi" class="headerlink" title="How to use TaiChi?"></a>How to use TaiChi?</h1><p>TaiChi has two working modes: non-root mode and magisk mode. If you don’t want to unlock the bootloader&#x2F;flash system images, the non-root mode is perfect for you, if you want more control over the system, you can try magisk mode.</p>
<h1 id="What-is-the-difference-between-non-root-mode-and-magisk-mode"><a href="#What-is-the-difference-between-non-root-mode-and-magisk-mode" class="headerlink" title="What is the difference between non-root mode and magisk mode?"></a>What is the difference between non-root mode and magisk mode?</h1><p>The only different support is that the magisk mode can modify the system, so it can support more modules; such as Greenify &#x2F; CorePatch, etc. However, Magisk mode requires unlocking the bootloader and installing Magisk, while non-root mode only requires installing a simple APP (TaiChi).</p>
<h2 id="Non-Root-mode"><a href="#Non-Root-mode" class="headerlink" title="Non-Root mode"></a>Non-Root mode</h2><h2 id="Magisk-mode"><a href="#Magisk-mode" class="headerlink" title="Magisk mode"></a>Magisk mode</h2><p>Although the Non-Root mode of TaiChi does not require unlocking the bootloader and is extremely convenient to use, it has some disadvantages, such as the inability to modify the system and the need to uninstall the original APP. Therefore,Magisk module of TaiChi, which can give TaiChi more powerful functions through Magisk; thus breaking through the limitations of the Non-Root mode.</p>
<p>After you flash in the Magisk Module provided by TaiChi, the TaiChi APP will automatically switch from Non-Root mode to Magisk mode: TaiChi APP + TaiChi Magisk Module &#x3D; TaiChi Magisk. When Magisk Module of TaiChi is disabled or uninstalled, TaiChi will automatically return to Non-Root mode.</p>
<p>If you want to use magisk mode, please download the latest Magisk Module.</p>
<p>page2</p>
<h1 id="TaiChi-module-download"><a href="#TaiChi-module-download" class="headerlink" title="TaiChi module download"></a>TaiChi module download</h1>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/JS%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/JS%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">JS基础</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:07:30" itemprop="dateCreated datePublished" datetime="2022-09-26T21:07:30+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:53" itemprop="dateModified" datetime="2022-12-27T11:12:53+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<p>title: JS基础</p>
<p>date: 2019-08-19 13:39:26</p>
<p>tags: javascript</p>
<p>categories:  # 这里写的分类会自动汇集到 categories 页面上，分类可以多级</p>
<ul>
<li>JS # 一级分类</li>
<li>JS基础 # 二级分类</li>
</ul>
<hr>
<h1 id="JS-对象"><a href="#JS-对象" class="headerlink" title="JS 对象"></a>JS 对象</h1><p>对象，就是一种无序的数据集合，由若干个“键值对”（key-value）构成。</p>
<p><code>&#123;key: value&#125;</code>是 JS 对象字面量写法</p>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p><code>number, boolean, string, undefined, null, object, symbol</code></p>
<p><strong>原始类型</strong>，又叫基本类型,值类型,<code>number, string, boolean,undefined,null</code>。指保存在栈内存里的简单数据段</p>
<p><strong>引用类型</strong>，对象 object。又可分为狭义的对象，数组，函数，正则。指保存在堆内存中的对象</p>
<p>其中 js 的 number 类型是浮点类型,不是整型.并且浮点类型基于 IEEE 754 标准实现，在使用中会遇到某些 Bug。</p>
<p>NaN 属于 number 类型,<code>NaN</code>表示<code>Not a Number</code>,并且 NaN 不等于自身.</p>
<p><code>undefined</code>: 表示未定义或不存在.由于没有定义,所以目前没有值</p>
<p><code>null</code>: 表示无值.即此处的值就是”无”的状态.</p>
<h2 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h2><p>typeof 对于基本类型，除了 <code>null</code> 都可以显示正确的类型</p>
<p><code>typeof undefined</code> 输出 <code>undefined</code></p>
<p><code>typeof []</code>&#x2F;&#x2F; ‘object’</p>
<p><code>typeof &#123;&#125;</code> &#x2F;&#x2F; ‘object’</p>
<p><code>typeof function()&#123;&#125;</code> &#x2F;&#x2F;‘function’(这是具体的判断)</p>
<p><code>typeof null</code> 输出 object</p>
<p>PS：为什么会出现这种情况呢？因为在 JS 的最初版本中，使用的是 32 位系统，为了性能考虑使用低位存储了变量的类型信息，000 开头代表是对象，然而 null 表示为全零，所以将它错误的判断为 object 。</p>
<h3 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h3><ol>
<li><code>&amp;&amp; (And)</code></li>
<li><code>|| (or)</code></li>
<li><code>! (not)</code></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span> &amp;&amp; <span class="number">3</span>; <span class="comment">//3</span></span><br><span class="line">a = <span class="number">1</span> || <span class="number">3</span>; <span class="comment">//1</span></span><br><span class="line">!<span class="number">2</span> * <span class="number">0</span>; <span class="comment">//0</span></span><br></pre></td></tr></table></figure>

<p><code>instanceof</code>运算符,判断是否为某一种的实例.</p>
<p><code>==</code> 和 <code>===</code>，前者先转化类型，后进行判断，后者比较类型和值</p>
<h3 id="三目运算符"><a href="#三目运算符" class="headerlink" title="三目运算符"></a>三目运算符</h3><p><code>condition ? true case : false case</code></p>
<h3 id="四则运算符"><a href="#四则运算符" class="headerlink" title="四则运算符"></a>四则运算符</h3><p>只有当加法运算时，其中一方是字符串类型，就会把另一个也转为字符串类型。其他运算只要其中一方是数字，那么另一方就转为数字。并且加法运算会触发三种类型转换：将值转换为原始值，转换为数字，转换为字符串。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">加法拼接两个字符串</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;2&quot;</span>+<span class="string">&quot;4&quot;</span>) <span class="comment">//&quot;24&quot;</span></span><br><span class="line">加法将其中不是字符串的一方转化为字符串进行拼接</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>+<span class="string">&quot;4&quot;</span>) <span class="comment">//&quot;24&quot;</span></span><br><span class="line">只有一个字符串参数时将其转化成数字</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(+<span class="string">&quot;4&quot;</span>) <span class="comment">//4</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(+<span class="keyword">new</span> <span class="title class_">Date</span>()) <span class="comment">//1573972012164</span></span><br><span class="line">字符串加对象会把对象变成[object <span class="title class_">Object</span>]</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;aa:&#x27;</span>+&#123;<span class="attr">a</span>:<span class="number">1</span>&#125;) <span class="comment">//aa:[object Object]</span></span><br><span class="line"></span><br><span class="line">在参数有对象的情况下调用其valueof或toString,其中valueof优先级更高</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">2</span>+<span class="keyword">new</span> <span class="title class_">Date</span>()) <span class="comment">//&quot;2Sun Nov 17 2019 14:21:50 GMT+0800 (香港标准时间)&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>valueof()</code>返回适合该对象类型的原始值。</p>
<p><code>toString()</code>将该对象的原始值以字符串形式返回。</p>
<p>这两个方法一般是交由 js 去隐式调用。</p>
<p>在数值运算中，优先调用 valueof().</p>
<p>在字符串运算中，优先调用 toString().</p>
<p>自增运算符: a 或 a</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(a = <span class="number">1</span>), (b = a++); <span class="comment">//a=2,b=1</span></span><br><span class="line">(a = <span class="number">1</span>), (b = ++a); <span class="comment">//a=2,b=2</span></span><br></pre></td></tr></table></figure>

<p>无论是先加，还是后加，a 的值计算后一定会加 1；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(a = <span class="number">3</span>), (b = <span class="number">4</span>);</span><br><span class="line">a++ + b; <span class="comment">//相当于(a++)+b =&gt; 3 + 4 = 7</span></span><br></pre></td></tr></table></figure>

<p>逗号运算符</p>
<p>取后一个表达式的值.也就是说,前一个会被覆盖.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> d = ((a = <span class="number">1</span>), (b = <span class="number">2</span>)); <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>

<h3 id="boolean-值"><a href="#boolean-值" class="headerlink" title="boolean 值"></a>boolean 值</h3><p><code>false: undefined null 0 NaN 空字符串</code></p>
<p>除此之外,其他所有值都转化为 true,包括所有对象.</p>
<h4 id="比较相等性"><a href="#比较相等性" class="headerlink" title="==比较相等性"></a><code>==</code>比较相等性</h4><p>相等操作符会先转换操作数（通常称为强制转型），然后比较它们的相等性。</p>
<p>在转换不同的数据类型时，相等操作符遵循下列基本规则：</p>
<ol>
<li>如果有一个操作数是布尔值，则在比较相等性之前，将其转换为数值；</li>
<li>如果一个操作数是字符串，另一个操作数是数值，在比较之前先将字符串转换为数值；</li>
<li>如果一个操作数是对象，另一个操作数不是，则调用对象的 valueOf() 方法，用得到的基本类型值按照前面的规则进行比较；</li>
<li>如果有一个操作数是 NaN，无论另一个操作数是什么，相等操作符都返回 false；</li>
<li>如果两个操作数都是对象，则比较它们是不是同一个对象。如果指向同一个对象，则相等操作符返回 true；</li>
<li>在比较相等性之前，不能将 null 和 undefined 转成其他值。</li>
<li>null 和 undefined 是相等的。</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[] == [] <span class="comment">//false</span></span><br><span class="line">&#123;&#125; == &#123;&#125; <span class="comment">//false</span></span><br><span class="line">声明引用类型的时候，变量名保存在 js 的栈内存里面，而对应的值保存在堆内存里面</span><br><span class="line">而这个变量在栈内存中实际保存的是：这个值在堆内存中的地址，也就是指针.</span><br><span class="line">如果</span><br><span class="line">a = &#123;&#125;</span><br><span class="line">b = &#123;&#125;</span><br><span class="line">虽然 a 和 b 都保存了一个 <span class="title class_">Object</span>，但这是两个独立的 <span class="title class_">Object</span>，它们的地址是不同的.</span><br><span class="line">再结合前面的第<span class="number">5</span>条规则：如果两个对象指向同一个对象，相等操作符返回 <span class="literal">true</span></span><br><span class="line">所以 &#123;&#125; == &#123;&#125; 的结果是 <span class="literal">false</span>，同样的， [] == [] 的结果也是 <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">[] == ![] <span class="comment">//true</span></span><br><span class="line">按优先级,先判断![],是<span class="literal">false</span>. =&gt;[] == <span class="literal">false</span>.[]是对象,调用[].<span class="property">toString</span>返回<span class="string">&quot;&quot;</span>,<span class="literal">false</span>转化成<span class="number">0.</span> =&gt;<span class="string">&quot;&quot;</span> == <span class="number">0.</span><span class="title class_">Number</span>(<span class="string">&quot;&quot;</span>)是<span class="number">0</span>,那么结果就是<span class="literal">true</span>.</span><br><span class="line">&#123;&#125; == !&#123;&#125; <span class="comment">//false</span></span><br><span class="line">与上面类似,不过<span class="title class_">Number</span>(&#123;&#125;)返回 <span class="title class_">NaN</span></span><br><span class="line"><span class="string">&quot;hello&quot;</span> == <span class="literal">true</span> <span class="comment">//先转化,后比较.true转化成数字是1,&quot;hello&quot;转化成数字是NaN,二者不相等.</span></span><br><span class="line"><span class="string">&quot;hello&quot;</span> == <span class="literal">false</span> <span class="comment">//false转化为数字是0,NaN不等于0.二者也不相等.</span></span><br></pre></td></tr></table></figure>

<h2 id="JSON-格式-javascript-object-notation"><a href="#JSON-格式-javascript-object-notation" class="headerlink" title="JSON 格式(javascript object notation)"></a>JSON 格式(javascript object notation)</h2><ol>
<li>复合类型的值只能是数组或对象，不能是函数、正则表达式对象、日期对象。</li>
<li>简单类型的值只有四种：字符串、数值（必须以十进制表示）、布尔值和 null（不能使用 NaN, Infinity, -Infinity 和 undefined）。</li>
<li>字符串必须使用双引号表示，不能使用单引号。</li>
<li>对象的键名必须放在双引号里面。</li>
<li>数组或对象最后一个成员的后面，不能加逗号。</li>
</ol>
<h3 id="JSON-stringify"><a href="#JSON-stringify" class="headerlink" title="JSON.stringify"></a>JSON.stringify</h3><p>用于将一个值转为字符串。该字符串符合 JSON 格式，并且可以被 JSON.parse 方法还原。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="string">&quot;abc&quot;</span>); <span class="comment">// &quot;&quot;abc&quot;&quot;</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="number">1</span>); <span class="comment">// &quot;1&quot;</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="literal">false</span>); <span class="comment">// &quot;false&quot;</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>([]); <span class="comment">// &quot;[]&quot;</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123;&#125;); <span class="comment">// &quot;&#123;&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>([<span class="number">1</span>, <span class="string">&quot;false&quot;</span>, <span class="literal">false</span>]);</span><br><span class="line"><span class="comment">// &#x27;[1,&quot;false&quot;,false]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span> &#125;);</span><br><span class="line"><span class="comment">// &#x27;&#123;&quot;name&quot;:&quot;张三&quot;&#125;&#x27;</span></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="literal">undefined</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;];</span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(arr); <span class="comment">// &quot;[null,null]&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">stringify</span>(<span class="regexp">/foo/</span>); <span class="comment">// &quot;&#123;&#125;&quot;</span></span><br><span class="line"><span class="comment">//正则对象会被转成空对象。</span></span><br></pre></td></tr></table></figure>

<p>上面代码将各种类型的值，转成 JSON 字符串。</p>
<blockquote>
<p>需要注意的是，对于原始类型的字符串，转换结果会带双引号。</p>
</blockquote>
<p>如果原始对象中，有一个成员的值是<code>undefined</code>、函数或 XML 对象，这个成员会被过滤。</p>
<p>如果数组的成员是<code>undefined</code>、函数或 XML 对象，则这些值被转成<code>null</code>。</p>
<p>正则对象会被转成空对象。</p>
<h3 id="JSON-parse"><a href="#JSON-parse" class="headerlink" title="JSON.parse()"></a>JSON.parse()</h3><p>用于将 JSON 字符串转化成对象。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&quot;&#123;&#125;&quot;</span>); <span class="comment">// &#123;&#125;</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&quot;true&quot;</span>); <span class="comment">// true</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&quot;foo&quot;&#x27;</span>); <span class="comment">// &quot;foo&quot;</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;[1, 5, &quot;false&quot;]&#x27;</span>); <span class="comment">// [1, 5, &quot;false&quot;]</span></span><br><span class="line"><span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&quot;null&quot;</span>); <span class="comment">// null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;name&quot;: &quot;张三&quot;&#125;&#x27;</span>);</span><br><span class="line">o.<span class="property">name</span>; <span class="comment">// 张三</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>JSON.parse 只能解析<strong>字符串</strong>,下面这种情况会报错.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = &#123; <span class="attr">name</span>: <span class="string">&quot;张三&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> o = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(str);</span><br><span class="line">o.<span class="property">name</span>; <span class="comment">// 报错</span></span><br><span class="line">解决方法: <span class="keyword">var</span> str = <span class="string">&#x27;&#123;&quot;name&quot;: &quot;张三&quot;&#125;&#x27;</span>;</span><br><span class="line">或者;</span><br><span class="line"><span class="keyword">var</span> o = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&quot;str&quot;</span>);</span><br></pre></td></tr></table></figure>

<p>JavaScript 对象的字面量写法只是长的像 JSON 格式数据，二者属于不同的范畴，JavaScript 对象中很多类型(函数、正则、Date) JSON 格式的规范并不支持，JavaScript 对象的字面量写法更宽松。</p>
<h1 id="写-JavaScript-的基本规范"><a href="#写-JavaScript-的基本规范" class="headerlink" title="写 JavaScript 的基本规范"></a>写 JavaScript 的基本规范</h1><p>1.不要在同一行声明多个变量。</p>
<p>2.请使用 &#x3D;&#x3D;&#x3D;&#x2F;!&#x3D;&#x3D;来比较 true&#x2F;false 或者数值</p>
<p>3.使用对象字面量替代 new Array 这种形式</p>
<p>4.不要使用全局函数。</p>
<p>5.Switch 语句必须带有 default 分支</p>
<p>6.函数不应该有时候有返回值，有时候没有返回值。</p>
<p>7.For 循环必须使用大括号</p>
<p>8.If 语句必须使用大括号</p>
<p>9.for-in 循环中的变量 应该使用 var 关键字明确限定作用域，从而避免作用域污染。</p>
<h1 id="JS-函数"><a href="#JS-函数" class="headerlink" title="JS 函数"></a>JS 函数</h1><p>函数会声明前置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">foo</span>(); <span class="comment">//hello</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>函数表达式不会</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fn</span>()<span class="comment">//报错</span></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">fn</span>() = <span class="title function_">fnction</span>(<span class="params"></span>)&#123;</span><br><span class="line">   <span class="keyword">return</span> <span class="string">&quot;hello&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;一号&quot;</span>;</span><br><span class="line"><span class="title function_">test</span>();</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">test</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br><span class="line">  <span class="keyword">var</span> str = <span class="string">&quot;二号&quot;</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(str);</span><br></pre></td></tr></table></figure>

<p>输出</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//考察变量声明和作用域</span></span><br><span class="line"><span class="literal">undefined</span>; <span class="comment">//因为打印str时,首先从str所在的作用域找变量str,</span></span><br><span class="line"><span class="comment">//因为有声明前置,var str,但是未赋值,是undefined.所以不再从外部找str</span></span><br><span class="line">二号;</span><br><span class="line">一号; <span class="comment">//函数test内部的str=二号只在函数内部,最后一个str的值是全局下的即&quot;一号&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="js-对象查看所有属性"><a href="#js-对象查看所有属性" class="headerlink" title="js 对象查看所有属性"></a>js 对象查看所有属性</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123; <span class="attr">p</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">keys</span>(obj);</span><br></pre></td></tr></table></figure>

<p><em>删除命令</em></p>
<p><code>delete object.p</code></p>
<p><em>循环判断</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">switch</span>(判断语句）&#123;</span><br><span class="line">     <span class="keyword">case</span> 条件：</span><br><span class="line">       输出;</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">     <span class="keyword">case</span> 条件:</span><br><span class="line">       输出;</span><br><span class="line">       <span class="keyword">break</span>;</span><br><span class="line">  <span class="attr">default</span>:</span><br><span class="line">      输出</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>while 循环</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> (expression) &#123;</span><br><span class="line">  statement;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//如果expression为true，执行，</span></span><br><span class="line"><span class="comment">//循环继续执行直到判断不成立。</span></span><br></pre></td></tr></table></figure>

<p><em>do-while 循环</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">  statement;</span><br><span class="line">&#125; <span class="keyword">while</span> (expression);</span><br><span class="line"><span class="comment">//先执行，后判断</span></span><br></pre></td></tr></table></figure>

<p><em>for 循环</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行步骤如下:</p>
<p>初始化语句: <code>var i=0</code>,只执行第一次</p>
<p>判断语句: <code>i&lt;5</code></p>
<p>条件改变语句: <code>i++</code></p>
<p>内部执行: <code>console.log(i)</code></p>
<p>先执行初始化语句,然后判断条件是否成立,成立就执行内部语句,最后改变条件.重复进行判断.</p>
<h3 id="for-in-循环"><a href="#for-in-循环" class="headerlink" title="for-in 循环"></a>for-in 循环</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> arr) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(arr[key]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>break</code>退出本次循环</p>
<p><code>continue</code>跳过本次循环执行下次循环</p>
<h2 id="引用类型"><a href="#引用类型" class="headerlink" title="引用类型"></a>引用类型</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//a,b存放在栈内存中</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="comment">//obj是对象,存放在堆内存中,obj只是一个指针,一个地址</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;Tom&quot;</span>,</span><br><span class="line">  <span class="attr">sex</span>: <span class="string">&quot;male&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">15</span>,</span><br><span class="line">  <span class="attr">friend</span>: &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;Jerry&quot;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">10</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> newobj = &#123;&#125;; <span class="comment">//空对象也是引用类型,只不过暂时还没有东西</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//基本类型</span></span><br><span class="line">b = a;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b); <span class="comment">//1,把a赋值给b,b在栈内存中也被改变为1</span></span><br><span class="line"><span class="comment">//引用类型</span></span><br><span class="line"><span class="keyword">var</span> obj2 = obj;</span><br><span class="line"><span class="comment">//二者都是引用类型,都是把地址指向同一个地方,改变内存中的值,另一个也会改变</span></span><br><span class="line">obj2.<span class="property">name</span> = <span class="string">&quot;Ann&quot;</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="property">name</span>); <span class="comment">//&#x27;Ann&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj3 = &#123; <span class="attr">name</span>: <span class="string">&quot;hello&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> obj4 = &#123; <span class="attr">name</span>: <span class="string">&quot;hello&quot;</span> &#125;;</span><br><span class="line">obj3 === obj4; <span class="comment">//false,</span></span><br><span class="line"><span class="comment">//虽然二者内容看似相同,但是确是不同的内存中,两个地址</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sum..&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> sum2 = sum;</span><br><span class="line"><span class="title function_">sum2</span>(); <span class="comment">//&#x27;sum..&#x27;,</span></span><br><span class="line"><span class="comment">//函数同样是引用类型,当赋值给另一个函数时,二者也就指向同一地址</span></span><br></pre></td></tr></table></figure>

<h3 id="函数的参数传递"><a href="#函数的参数传递" class="headerlink" title="函数的参数传递"></a>函数的参数传递</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">inc</span>(<span class="params">n</span>) &#123;</span><br><span class="line">  n++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line"><span class="title function_">inc</span>(a);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(a); <span class="comment">//10</span></span><br><span class="line"><span class="comment">//inc(a)把a传递进去,先赋值后相加,a=10,inc(a) = 11,a并没有变化还是10</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">incObj</span>(<span class="params">obj</span>) &#123;</span><br><span class="line">  obj.<span class="property">n</span>++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> o = &#123; <span class="attr">n</span>: <span class="number">10</span> &#125;;</span><br><span class="line"><span class="title function_">incObj</span>(o);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(o); <span class="comment">//&#123;n:11&#125;</span></span><br><span class="line"><span class="comment">//incObj(o),o.n++,那么&#123;n:11&#125;,堆内存中的数值已经改变,输出o时,o也就变成了&#123;n:11&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="深拷贝"><a href="#深拷贝" class="headerlink" title="深拷贝"></a>深拷贝</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&quot;hunger&quot;</span>,</span><br><span class="line">  <span class="attr">age</span>: <span class="number">3</span>,</span><br><span class="line">  <span class="attr">friends</span>: [<span class="string">&quot;aa&quot;</span>, <span class="string">&quot;bb&quot;</span>, <span class="string">&quot;cc&quot;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> obj2 = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(obj));</span><br><span class="line">obj.<span class="property">age</span> = <span class="number">4</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj2.<span class="property">age</span>);</span><br></pre></td></tr></table></figure>

<p>缺点: JSON 不支持函数、引用、undefined、RegExp、Date……</p>
<h3 id="jQuery-extend"><a href="#jQuery-extend" class="headerlink" title="jQuery.extend()"></a>jQuery.extend()</h3><p><code>jQuery.extend( [deep], target, object1 [, objectN ] )</code></p>
<p>其中 deep 为 Boolean 类型，如果是<code>true</code>，则进行深拷贝。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> copy1 = &#123; <span class="attr">a</span>: <span class="number">2</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: &#123; <span class="attr">ca</span>: <span class="number">21</span>, <span class="attr">cb</span>: <span class="number">22</span>, <span class="attr">cc</span>: <span class="number">23</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">var</span> copy2 = &#123; <span class="attr">c</span>: &#123; <span class="attr">ca</span>: <span class="number">31</span>, <span class="attr">cb</span>: <span class="number">32</span>, <span class="attr">cd</span>: <span class="number">34</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">var</span> result = $.<span class="title function_">extend</span>(<span class="literal">true</span>, target, copy1, copy2); <span class="comment">// 进行深拷贝</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(target); <span class="comment">// &#123;a: 2, b: 2, c: &#123;ca: 31, cb: 32, cc: 23, cd: 34&#125;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> target = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">1</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> copy1 = &#123; <span class="attr">a</span>: <span class="number">2</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: &#123; <span class="attr">ca</span>: <span class="number">21</span>, <span class="attr">cb</span>: <span class="number">22</span>, <span class="attr">cc</span>: <span class="number">23</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">var</span> copy2 = &#123; <span class="attr">c</span>: &#123; <span class="attr">ca</span>: <span class="number">31</span>, <span class="attr">cb</span>: <span class="number">32</span>, <span class="attr">cd</span>: <span class="number">34</span> &#125; &#125;;</span><br><span class="line"><span class="keyword">var</span> result = $.<span class="title function_">extend</span>(target, copy1, copy2); <span class="comment">// 不进行深拷贝</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(target); <span class="comment">// &#123;a: 1, b: 1, c: &#123;ca: 31, cb: 32, cd:34&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="递归深拷贝"><a href="#递归深拷贝" class="headerlink" title="递归深拷贝"></a>递归深拷贝</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">clone</span>(<span class="params">object</span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> object2;</span><br><span class="line">  <span class="keyword">if</span> (!(object <span class="keyword">instanceof</span> <span class="title class_">Object</span>)) &#123;</span><br><span class="line">    <span class="keyword">return</span> object;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (object <span class="keyword">instanceof</span> <span class="title class_">Array</span>) &#123;</span><br><span class="line">    object2 = [];</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (object <span class="keyword">instanceof</span> <span class="title class_">Object</span>) &#123;</span><br><span class="line">    object2 = &#123;&#125;;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//你也可以把 Array Function Object 都当做 Object 来看待</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> object) &#123;</span><br><span class="line">    object2[key] = <span class="title function_">clone</span>(object[key]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> object2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><h2 id="函数返回值-return"><a href="#函数返回值-return" class="headerlink" title="函数返回值 return"></a>函数返回值 return</h2><p>通过 return 返回结果,调用 return 后,函数立即中断并返回结果,即使后面还有语句也不再执行.</p>
<h2 id="立即执行函数"><a href="#立即执行函数" class="headerlink" title="立即执行函数"></a>立即执行函数</h2><p>将整个函数表达式包含在括号内,最后添加一个括号表示执行.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

<h2 id="命名冲突"><a href="#命名冲突" class="headerlink" title="命名冲突"></a>命名冲突</h2><p>当在同一个作用域内定义了名字相同的变量和方法的话,无论其顺序如何,变量的赋值会覆盖方法的赋值.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fn = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fn); <span class="comment">//3</span></span><br></pre></td></tr></table></figure>

<p>当函数执行有命名冲突时,函数执行时载入顺序是变量,函数,参数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(fn);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> fn = <span class="number">3</span>;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(fn);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">fn</span>(<span class="number">10</span>); <span class="comment">//10 3</span></span><br></pre></td></tr></table></figure>

<h2 id="函数作用域（scope）"><a href="#函数作用域（scope）" class="headerlink" title="函数作用域（scope）"></a>函数作用域（scope）</h2><p>作用域（scope）指的是变量存在的范围。</p>
<p>在函数内定义的变量不能在函数之外的任何地方访问，因为变量仅仅在该函数的域的内部有定义。相对应的，一个函数可以访问定义在其范围内的任何变量和函数。</p>
<h2 id="词法作用域"><a href="#词法作用域" class="headerlink" title="词法作用域"></a>词法作用域</h2><p>创建当前函数所在的作用域.</p>
<h3 id="递归"><a href="#递归" class="headerlink" title="递归"></a>递归</h3><p>一个函数可以指向并调用自身。调用自身的函数我们称之为递归函数。在某种意义上说，递归近似于循环。两者都重复执行相同的代码，并且两者都需要一个终止条件（避免无限循环或者无限递归）。</p>
<h3 id="作用域链"><a href="#作用域链" class="headerlink" title="作用域链"></a>作用域链</h3><ol>
<li>函数在执行的过程中，先从自己内部找变量</li>
<li>如果找不到，再从创建当前函数所在的作用域去找, 以此往上</li>
<li>注意找的是变量的当前的状态</li>
</ol>
<h2 id="闭包-closure"><a href="#闭包-closure" class="headerlink" title="闭包(closure)"></a>闭包(closure)</h2><p>它可以访问外部函数的参数和变量，但是外部函数却不能使用它的参数和变量。</p>
<p>一般情况下使用闭包主要是为了</p>
<ol>
<li>封装数据</li>
<li>暂存数据</li>
</ol>
<p>面试官想听的版本:</p>
<p><strong>什么是闭包?</strong></p>
<p>由于在 JS 中，变量的作用域属于函数作用域，在函数执行后作用域就会被清理、内存也随之回收，但是由于闭包是建立在一个函数内部的子函数，由于其可访问上级作用域的原因，即使上级函数执行完，作用域也不会随之销毁，这时的子函数——也就是闭包，便拥有了访问上级作用域中的变量的权限，即使上级函数执行完后作用域内的值也不会被销毁。</p>
<p><strong>闭包解决了什么问题?</strong></p>
<p>由于闭包可以缓存上级作用域，那么就使得函数外部打破了“函数作用域”的束缚，可以访问函数内部的变量。以平时使用的 Ajax 成功回调为例，这里其实就是个闭包，由于上述的特性，回调就拥有了整个上级作用域的访问和操作能力，提高了极大的便利。开发者不用去写钩子函数来操作上级函数作用域内部的变量了。</p>
<p><strong>闭包的应用?</strong></p>
<p>闭包随处可见，一个 Ajax 请求的成功回调，一个事件绑定的回调方法，一个 setTimeout 的延时回调，或者一个函数内部返回另一个匿名函数，这些都是闭包。简而言之，无论使用何种方式对函数类型的值进行传递，当函数在别处被调用时都有闭包的身影。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">car</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> speed = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">    speed++;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(speed);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> speedUp = <span class="title function_">car</span>();</span><br><span class="line"><span class="title function_">speedUp</span>(); <span class="comment">//1</span></span><br><span class="line"><span class="title function_">speedUp</span>(); <span class="comment">//2</span></span><br><span class="line"><span class="comment">//第二次执行speedup时,在fn内部,speed此时因为没有释放,还是上次的值1,也就相当于var speed = 1;不用再去上一级作用域找speed的值,可以直接相加输出</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>如果没有这个闭包，函数执行后，里面 speed 变量就会被清理掉。但我们声明了 fn 这个函数，<strong>并把它返回出来赋值给新的变量 speedup。因为 speedup 是全局变量，是一直存在的</strong>，故这个 fn 函数就一直存在，speed 变量也不会被清理</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//演化版</span></span><br><span class="line"><span class="keyword">var</span> speedup = (<span class="keyword">function</span> (<span class="params">speed</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    speed++;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(speed);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;)(<span class="number">3</span>);</span><br><span class="line"><span class="title function_">speedup</span>(); <span class="comment">//4</span></span><br><span class="line"><span class="title function_">speedup</span>(); <span class="comment">//5</span></span><br><span class="line"><span class="title function_">speedup</span>(); <span class="comment">//6</span></span><br></pre></td></tr></table></figure>

<p><strong>经典范例</strong></p>
<p>如下代码输出多少？如果想输出 3，那如何改造代码？</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fnArr = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  fnArr[i] = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> i;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fnArr[<span class="number">3</span>]()); <span class="comment">// 10</span></span><br></pre></td></tr></table></figure>

<p>我的理解: <code>fnArr[i]</code>声明的匿名函数的作用域是全局作用域,先遍历,并未执行,生成闭包(只是 for 循环,并没有执行函数,后面没有小括号),遍历结束开始执行,fnArr 结果是 10 个匿名函数<code>f()</code>,全局作用域下 0-9 的<code>fnArr[i]</code>已经变成 10 了</p>
<blockquote>
<p>原理解析：for 循环每次执行，都把 function(){ return i} 这个函数赋值给 fnArr[i]，但这个函数不执行。</p>
</blockquote>
<p>因为 fnArr[3] &#x3D;function(){ return i};故当我们调用 fnArr<a href="">3</a> 时，相当于 function(){ return i};这个函数立刻执行，这时 for 循环已经完成，i 已经变成了 10。故输出 10</p>
<p>如果要输出 3，需要如下改造</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fnArr = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  (<span class="keyword">function</span> (<span class="params">i</span>) &#123;</span><br><span class="line">    fnArr[i] = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> i;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;)(i); <span class="comment">//这样保证遍历i时,函数会立即执行(生成10个闭包,暂存数据)</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fnArr[<span class="number">3</span>]()); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>我的理解: 从 0 开始遍历,<code>(function(0)&#123; fnArr[0] = function()&#123;return i&#125;&#125;)(0)</code>,</p>
<p><code>(function(1)&#123; fnArr[1] = function()&#123;return i&#125;&#125;)(1)</code></p>
<p><code>(function(2)&#123; fnArr[2] = function()&#123;return i&#125;&#125;)(2)</code>,</p>
<p><code>(function(3)&#123; fnArr[3] = function()&#123;return i&#125;&#125;)(3)</code>,</p>
<p>传入 3,最内部的 function 找 i 的变量,一直找到上一层,返回 3.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> fnArr = [];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">  fnArr[i] = (<span class="keyword">function</span> (<span class="params">j</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> j;</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;)(i); <span class="comment">//生成10个闭包,暂存数据,j换成i也是一样</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(fnArr[<span class="number">3</span>]()); <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>如下代码输出什么?</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出5个5</span></span><br></pre></td></tr></table></figure>

<p>如何连续输出 0,1,2,3,4</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">  (<span class="keyword">function</span> (<span class="params">j</span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(j);</span><br><span class="line">    &#125;, <span class="number">0</span>);</span><br><span class="line">  &#125;)(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0,1,2,3,4</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第二种方法</span></span><br><span class="line"><span class="comment">//把var换成let</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">  &#125;, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//0,1,2,3,4</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> an = <span class="keyword">function</span> (<span class="params">n</span>) &#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">2</span>; i++) &#123;</span><br><span class="line">    n++;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(n); <span class="comment">//2,3. 遍历两次,内部就打印两次</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">//0,1. 遍历两次,内部就打印两次</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(n); <span class="comment">//3. 打印最终结果</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(i); <span class="comment">//2. 打印最终结果.</span></span><br><span class="line">  <span class="comment">//如果换成let,只有这里报错,因为i只在for循环体内被定义</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> g = <span class="title function_">an</span>(<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<h2 id="函数柯里化"><a href="#函数柯里化" class="headerlink" title="函数柯里化"></a>函数柯里化</h2><blockquote>
<p>只传递给函数一部分参数来调用它,让它返回一个函数去处理剩下的参数.</p>
</blockquote>
<p>写一个函数 sum,实现如下调用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sum</span>(<span class="number">1</span>)(<span class="number">2</span>)); <span class="comment">//3</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">sum</span>(<span class="number">5</span>)(-<span class="number">1</span>)); <span class="comment">//4</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//解答</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">sum</span>(<span class="params">a</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">b</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str.<span class="title function_">charAt</span>(<span class="number">0</span>); <span class="comment">//获取第一个字符</span></span><br><span class="line">str.<span class="title function_">charCodeAt</span>(<span class="number">0</span>); <span class="comment">//获取字符对应的ASC码</span></span><br></pre></td></tr></table></figure>

<p><em>字符串截取</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line">str.<span class="title function_">substr</span>(<span class="number">1</span>, <span class="number">3</span>); <span class="comment">//第一个开始，第二个长度</span></span><br><span class="line">str.<span class="title function_">substring</span>(<span class="number">1</span>, <span class="number">3</span>); <span class="comment">//第一个开始，第二个结束</span></span><br><span class="line">str.<span class="title function_">slice</span>(<span class="number">1</span>, <span class="number">3</span>); <span class="comment">//同上，允许负参</span></span><br></pre></td></tr></table></figure>

<p><em>查找</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str.<span class="title function_">search</span>(<span class="string">&quot;he&quot;</span>); <span class="comment">//返回下标</span></span><br><span class="line">str.<span class="title function_">indexOf</span>(<span class="string">&quot;he&quot;</span>); <span class="comment">//同上</span></span><br><span class="line">str.<span class="title function_">replace</span>(<span class="string">&quot;he&quot;</span>, <span class="string">&quot;you&quot;</span>); <span class="comment">//替换</span></span><br><span class="line">str.<span class="title function_">match</span>(<span class="string">&quot;he&quot;</span>); <span class="comment">//匹配</span></span><br></pre></td></tr></table></figure>

<p><em>大小写</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">str.<span class="title function_">toUpperCase</span>();</span><br><span class="line">str.<span class="title function_">toLowerCase</span>(); <span class="comment">//本身不变化</span></span><br></pre></td></tr></table></figure>

<p>去除首尾空格</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">str.<span class="title function_">trim</span>(); <span class="comment">//返回新数组,不影响原数组</span></span><br></pre></td></tr></table></figure>

<p><strong>split()方法</strong>使用指定的分隔符字符串将一个 String 对象分割成字符串数组，以将字符串分隔为子字符串，以确定每个拆分的位置。</p>
<p>找到分隔符后，将其从字符串中删除，并将子字符串的数组返回。如果没有找到或者省略了分隔符，则该数组包含一个由整个字符串组成的元素。如果分隔符为空字符串，则将 str 转换为字符数组。如果分隔符出现在字符串的开始或结尾，或两者都分开，分别以空字符串开头，结尾或两者开始和结束。因此，如果字符串仅由一个分隔符实例组成，则该数组由两个空字符串组成。</p>
<p>示例:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;The quick brown fox jumps over the lazy dog.&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> words = str.<span class="title function_">split</span>(<span class="string">&quot; &quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(words[<span class="number">3</span>]);</span><br><span class="line"><span class="comment">// expected output: &quot;fox&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> chars = str.<span class="title function_">split</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(chars[<span class="number">8</span>]);</span><br><span class="line"><span class="comment">// expected output: &quot;k&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> strCopy = str.<span class="title function_">split</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(strCopy);</span><br><span class="line"><span class="comment">// expected output: Array [&quot;The quick brown fox jumps over the lazy dog.&quot;]</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>当字符串为空时，split（）返回一个包含一个空字符串的数组，而不是一个空数组，如果字符串和分隔符都是空字符串，则返回一个空数组。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> strEm = str.<span class="title function_">split</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(strEm); <span class="comment">//返回[&quot;&quot;]</span></span><br></pre></td></tr></table></figure>

<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">arr.<span class="title function_">push</span>(newelement) <span class="comment">//末尾新增一个</span></span><br><span class="line">arr.<span class="title function_">pop</span>() <span class="comment">//末尾踢出一个字</span></span><br><span class="line">arr.<span class="title function_">shift</span>() <span class="comment">//开头拿出一个</span></span><br><span class="line">arr.<span class="title function_">unshift</span>() <span class="comment">//开头新增一个</span></span><br><span class="line">arr.<span class="title function_">splice</span>(index,替换几个，替换内容) <span class="comment">//原数组变</span></span><br><span class="line"><span class="comment">//返回由删除元素组成的新数组</span></span><br><span class="line">arr.<span class="title function_">slice</span>(start，end) <span class="comment">//原数组不变</span></span><br><span class="line">arr.<span class="title function_">join</span>(<span class="string">&quot;-&quot;</span>) <span class="comment">//将数组变成字符串并用-连接</span></span><br><span class="line">arr.<span class="title function_">reverse</span>() <span class="comment">//数组反转</span></span><br><span class="line">arr.<span class="title function_">sort</span>(v1-v2) <span class="comment">//没有参数按顺序排列，但是会出现10,11,7,8,9排列，</span></span><br><span class="line"><span class="comment">//有参数设置比较函数，函数结果v1-v2如果大于0，两两替换位置。否则，不变</span></span><br><span class="line">a.<span class="title function_">concat</span>(array) <span class="comment">//拼接，返回数组a和array的集合。原数组不变</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">isArray</span>(obj) <span class="comment">//判断传入的obj是不是数组</span></span><br><span class="line">a.<span class="title function_">indexof</span>(<span class="number">2</span>) <span class="comment">//判断数组a中是否含有2,返回其索引</span></span><br><span class="line"></span><br><span class="line">a.<span class="title function_">forEach</span>(<span class="title function_">fn</span>(<span class="params">element,index,arr</span>)&#123;&#125;)</span><br><span class="line"><span class="comment">//forEach里是一个回调函数，有三个参数，分别是当前元素，索引值，整个数组</span></span><br><span class="line">a.<span class="title function_">map</span>(<span class="title function_">fn</span>(<span class="params">element</span>)&#123;&#125;)</span><br><span class="line"><span class="comment">//与forEach类似，返回新数组，原数组不变,是被一个函数处理后的数组.</span></span><br><span class="line"><span class="comment">//而forEach会修改原数组</span></span><br><span class="line"></span><br><span class="line">a.<span class="title function_">every</span>(<span class="title function_">fn</span>(<span class="params">element,index,arr</span>)&#123;&#125;)</span><br><span class="line"><span class="comment">//every是所有函数返回true才会返回true，遇到false终止，并返回false</span></span><br><span class="line">a.<span class="title function_">some</span>(<span class="title function_">fn</span>(<span class="params">element,index,arr</span>)&#123;&#125;)</span><br><span class="line"><span class="comment">//some是存在一个返回true时就终止返回true</span></span><br><span class="line"></span><br><span class="line">a.<span class="title function_">filter</span>(<span class="title function_">fn</span>(<span class="params">element</span>)&#123;&#125;)</span><br><span class="line"><span class="comment">//返回新数组，回调函数用于逻辑判断，为true则把当前元素加到返回的数组中</span></span><br><span class="line"><span class="comment">//为false则不加</span></span><br><span class="line"></span><br><span class="line">a.<span class="title function_">reduce</span>(<span class="title function_">fn</span>(v1,v2),value)</span><br><span class="line"><span class="comment">//将数组元素合成一个值，从索引值最小开始。value表示初始值</span></span><br><span class="line"></span><br><span class="line">a.<span class="title function_">abs</span>(x) <span class="comment">//返回x的绝对值</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="keyword">new</span> <span class="title class_">Set</span>(a)) <span class="comment">//数组去重</span></span><br></pre></td></tr></table></figure>

<h2 id="数组扁平化"><a href="#数组扁平化" class="headerlink" title="数组扁平化"></a>数组扁平化</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">flattenDeep</span> = (<span class="params">arr</span>) =&gt;</span><br><span class="line">  <span class="title class_">Array</span>.<span class="title function_">isArray</span>(arr)</span><br><span class="line">    ? arr.<span class="title function_">reduce</span>(<span class="function">(<span class="params">a, b</span>) =&gt;</span> [...a, ...<span class="title function_">flattenDeep</span>(b)], [])</span><br><span class="line">    : [arr];</span><br><span class="line"></span><br><span class="line"><span class="title function_">flattenDeep</span>([<span class="number">1</span>, [[<span class="number">2</span>], [<span class="number">3</span>, [<span class="number">4</span>]], <span class="number">5</span>]])[</span><br><span class="line">  <span class="comment">//flatMap方法,目前该函数在浏览器中还不支持</span></span><br><span class="line">  (<span class="number">1</span>, [<span class="number">2</span>], <span class="number">3</span>)</span><br><span class="line">].<span class="title function_">flatMap</span>(<span class="function">(<span class="params">v</span>) =&gt;</span> v + <span class="number">1</span>);</span><br><span class="line"><span class="comment">// -&gt; [2, 3, 4]</span></span><br></pre></td></tr></table></figure>

<h2 id="数组去重"><a href="#数组去重" class="headerlink" title="数组去重"></a>数组去重</h2><p>双重循环去重</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;arr.<span class="property">length</span>; i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">var</span> j=i+<span class="number">1</span>; j&lt;arr.<span class="property">length</span>; j++&gt;&#123;</span><br><span class="line">      <span class="keyword">if</span>(arr[i]===arr[j])&#123;</span><br><span class="line">        <span class="comment">//如果数组第一个等于第二个</span></span><br><span class="line">        arr.<span class="title function_">splice</span>(j,<span class="number">1</span>)</span><br><span class="line">        <span class="comment">//就干掉第j个</span></span><br><span class="line">        j--</span><br><span class="line">        <span class="comment">//因为数组arr被干掉一个,长度-1,j就相应的-1</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>new Set 去重</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Array</span>.<span class="title function_">from</span>(<span class="keyword">new</span> <span class="title class_">Set</span>(arr));</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//简化版</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">unique</span>(<span class="params">arr</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> [...<span class="keyword">new</span> <span class="title class_">Set</span>(arr)];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//精简版</span></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">unique</span> = (<span class="params">arr</span>) =&gt; [...<span class="keyword">new</span> <span class="title class_">Set</span>(arr)];</span><br></pre></td></tr></table></figure>

<h3 id="如何将浮点数点左边的数每三位添加一个逗号"><a href="#如何将浮点数点左边的数每三位添加一个逗号" class="headerlink" title="如何将浮点数点左边的数每三位添加一个逗号"></a>如何将浮点数点左边的数每三位添加一个逗号</h3><p>如 12000000.11 转化为『12,000,000.11』?</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">commafy</span>(<span class="params">num</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    num &amp;&amp;</span><br><span class="line">    num.<span class="title function_">toString</span>().<span class="title function_">replace</span>(<span class="regexp">/(\d)(?=(\d&#123;3&#125;)+\.)/g</span>, <span class="keyword">function</span> (<span class="params">$1, $2</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> $2 + <span class="string">&quot;,&quot;</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="如何实现数组的随机排序？"><a href="#如何实现数组的随机排序？" class="headerlink" title="如何实现数组的随机排序？"></a>如何实现数组的随机排序？</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">方法一：</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>];</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">randSort1</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>,i &lt; arr.<span class="property">length</span>; i++ )&#123;</span><br><span class="line">    <span class="keyword">var</span> rand = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*len);</span><br><span class="line">    <span class="keyword">var</span> temp = arr[rand];</span><br><span class="line">    arr[rand] = arr[i];</span><br><span class="line">    arr[i] = temp;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">randSort1</span>(arr));</span><br><span class="line"></span><br><span class="line">方法二：</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>];</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">randSort2</span>(<span class="params">arr</span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> mixedArray = [];</span><br><span class="line">  <span class="keyword">while</span>(arr.<span class="property">length</span> &gt; <span class="number">0</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> randomIndex = <span class="built_in">parseInt</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*arr.<span class="property">length</span>);</span><br><span class="line">    mixedArray.<span class="title function_">push</span>(arr[randomIndex]);</span><br><span class="line">    arr.<span class="title function_">splice</span>(randomIndex, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> mixedArray;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">randSort2</span>(arr));</span><br><span class="line"></span><br><span class="line">方法三：</span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>];</span><br><span class="line">arr.<span class="title function_">sort</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">random</span>() - <span class="number">0.5</span>;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(arr);</span><br></pre></td></tr></table></figure>

<h1 id="Math"><a href="#Math" class="headerlink" title="Math"></a>Math</h1><p><em>四舍五入</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">round</span>(<span class="number">0.5</span>); <span class="comment">//1</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">round</span>(-<span class="number">1.5</span>); <span class="comment">//-1</span></span><br></pre></td></tr></table></figure>

<p><em>绝对值</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">abs</span>(-<span class="number">1</span>); <span class="comment">//1</span></span><br></pre></td></tr></table></figure>

<p><em>最大值</em></p>
<p>Math.max() 函数返回一组数中的最大值。</p>
<p>参数是<code>value1, value2, ...</code></p>
<p>是一组数值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Math.max(10, 20,30);</span><br><span class="line">Math.max.call(null,10, 20,30);</span><br><span class="line">Math.max.apply(null,[10, 20,30]);</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">floor返回小于参数值的最大整数.向下取整</span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">floor</span>(-<span class="number">3.2</span>) <span class="comment">//-4</span></span><br><span class="line">ceil返回大于参数值的最小参数，向上取整</span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">ceil</span>(-<span class="number">3.2</span>)  <span class="comment">//-3</span></span><br></pre></td></tr></table></figure>

<p><em>parseInt(值，进制)</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">parseInt</span>(string, radix);</span><br><span class="line"><span class="comment">//将一个字符串 string 转换为 radix 进制的整数，</span></span><br><span class="line"><span class="comment">// radix 为介于2-36之间的数。</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>parseInt()可以将字符串转为数字，也可以将数字取整。向下取整。</p>
</blockquote>
<p>如果第一个字符是数字会解析直到遇到非数字结束，如果第一个字符不是数字或者符号（如：+、-）就返回 NaN。</p>
<p>带自动净化功能；带自动截断小数功能，且取整，不四舍五入。</p>
<p>radix: 基数,也就是进制.介于 2-36 之间,超出都是返回 NaN.radix 不写默认是十进制.如果传入字符串是 0x 开头,默认是 16 进制.如果是 0 开头,默认 8 进制.任何数的 0 进制都是它本身.高于进制位能表示的最大值数返回 NaN.比如说 2 的一进制返回 NaN,因为一进制只能用 1 表示,2 作为一进制来表示明显不对.</p>
<p><em>几次方</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">pow</span>(x, y); <span class="comment">//返回 x 的 y 次幂的值。</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">pow</span>(<span class="number">2</span>, <span class="number">2</span>); <span class="comment">//4</span></span><br></pre></td></tr></table></figure>

<p><em>平方根</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">sqrt</span>(<span class="number">4</span>); <span class="comment">// 2</span></span><br><span class="line"><span class="title class_">Math</span>.<span class="title function_">sqrt</span>(-<span class="number">4</span>); <span class="comment">//NaN</span></span><br></pre></td></tr></table></figure>

<p><strong>random</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Math</span>.<span class="title function_">random</span>();</span><br><span class="line"><span class="comment">//返回0-1之间的伪随机数.0≦x&lt;1</span></span><br></pre></td></tr></table></figure>

<h1 id="Date"><a href="#Date" class="headerlink" title="Date"></a>Date</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Date</span>.<span class="title function_">now</span>(); <span class="comment">//获取1970年至今的毫秒数</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="title function_">parse</span>(); <span class="comment">//解析日期字符串，返回距离1970年的毫秒数</span></span><br><span class="line"><span class="title class_">Date</span>.<span class="title function_">parse</span>(<span class="string">&quot;2011-01-11&quot;</span>); <span class="comment">//13234436600000</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Date</span>(); <span class="comment">//使用Date构造函数创建一个Date实例，</span></span><br><span class="line"><span class="comment">//不传时间就返回当前时间的字符串</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> str = <span class="string">&quot;2019-01-11&quot;</span>;</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Date</span>(str);</span><br><span class="line"><span class="comment">//Fri Jan 11 2019 08:00:00 GMT+0800 (香港标准时间)</span></span><br><span class="line"><span class="comment">//获取的是东八区8点的时间，因为格林尼治时间伦敦是0点</span></span><br></pre></td></tr></table></figure>

<p><em>get 方法</em></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">getDate</span>(); <span class="comment">//日</span></span><br><span class="line"><span class="title function_">getDay</span>(); <span class="comment">//星期几，周日是0，周一是1</span></span><br><span class="line"><span class="title function_">getFullyear</span>(); <span class="comment">//返回四位的年份</span></span><br><span class="line"><span class="title function_">getMouth</span>(); <span class="comment">//返回月份，一月是0，腊月是11</span></span><br><span class="line"><span class="title function_">getHours</span>(); <span class="comment">//小时（0-23）</span></span><br><span class="line"><span class="title function_">getMinutes</span>(); <span class="comment">// 返回分钟</span></span><br><span class="line"><span class="title function_">getSenconds</span>(); <span class="comment">// 秒</span></span><br><span class="line"><span class="title function_">getMilliseconds</span>(); <span class="comment">// 毫秒(0-999)</span></span><br></pre></td></tr></table></figure>

<p><em>set 方法</em>类似于 get 方法，是设置时间</p>
<h2 id="时间格式化过滤器"><a href="#时间格式化过滤器" class="headerlink" title="时间格式化过滤器"></a>时间格式化过滤器</h2><p>Vue 版本</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;date | dateFormat &#125;&#125;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="attr">filters</span>: &#123;</span><br><span class="line">    <span class="comment">//时间格式化</span></span><br><span class="line">    <span class="attr">dateFormat</span>: <span class="keyword">function</span>(<span class="params">date</span>) &#123;</span><br><span class="line">      <span class="comment">//date是传入的时间字符串</span></span><br><span class="line">      <span class="keyword">let</span> t = <span class="keyword">new</span> <span class="title class_">Date</span>(date);</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        t.<span class="title function_">getFullYear</span>() +</span><br><span class="line">        <span class="string">&quot;-&quot;</span> +</span><br><span class="line">        (t.<span class="title function_">getMonth</span>() + <span class="number">1</span>) +</span><br><span class="line">        <span class="string">&quot;-&quot;</span> +</span><br><span class="line">        t.<span class="title function_">getDate</span>() +</span><br><span class="line">        <span class="string">&quot; &quot;</span> +</span><br><span class="line">        t.<span class="title function_">getHours</span>() +</span><br><span class="line">        <span class="string">&quot;:&quot;</span> +</span><br><span class="line">        t.<span class="title function_">getMinutes</span>() +</span><br><span class="line">        <span class="string">&quot;:&quot;</span> +</span><br><span class="line">        t.<span class="title function_">getSeconds</span>()</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h1 id="异步和回调"><a href="#异步和回调" class="headerlink" title="异步和回调"></a>异步和回调</h1><h2 id="setTimeout-和-setInterval"><a href="#setTimeout-和-setInterval" class="headerlink" title="setTimeout 和 setInterval"></a>setTimeout 和 setInterval</h2><p>区别: setInterval 指定某个任务每隔一段时间就执行一次,也就是无限次的定时执行.</p>
<p>清除定时器: clearTimeout()和 clearInterval()</p>
<h2 id="运行机制"><a href="#运行机制" class="headerlink" title="运行机制"></a>运行机制</h2><p>setTimeout 和 setInterval 的运行机制是,将指定的代码移出本次执行,等到下一轮 Event Loop,再检查是否到了指定时间.如果到了,就执行对应代码,不到,就等到下一轮重新判断.这也就意味着,setTimeout 指定的代码,必须等到本次执行的所有代码都执行完,才会执行.</p>
<h2 id="单线程模型"><a href="#单线程模型" class="headerlink" title="单线程模型"></a>单线程模型</h2><p>异步的任务放在任务队列(callback queue)中,setTimeout 也是.必须等放在栈(stack)中的同步代码执行完,才会执行任务队列中的.</p>
<h2 id="event-loop-事件循环"><a href="#event-loop-事件循环" class="headerlink" title="event loop(事件循环)"></a>event loop(事件循环)</h2><p>经典案例:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>; i++)&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(fucntion <span class="title function_">timer</span>(<span class="params"></span>)&#123;</span><br><span class="line">    comsole.<span class="title function_">log</span>(i)</span><br><span class="line">  &#125;,<span class="number">1000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我的理解:</p>
<p>开始循环遍历.(同步代码)</p>
<p>i&#x3D;0.创建一个 console.log(i).放到队列里，并不执行.</p>
<p>i&#x3D;1.创建一个 console.log(i).放到队列里，并不执行，</p>
<p>直到 i&#x3D;5.依次创建了 5 个 console.log(i)</p>
<p>因为 setTimeout 是异步,所以必须等同步执行完才开始执行异步.</p>
<p>同步代码 i 循环到 5，输出，有 5 个 console.log(i)在队列里嗷嗷待哺</p>
<p>，把 i&#x3D;5 赋值进去.得到 5 个 5.</p>
<h2 id="函数节流"><a href="#函数节流" class="headerlink" title="函数节流"></a>函数节流</h2><p>在时间内，如果执行，就重新开始</p>
<p><strong>原理</strong>：当达到了一定的时间间隔就会执行一次；可以理解为是<strong>缩减执行频率</strong></p>
<p>函数节流会用在比 input, keyup 更频繁触发的事件中，如 resize, touchmove, mousemove, scroll。throttle 会强制函数以固定的速率执行。因此这个方法比较适合应用于动画相关的场景。</p>
<p>常用场景:</p>
<ol>
<li>搜索框搜索输入。只需用户最后一次输入完，再发送请求</li>
<li>手机号、邮箱验证输入检测</li>
<li>窗口大小 Resize。只需窗口调整完成后，计算窗口大小。防止重复渲染。</li>
</ol>
<p>简单版本:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">fn, ms</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timer; <span class="comment">//命名一个定时器</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">      <span class="comment">//如果有定时器就退出</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    timer = <span class="built_in">setTimeout</span>(fn, ms);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">fn</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> fn2 = <span class="title function_">throttle</span>(fn, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>

<p>时间戳版本:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">throttle</span> = (<span class="params">fn, wait</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">let</span> last = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> current_time = +<span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">if</span> (current_time - last &gt; wait) &#123;</span><br><span class="line">      fn.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">      last = +<span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="函数防抖"><a href="#函数防抖" class="headerlink" title="函数防抖"></a>函数防抖</h2><p><strong>原理</strong>：将若干函数调用合成为一次，并在给定时间过去之后，或者连续事件完全触发完成之后，调用一次(<strong>仅仅只会调用一次</strong>)</p>
<p>适合场景:</p>
<ol>
<li>滚动加载，加载更多或滚到底部监听</li>
<li>谷歌搜索框，搜索联想功能</li>
<li>高频点击提交，表单重复提交</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">fn, ms</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timer = <span class="literal">null</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">    timer = <span class="title function_">setTimerout</span>(fn, ms);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//实际上上面这就可以了</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">vlog</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onscroll</span> = <span class="title function_">debounce</span>(vlog, <span class="number">500</span>);</span><br></pre></td></tr></table></figure>

<p>带有立即执行选项的防抖函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这个是用来获取当前时间戳的</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">now</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> +<span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 防抖函数，返回函数连续调用时，空闲时间必须大于或等于 wait，func 才会执行</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  &#123;<span class="type">function</span>&#125; func        回调函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  &#123;<span class="type">number</span>&#125;   wait        表示时间窗口的间隔</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span>  &#123;<span class="type">boolean</span>&#125;  immediate   设置为ture时，是否立即调用函数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> &#123;<span class="type">function</span>&#125;             返回客户调用函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">func, wait = <span class="number">50</span>, immediate = <span class="literal">true</span></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timer, context, args;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 延迟执行函数</span></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">later</span> = (<span class="params"></span>) =&gt;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 延迟函数执行完毕，清空缓存的定时器序号</span></span><br><span class="line">      timer = <span class="literal">null</span>;</span><br><span class="line">      <span class="comment">// 延迟执行的情况下，函数会在延迟函数中执行</span></span><br><span class="line">      <span class="comment">// 使用到之前缓存的参数和上下文</span></span><br><span class="line">      <span class="keyword">if</span> (!immediate) &#123;</span><br><span class="line">        func.<span class="title function_">apply</span>(context, args);</span><br><span class="line">        context = args = <span class="literal">null</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, wait);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 这里返回的函数是每次实际调用的函数</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params">...params</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果没有创建延迟执行函数（later），就创建一个</span></span><br><span class="line">    <span class="keyword">if</span> (!timer) &#123;</span><br><span class="line">      timer = <span class="title function_">later</span>();</span><br><span class="line">      <span class="comment">// 如果是立即执行，调用函数</span></span><br><span class="line">      <span class="comment">// 否则缓存参数和调用上下文</span></span><br><span class="line">      <span class="keyword">if</span> (immediate) &#123;</span><br><span class="line">        func.<span class="title function_">apply</span>(<span class="variable language_">this</span>, params);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        context = <span class="variable language_">this</span>;</span><br><span class="line">        args = params;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 如果已有延迟执行函数（later），调用的时候清除原来的并重新设定一个</span></span><br><span class="line">      <span class="comment">// 这样做延迟函数会重新计时</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">      timer = <span class="title function_">later</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>对于按钮防点击来说的实现：</p>
</blockquote>
<p>如果函数是立即执行的，就立即调用，如果函数是延迟执行的，就缓存上下文和参数，放到延迟函数中去执行。一旦我开始一个定时器，只要我定时器还在，你每次点击我都重新计时。一旦你点累了，定时器时间到，定时器重置为 null，就可以再次点击了。</p>
<p>对于延时执行函数来说的实现：</p>
<p>清除定时器 ID，如果是延迟调用就调用函数</p>
<p><strong>节流和防抖的区别</strong></p>
<blockquote>
<p>他们的区别在于防抖只会在连续的事件周期结束时执行一次，而节流会在事件周期内按间隔时间有规律的执行多次。</p>
</blockquote>
<p>我的理解:</p>
<p>函数节流:</p>
<p>只要又执行函数,就退出.必须等上一次定时器任务执行完.这一段时间只执行一次.</p>
<p>函数防抖:</p>
<p>只要又执行函数,就清除定时器,重新设置定时器.只要重复就重新开始,最后肯定有一次.</p>
<h1 id="DOM-元素创建和选取"><a href="#DOM-元素创建和选取" class="headerlink" title="DOM 元素创建和选取"></a>DOM 元素创建和选取</h1><p>DOM 是文档对象模型，是 html 的编程接口</p>
<p>readyState 加载状态</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>;</span><br><span class="line"><span class="comment">//location属性返回一个只读对象，提供当前文档的url信息</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">href</span>; <span class="comment">//获取url</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">protocol</span>; <span class="comment">//获取&quot;http:&quot;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">hostname</span>; <span class="comment">// &quot;www.example.com&quot;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">port</span>; <span class="comment">// &quot;4097&quot;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="property">pathname</span>; <span class="comment">// &quot;/path/a.html&quot;</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="title function_">assign</span>(<span class="string">&quot;http://www.Google.com&quot;</span>);</span><br><span class="line"><span class="comment">//跳转到指定网址</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="title function_">reload</span>(<span class="literal">true</span>); <span class="comment">//优先从服务器重新加载</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">location</span>.<span class="title function_">reload</span>(<span class="literal">false</span>); <span class="comment">//优先从本地缓存加载</span></span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">open</span>(); <span class="comment">//新建文档可以使用write写入</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">close</span>(); <span class="comment">//关闭文档</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">write</span>(); <span class="comment">//写入文档,会清除之前的文档流</span></span><br></pre></td></tr></table></figure>

<p><strong>Element</strong>表示 html 元素</p>
<ol>
<li>element 的属性：</li>
<li>nodeName: 元素标签名</li>
<li>nodeType:元素类型</li>
<li>className:类名</li>
<li>id:元素 id</li>
<li>children:子元素列表</li>
<li>childNodes: 子元素列表（NodeList）</li>
<li>firstChild: 第一个子元素</li>
<li>lastChild:最后一个</li>
<li>nextSibling: 下一个兄弟元素</li>
<li>previousSibling: 上一个兄弟元素</li>
<li>parentNode.parentElement: 父元素</li>
</ol>
<p><strong>查询元素</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;target&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;box&quot;</span>);</span><br><span class="line"><span class="comment">//上述为ES3写法</span></span><br><span class="line"><span class="comment">//下面是ES5写法</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box&quot;</span>);</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#tatget&quot;</span>);</span><br><span class="line"><span class="comment">//多个元素只会选择第一个</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//选择多个</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line"><span class="comment">//浏览器控制台测试时可以用$替代document.querySelector</span></span><br><span class="line"><span class="comment">//用$$替代document.querySelectorAll</span></span><br></pre></td></tr></table></figure>

<p><strong>创建元素</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span><br><span class="line"><span class="comment">//生成文本节点</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">createTextNode</span>(<span class="string">&quot;Hello&quot;</span>);</span><br><span class="line"><span class="comment">//生成DocumentFragment对象</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">createDocumentFragment</span>();</span><br><span class="line"><span class="comment">//存在于内存中的DOM片段，不属于当前文档。</span></span><br><span class="line"><span class="comment">//对它的任何改动，都不会引发网页的重新渲染</span></span><br></pre></td></tr></table></figure>

<p><strong>修改元素</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">在元素末尾添加元素;</span><br><span class="line"><span class="title function_">appendChild</span>();</span><br><span class="line">newDiv.<span class="title function_">appendChild</span>(newContent);</span><br><span class="line"></span><br><span class="line">在元素之前插入元素;</span><br><span class="line"><span class="title function_">insertBefore</span>();</span><br><span class="line"></span><br><span class="line">替换元素;</span><br><span class="line"><span class="title function_">replaceChild</span>(newElement, oldElement);</span><br><span class="line"></span><br><span class="line">删除元素;</span><br><span class="line">parentNode.<span class="title function_">removeChild</span>(childNode);</span><br><span class="line"></span><br><span class="line">clone元素;</span><br><span class="line">node.<span class="title function_">cloneNode</span>(<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//方法有一个布尔值，传入true时会深拷贝，</span></span><br><span class="line"><span class="comment">//复制元素及其子元素，false只会复制元素本身</span></span><br></pre></td></tr></table></figure>

<h1 id="DOM-元素属性"><a href="#DOM-元素属性" class="headerlink" title="DOM 元素属性"></a>DOM 元素属性</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">获取属性</span><br><span class="line">node.<span class="title function_">getAttribute</span>(<span class="string">&quot;id&quot;</span>)</span><br><span class="line"></span><br><span class="line">生成新的属性对象节点</span><br><span class="line">attribute = <span class="variable language_">document</span>.<span class="title function_">createAttribute</span>(name)</span><br><span class="line"></span><br><span class="line">一般用 <span class="title function_">setAttribute</span>()设置元素属性</span><br><span class="line"><span class="keyword">var</span> node = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;id&quot;</span>)</span><br><span class="line">node.<span class="title function_">setAttribute</span>(<span class="string">&quot;id&quot;</span>, <span class="string">&quot;newVal&quot;</span>)</span><br><span class="line"></span><br><span class="line">删除属性节点</span><br><span class="line">node.<span class="title function_">removeAttribute</span>(<span class="string">&quot;id&quot;</span>)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>innerText</strong>可写属性，返回元素内包含的文本内容，在多层次的时候按照元素由浅到深的顺序拼接内容</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    123</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>456<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure>

<p>外层 div 的 innerText 返回内容是  <code>&quot;123456&quot;</code></p>
<ul>
<li><strong>innerHTML</strong>返回元素 html 结构，在写入的时候也会自动构建 DOM</li>
</ul>
<h2 id="样式"><a href="#样式" class="headerlink" title="样式"></a>样式</h2><p>修改样式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;p&quot;</span>).<span class="property">style</span>.<span class="property">color</span> = <span class="string">&quot;red&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>获取样式 getComputedStyle</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> node = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;p&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> color = <span class="variable language_">window</span>.<span class="title function_">getComputedStyle</span>(node).<span class="property">color</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(color);</span><br><span class="line"><span class="comment">//获取计算后的样式，只读。全局属性</span></span><br></pre></td></tr></table></figure>

<h2 id="class-操作的增删改查"><a href="#class-操作的增删改查" class="headerlink" title="class 操作的增删改查"></a>class 操作的增删改查</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> nodeBox = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.box&quot;</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(nodeBox.<span class="property">classList</span>);</span><br><span class="line">nodeBox.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;active&quot;</span>); <span class="comment">//新增class</span></span><br><span class="line">nodeBox.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;active&quot;</span>); <span class="comment">//删除</span></span><br><span class="line">nodeBox.<span class="property">classList</span>.<span class="title function_">toggle</span>(<span class="string">&quot;active&quot;</span>); <span class="comment">//新增删除切换</span></span><br><span class="line">node.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&quot;active&quot;</span>); <span class="comment">//判断是否拥有class</span></span><br></pre></td></tr></table></figure>

<h2 id="页面宽高"><a href="#页面宽高" class="headerlink" title="页面宽高"></a>页面宽高</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">element.<span class="property">clientHeight</span>; <span class="comment">//包括padding,相当于IE盒模型,content-box</span></span><br><span class="line">element.<span class="property">offsetHeight</span>; <span class="comment">//包括border,相当于标准盒模型,border-box</span></span><br><span class="line">element.<span class="property">scrollHeight</span>; <span class="comment">//滚动区域的总高度(元素的起始位置的底边到停止位置的顶边),包括元素的padding，但不包括元素的border和margin</span></span><br><span class="line">element.<span class="property">scrollTop</span>; <span class="comment">//滚动的高度</span></span><br><span class="line">element.<span class="property">offsetTop</span>; <span class="comment">//返回当前元素相对于其 offsetParent 元素的顶部内边距的距离。</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">innerHeight</span>; <span class="comment">//视口的高度,不包括标题栏等,包括水平滚动条</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">outerHeight</span>; <span class="comment">//整个浏览器窗口的高度,包括标题栏等所有浏览器内容</span></span><br></pre></td></tr></table></figure>

<h3 id="如何判断一个元素是否出现在窗口视野中"><a href="#如何判断一个元素是否出现在窗口视野中" class="headerlink" title="如何判断一个元素是否出现在窗口视野中"></a>如何判断一个元素是否出现在窗口视野中</h3><p>滚动的距离 + 窗口的高度 &#x3D; 目标元素到顶部的距离</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">`window.scrollTop + window.innerHeight = element.offsetTop`</span>;</span><br><span class="line"><span class="comment">//方法二</span></span><br><span class="line">$(<span class="string">&quot;element&quot;</span>).<span class="title function_">offset</span>().<span class="property">top</span> &lt;= $(<span class="variable language_">window</span>).<span class="title function_">height</span>() + $(<span class="variable language_">window</span>).<span class="title function_">scrollTop</span>();</span><br></pre></td></tr></table></figure>

<h3 id="如何判断页面滚动到底部"><a href="#如何判断页面滚动到底部" class="headerlink" title="如何判断页面滚动到底部"></a>如何判断页面滚动到底部</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//窗口滚动的距离 + 窗口的高度 = 整个页面的高度</span></span><br><span class="line">$(<span class="variable language_">window</span>).<span class="title function_">scrollTop</span>() + $(<span class="variable language_">window</span>).<span class="title function_">height</span>() = $(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">height</span>()</span><br><span class="line"><span class="comment">//方法二</span></span><br><span class="line"><span class="comment">//元素滚动的距离 + 元素的高度 = 元素的滚动区域的高度</span></span><br><span class="line">element.<span class="property">scrollTop</span> + element.<span class="property">clientHeight</span> = element.<span class="property">scrollHeight</span></span><br></pre></td></tr></table></figure>

<h1 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h1><p>DOM 事件流: 捕获阶段，目标阶段，冒泡阶段</p>
<h3 id="事件绑定"><a href="#事件绑定" class="headerlink" title="事件绑定"></a>事件绑定</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;input id=<span class="string">&quot;btnClick&quot;</span> type=<span class="string">&quot;button&quot;</span> value=<span class="string">&quot;Click here&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> btnClick = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;btnClick&quot;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">btnClick.<span class="property">onclick</span> = <span class="keyword">function</span> <span class="title function_">showMessage</span>(<span class="params"></span>)&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">id</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<blockquote>
<p>点击事件是异步的.</p>
</blockquote>
<p><em>会存在覆盖</em></p>
<h3 id="DOM2-事件处理-升级版"><a href="#DOM2-事件处理-升级版" class="headerlink" title="DOM2 事件处理(升级版)"></a>DOM2 事件处理(升级版)</h3><ul>
<li>addEventListener &#x2F;&#x2F;绑定事件</li>
<li>removeEventListener &#x2F;&#x2F;解绑事件</li>
</ul>
<p>所有 DOM 节点都包含这两个方法，且都接受三个函数：</p>
<ol>
<li>事件类型</li>
<li>事件处理方法</li>
<li>布尔参数，<code>true</code>表示在捕获阶段调用，<code>false</code>表示在事件冒泡阶段处理，<strong>默认是冒泡阶段</strong></li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">btnClick.<span class="title function_">addEventListener</span>(</span><br><span class="line">  <span class="string">&quot;click&quot;</span>,</span><br><span class="line">  <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="variable language_">this</span>.<span class="property">id</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="literal">false</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p><em>不存在覆盖，可以写多个方法</em></p>
<h3 id="属性方法"><a href="#属性方法" class="headerlink" title="属性方法"></a>属性方法</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">preventDefault</span>(); <span class="comment">//取消默认事件行为</span></span><br><span class="line"><span class="title function_">stopPropagation</span>(); <span class="comment">//取消事件进一步捕获或冒泡</span></span><br><span class="line"><span class="title function_">target</span>(); <span class="comment">//事件的目标元素</span></span><br></pre></td></tr></table></figure>

<h3 id="事件代理"><a href="#事件代理" class="headerlink" title="事件代理"></a>事件代理</h3><p>事件委托(代理)就是利用冒泡的原理，把事件加到父元素或祖先元素上，触发执行效果。</p>
<p>使用事件代理来实现它，监听的元素应该是这些元素的父元素，当我点击父元素内的元素时，父元素都会得到响应，并分发相应的事件。  <code>e.target</code>就是点击的元素。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">&quot;.container&quot;</span>).<span class="property">onclick</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">target</span>);</span><br><span class="line">  <span class="keyword">if</span> (e.<span class="property">target</span>.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&quot;box&quot;</span>)) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">target</span>.<span class="property">innerText</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="常见事件及自定义事件"><a href="#常见事件及自定义事件" class="headerlink" title="常见事件及自定义事件"></a>常见事件及自定义事件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">鼠标事件;</span><br><span class="line">click;</span><br><span class="line">dblclick; <span class="comment">//双击左键</span></span><br><span class="line">mouseover; <span class="comment">//鼠标放上</span></span><br><span class="line">mouseout; <span class="comment">//鼠标移出</span></span><br><span class="line">mouseenter; <span class="comment">//类似over，区别不计算子元素</span></span><br><span class="line">mouseleave; <span class="comment">//类似out，区别不计算子元素</span></span><br><span class="line">mousedown; <span class="comment">//鼠标按下</span></span><br><span class="line">mouseup; <span class="comment">//鼠标松开</span></span><br><span class="line"></span><br><span class="line">触摸事件;</span><br><span class="line">touchstart;</span><br><span class="line">touchend;</span><br><span class="line">touchmove;</span><br><span class="line"></span><br><span class="line">键盘事件;</span><br><span class="line">keyup; <span class="comment">//按键后松开触发</span></span><br><span class="line">keydown; <span class="comment">//按键即会触发</span></span><br><span class="line">keypress; <span class="comment">//按下松开</span></span><br><span class="line"></span><br><span class="line">页面相关事件;</span><br><span class="line">onload; <span class="comment">//加载完成时触发</span></span><br><span class="line">onmove; <span class="comment">//浏览器窗口被移动</span></span><br><span class="line">scroll; <span class="comment">//滚动条滚动</span></span><br><span class="line">resize; <span class="comment">//窗口大小变化</span></span><br><span class="line"></span><br><span class="line">表单相关;</span><br><span class="line">focus; <span class="comment">//获取焦点</span></span><br><span class="line">blur; <span class="comment">//失去焦点</span></span><br><span class="line">change; <span class="comment">//失去焦点且内容发生改变</span></span><br><span class="line">reset; <span class="comment">//reset属性被激活</span></span><br><span class="line">submit; <span class="comment">//提交，一般是表格提交</span></span><br><span class="line">input; <span class="comment">//在input元素内容修改后立即触发</span></span><br><span class="line">onload; <span class="comment">//页面所有资源加载完成</span></span><br><span class="line"><span class="title class_">DOMContentLoaded</span>; <span class="comment">//dom结构解析完成</span></span><br><span class="line"></span><br><span class="line">编辑事件;</span><br><span class="line">beforecopy; <span class="comment">//复制之前</span></span><br><span class="line">beforecut; <span class="comment">//剪切之前</span></span><br><span class="line">beforepaste; <span class="comment">//粘贴之前</span></span><br><span class="line">beforeeditfocus; <span class="comment">//将要进去编辑状态</span></span><br><span class="line">contextmenu; <span class="comment">//按右键出现菜单或者键盘触发页面菜单</span></span><br><span class="line">losecapture; <span class="comment">//失去鼠标移动所形成的选择焦点</span></span><br><span class="line">select; <span class="comment">//被选择时</span></span><br><span class="line"></span><br><span class="line">拖动事件;</span><br><span class="line">drag; <span class="comment">//某个对象被拖动</span></span><br><span class="line">dragdrop; <span class="comment">//外部对象被拖到当前窗口</span></span><br><span class="line">dragend; <span class="comment">//拖动结束</span></span><br><span class="line">dragenter; <span class="comment">//被拖动对象进入其容器范围</span></span><br></pre></td></tr></table></figure>

<h1 id="js-拖动-div"><a href="#js-拖动-div" class="headerlink" title="js 拖动 div"></a>js 拖动 div</h1><ol>
<li>使用<code>mouse</code>实现</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span></span><br><span class="line">	<span class="language-xml"><span class="tag">&lt;<span class="name">title</span>&gt;</span> mouse实现div拖动 <span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-id">#div</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	<span class="attribute">position</span>: absolute;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	<span class="attribute">left</span>: <span class="number">100px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	<span class="attribute">top</span>: <span class="number">100px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	<span class="attribute">width</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	<span class="attribute">height</span>: <span class="number">200px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">	<span class="attribute">background-color</span>: <span class="number">#f60</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line">&lt;/head&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;drag&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> drag = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;drag&quot;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> dragFlag = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> x,y;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">drag.<span class="property">onmousedown</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	e = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	x = e.<span class="property">clientX</span> - drag.<span class="property">offsetLeft</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	y = e.<span class="property">clientY</span> - drag.<span class="property">offsetTop</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	dragFlag = <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="variable language_">document</span>.<span class="property">onmousemove</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	<span class="keyword">if</span> (dragFlag) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		e = e || <span class="variable language_">window</span>.<span class="property">event</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		drag.<span class="property">style</span>.<span class="property">left</span> = e.<span class="property">clientX</span> - x + <span class="string">&quot;px&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">		drag.<span class="property">style</span>.<span class="property">top</span>  = e.<span class="property">clientY</span> - y + <span class="string">&quot;px&quot;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="variable language_">document</span>.<span class="property">onmouseup</span> = <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">	dragFlag = <span class="literal">false</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>drag 实现</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"><span class="selector-class">.divblok</span> &#123;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">background-color</span>:<span class="number">#ccc</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">width</span>:<span class="number">30px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">height</span>:<span class="number">30px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">position</span>:absolute;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">left</span>:<span class="number">20px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">    <span class="attribute">top</span>:<span class="number">20px</span>;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-css"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span></span><br><span class="line">&lt;/head&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;dragdiv&quot;</span> <span class="attr">draggable</span>=<span class="string">&quot;true&quot;</span> <span class="attr">class</span>=<span class="string">&quot;divblok&quot;</span>&gt;</span>我要移动 <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> dragdiv = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#dragdiv&#x27;</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">var</span> x, y;  <span class="comment">//记录到点击时鼠标到移动框左边和上边的距离</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">dragdiv.<span class="title function_">addEventListener</span>(<span class="string">&#x27;dragstart&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    e.<span class="property">dataTransfer</span>.<span class="property">effectAllowed</span> = <span class="string">&quot;move&quot;</span>;  <span class="comment">//移动效果</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    e.<span class="property">dataTransfer</span>.<span class="title function_">setData</span>(<span class="string">&quot;text&quot;</span>, <span class="string">&#x27;&#x27;</span>);  <span class="comment">//附加数据，　没有这一项，firefox中无法移动</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    x = e.<span class="property">offsetX</span> || e.<span class="property">layerX</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    y = e.<span class="property">offsetY</span> || e.<span class="property">layerY</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;, <span class="literal">false</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;dragover&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;<span class="comment">//取消冒泡 ,不取消则不能触发 drop事件</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    e.<span class="title function_">preventDefault</span>()|| e.<span class="title function_">stopPropagation</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;, <span class="literal">false</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;drop&#x27;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    dragdiv.<span class="property">style</span>.<span class="property">left</span> = (e.<span class="property">pageX</span> - x) + <span class="string">&#x27;px&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    dragdiv.<span class="property">style</span>.<span class="property">top</span> = (e.<span class="property">pageY</span> - y) + <span class="string">&#x27;px&#x27;</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    e.<span class="title function_">preventDefault</span>() || e.<span class="title function_">stopPropagation</span>();  <span class="comment">//不取消，firefox中会触发网页跳转到查找setData中的内容</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;, <span class="literal">false</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<h3 id="自定义事件"><a href="#自定义事件" class="headerlink" title="自定义事件"></a>自定义事件</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> <span class="title class_">EventCenter</span> = &#123;</span><br><span class="line">  <span class="attr">on</span>: <span class="keyword">function</span> (<span class="params">type, handler</span>) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(type, handler);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">fire</span>: <span class="keyword">function</span> (<span class="params">type, data</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">document</span>.<span class="title function_">dispatchEvent</span>(</span><br><span class="line">      <span class="keyword">new</span> <span class="title class_">CustomEvent</span>(type, &#123;</span><br><span class="line">        <span class="attr">detail</span>: data,</span><br><span class="line">      &#125;)</span><br><span class="line">    );</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">EventCenter</span>.<span class="title function_">on</span>(<span class="string">&quot;hello&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(e.<span class="property">detail</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="title class_">EventCenter</span>.<span class="title function_">fire</span>(<span class="string">&quot;hello&quot;</span>, <span class="string">&quot;你好&quot;</span>);</span><br><span class="line"><span class="comment">//一个监听函数，一个处理函数</span></span><br></pre></td></tr></table></figure>

<h1 id="JS-动画"><a href="#JS-动画" class="headerlink" title="JS 动画"></a>JS 动画</h1><h3 id="requestAnimationFrame"><a href="#requestAnimationFrame" class="headerlink" title="requestAnimationFrame"></a>requestAnimationFrame</h3><p>可以在一定时间内自动执行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">move</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (moveOffset &lt; offsetX) &#123;</span><br><span class="line">    ball.<span class="property">style</span>.<span class="property">left</span> = <span class="built_in">parseInt</span>(<span class="title function_">getComputedStyle</span>(ball).<span class="property">left</span>) + step + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">    moveOffset += step;</span><br><span class="line">    <span class="title function_">requestAnimationFrame</span>(move);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">move</span>();</span><br></pre></td></tr></table></figure>

<h1 id="BOM"><a href="#BOM" class="headerlink" title="BOM"></a>BOM</h1><p>bom 指浏览器对象模型，核心是 window 对象。是浏览器的实例</p>
<p><strong>window.innerHeight</strong>属性，<strong>window.innerWidth</strong>属性.这两个属性返回网页的 CSS 布局占据的浏览器窗口的高度和宽度，单位为像素。很显然，当用户放大网页的时候（比如将网页从 100%的大小放大为 200%），这两个属性会变小。</p>
<p>注意，这两个属性值包括滚动条的高度和宽度。</p>
<ol>
<li>scrollX：滚动条横向偏移</li>
<li>scrollY：滚动条纵向偏移</li>
</ol>
<p>这两个值随着滚动位置变化而变化</p>
<p><strong>window.frames</strong>返回一个类似数组的对象，成员为页面内的所有框架，包括 frame 元素和 iframe 元素。</p>
<p>需要注意的是，window.frames 的每个成员对应的是框架内的窗口（即框架的 window 对象），获取每个框架的 DOM 树，需要使用<code>window.frames[0].document</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> iframe = <span class="variable language_">window</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;iframe&quot;</span>)[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">var</span> iframe_title = iframe.<span class="property">contentWindow</span>.<span class="property">title</span>;</span><br></pre></td></tr></table></figure>

<p>上面代码用于获取框架页面的标题。</p>
<blockquote>
<p>iframe 元素遵守同源政策，只有当父页面与框架页面来自同一个域名，两者之间才可以用脚本通信，否则只有使用 window.postMessage 方法。</p>
</blockquote>
<p>在 iframe 框架内部，使用 window.parent 指向父页面。</p>
<h3 id="navigator"><a href="#navigator" class="headerlink" title="navigator"></a>navigator</h3><p>指向一个包含浏览器相关信息的对象.</p>
<h3 id="window-getComputedStyle"><a href="#window-getComputedStyle" class="headerlink" title="window.getComputedStyle"></a>window.getComputedStyle</h3><p>getComputedStyle 是一个可以获取当前元素所有最终使用的 CSS 属性值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var style = window.getComputedStyle(&quot;元素&quot;, &quot;伪类&quot;)</span><br></pre></td></tr></table></figure>

<h3 id="URL-的编码-x2F-解码方法"><a href="#URL-的编码-x2F-解码方法" class="headerlink" title="URL 的编码&#x2F;解码方法"></a>URL 的编码&#x2F;解码方法</h3><p>JavaScript 提供四个 URL 的编码&#x2F;解码方法。</p>
<ol>
<li>decodeURI()</li>
<li>decodeURIComponent()</li>
<li>encodeURI()</li>
<li>encodeURIComponent()</li>
</ol>
<p><strong>区别</strong></p>
<p>encodeURI 方法<strong>不会</strong>对下列字符编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. ASCII字母</span><br><span class="line">2. 数字</span><br><span class="line">3. ~!@#$&amp;*()=:/,;?+&#x27;</span><br></pre></td></tr></table></figure>

<p>encodeURIComponent 方法<strong>不会</strong>对下列字符编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. ASCII字母</span><br><span class="line">2. 数字</span><br><span class="line">3. ~!*()&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="alert-，prompt-，confirm"><a href="#alert-，prompt-，confirm" class="headerlink" title="alert()，prompt()，confirm()"></a>alert()，prompt()，confirm()</h3><p><code>alert()、prompt()、confirm()</code>都是浏览器用来与用户互动的方法。它们会弹出不同的对话框，要求用户做出回应。</p>
<p>需要注意的是，alert()、prompt()、confirm()这三个方法弹出的对话框，都是浏览器统一规定的式样，是无法定制的。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/magisk/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/magisk/" class="post-title-link" itemprop="url">magisk</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:07:25" itemprop="dateCreated datePublished" datetime="2022-09-26T21:07:25+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:53" itemprop="dateModified" datetime="2022-12-27T11:12:53+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<h2 id="title-magiskdate-2019-12-15-11-10-15"><a href="#title-magiskdate-2019-12-15-11-10-15" class="headerlink" title="title: magiskdate: 2019-12-15 11:10:15"></a>title: magiskdate: 2019-12-15 11:10:15</h2><p>tags: android</p>
<p>magisk</p>
<p>Magisk manager is a magic mask to alter system systemless-ly.</p>
<p>Installing Magisk will give you ROOT, a super powerful Systemless Interface,</p>
<p>Magisk Modules support, and hide from tons of integrity tests like SafetyNet!</p>
<h1 id="What-is-Magisk"><a href="#What-is-Magisk" class="headerlink" title="What is Magisk?"></a>What is Magisk?</h1><p>Magisk is a great open-source root solution for Android devices which is developed by topjohnwu[<a target="_blank" rel="noopener" href="https://forum.xda-developers.com/member.php?u=4470081">https://forum.xda-developers.com/member.php?u=4470081</a>], offering a “Systemless Interface”, allowing easy modification of your favourite device with peace of mind. Magisk is a module based application, so its configuration can be as individual as the member applying them. Many modules exist for Magisk, providing all sorts of modifications, such as cloaking your device from SafetyNet.</p>
<h1 id="Highlights"><a href="#Highlights" class="headerlink" title="Highlights"></a>Highlights</h1><p>Open Source:</p>
<p>100% open source and easy to build on all Google supported platforms.</p>
<p>Magic Mount:</p>
<p>Modify system (vendor) without tampering the partitions.</p>
<p>MagiskSU:</p>
<p>Unleash your device’s root access.</p>
<p>MagiskHide:</p>
<p>Hide Magisk from detections: Google SafetyNet, enterprise &#x2F; bank system integrity checks, game tamper checks.</p>
<p>Resetprop:</p>
<p>Modify or delete any system properties, including read-only props.</p>
<p>Magisk Modules:</p>
<p>Install Magisk Modules from the community driven Magisk Module Repo.Many custom modules for Magisk,like Fonts,Audio Mod,DNS.</p>
<h1 id="What-is-Magisk-Manager"><a href="#What-is-Magisk-Manager" class="headerlink" title="What is Magisk Manager?"></a>What is Magisk Manager?</h1><p>Magisk Manager is the application same as SuperSU which is pre-installed on your device after you have rooted your Android device. If you want to use the magisk manager you can unroot your device and then root it with the help flashing Magisk-v20.zip or else you can install the magisk manager application and do the system less rooting on your device.</p>
<p>There are many questions raised, and people has a query that is How to root with magisk? The rooting procedure is simple, and you need a custom recovery installed on your device. If you have the custom recovery, then you can root your Android device by flashing the Magisk-v20.zip file.</p>
<h1 id="Magisk-and-superSu"><a href="#Magisk-and-superSu" class="headerlink" title="Magisk and superSu"></a>Magisk and superSu</h1><p>If you root your device with the help of magisk, then the magisk won’t do any changes in your system files. Magisk will modify the boot.img to magisk.img. Magisk won’t add any files in your system files.</p>
<p>When SuperSU roots your device, it will do the changes in the System files and also adds some files in the system partition. If you install SuperSU, you won’t be getting any OTA updates or any financial application won’t work on your device.</p>
<h1 id="guide"><a href="#guide" class="headerlink" title="guide"></a>guide</h1><p>Before Installing Magisk,you must Unlocking Bootloader.</p>
<h1 id="Download-Magisk-Zip-and-Magisk-Manager-APK"><a href="#Download-Magisk-Zip-and-Magisk-Manager-APK" class="headerlink" title="Download Magisk Zip and Magisk Manager APK"></a>Download Magisk Zip and Magisk Manager APK</h1><p>You can usually download Magisk from the original development thread at XDA. But it only provides Magisk download link for the latest version. However, sometimes, the latest version isn’t the best version for you. For instance, a newer version of Magisk may not be able to hide from an app like Google Pay which is actually known to run into problems despite using MagiskHide.</p>
<p>Using an older version of Magisk that you know works for you might be a temporary solution until it’s fixed. In that case, though, you’re out of luck. But not anymore. You can download all Magisk versions from below. The list below is comprehensive and contains all Magisk versions since it was released publicly.</p>
<p>Below, you will find oldest to the latest version of Magisk zip for Android Nougat, Oreo, and Pie and download them directly from the Magisk Github repository. Just click the direct Magisk download links below. Moreover, we’ve also listed the compatible version of Magisk Manager and Magisk Uninstaller for each Magisk release. You can use Magisk Uninstaller zip file to remove Magisk from your Android device.</p>
<h1 id="How-to-install-Magisk"><a href="#How-to-install-Magisk" class="headerlink" title="How to install Magisk?"></a>How to install Magisk?</h1><p>If you don’t have a Android device with a TWRP recovery,you can refer to Plan A.But I suggest you install it,it’s very userful.</p>
<p>If you have a Android device with a TWRP recovery,you can refer to Plan B.</p>
<p>If you are using a Huawei device running EMUI 8 and higher, please check its section.</p>
<p>If you are using a Samsung device that is launched with Android 9.0 (new devices in 2019), please check its section.</p>
<h1 id="Plan-A"><a href="#Plan-A" class="headerlink" title="Plan A"></a>Plan A</h1><ol>
<li>Download Magisk Manager on your Android device.</li>
<li>Install the application, and you might get an unknown source warning. You need to turn on Unknown Sources to turn it on, click on “Settings”.</li>
<li>Now, try to repeat the installation process again. Try installing the application and open it.</li>
<li>If you have already installed the Chainfire SuperSU on your device, then you need to grant the root permission.</li>
<li>Now, click on the Install button to install the magisk on your device.</li>
<li>If you will click on Install button you will see that it will ask you to select method.</li>
<li>Just click on Direct Install if you want to directly install the file on your phone without using custom recovery on your phone, or you can click on Download Zip File Only.</li>
<li>Now, if the download is the done. Magisk Manager will automatically install the file on your phone.</li>
</ol>
<h1 id="Plan-B"><a href="#Plan-B" class="headerlink" title="Plan B"></a>Plan B</h1><ol>
<li>Download the Magisk zip file.</li>
<li>Place the zip file in your internal storage. Make sure that you remember the proper location of the zip file.</li>
<li>Reboot your phone into recovery ensure that you have a custom recovery such as TWRP is installed on your phone.</li>
<li>Now, click on the Install button in the TWRP recovery.</li>
<li>Navigate the Magisk-v20.zip on your internal storage or SD card.</li>
<li>Now, install the zip file on your device and wait till it is getting installed on your device.</li>
<li>You have successfully flashed the Magisk-v20.zip on your device.</li>
<li>Reboot your phone and see if it works on your device.</li>
<li>Download the magisk manager application from the link given above.</li>
<li>Install the application by following the above procedure.</li>
<li>Open it and then you will see magisk is installed on your Android device.</li>
</ol>
<h1 id="How-to-use-Magisk-Hide"><a href="#How-to-use-Magisk-Hide" class="headerlink" title="How to use Magisk Hide?"></a>How to use Magisk Hide?</h1><p>Magisk Hide is the feature which is available in the Magisk Manager application and if you want to hide the root permission for the particular banking application.</p>
<p>You can turn the Magisk hide option from the settings of the magisk application then you can easily enjoy your favorite app without any issues.</p>
<p>If you want to activate the Magisk Hide option, then you can follow the below tutorial, and you can hide the root permission on your device.</p>
<ol>
<li>First, check the application which is not working on your rooted Android device.</li>
<li>Open Magisk on your device and click on the Menu button.</li>
<li>Now, Click on the Settings to turn on the magisk hide option.</li>
<li>Now, scroll down and enable the Magisk Hide option.</li>
<li>Press the Menu key again and click on the “Magisk Hide” option.</li>
<li>Now, you need to select the application from which you need to hide the root.</li>
<li>Open your banking application and then that’s it. You can run the banking application on your device now.</li>
</ol>
<h1 id="Huawei"><a href="#Huawei" class="headerlink" title="Huawei"></a>Huawei</h1><p>Huawei devices using Kirin processors have a different partitioning method from most common devices. Magisk is usually installed to the boot partition of the device, however Huawei devices do not have this partition. Depending on what EMUI version your device is running, the instructions will be slightly different.</p>
<p>Obtain Stock Images</p>
<p>Huawei does not release official factory images, however most firmware zips can be downloaded from the Huawei Firmware Database. To extract images from UPDATE.APP in the zip, you have to use Huawei Update Extractor (Windows only!)</p>
<p>EMUI 8</p>
<p>For EMUI 8 devices, your device has a partition named ramdisk, which is where Magisk is going to be installed.</p>
<p>If you plan to use custom recoveries, simply follow the instructions for custom recovery and you’re all set.</p>
<p>If you plan not to use custom recoveries, you will have to extract RAMDISK.img from your firmware. Follow the instructions for boot image patching above, but use the RAMDISK.img file instead of a boot image.</p>
<p>To flash the patched image to your device, here is the fastboot command:</p>
<p>fastboot flash ramdisk &#x2F;path&#x2F;to&#x2F;magisk_patched.img</p>
<p>Be aware you are flashing to ramdisk, not boot!</p>
<p>EMUI 9 or Higher</p>
<p>For EMUI 9+ devices, the ramdisk partition no longer exists. As a workaround, Magisk will be installed to the recovery_ramdisk partition. Please read the Magisk in Recovery section before following the instructions below!</p>
<p>Note: As I tested on my Honor View 10, Huawei’s kernel does not seem to be able to capture key button press events in early boot, so long pressing Volume Up does NOT boot to recovery on my device. Your experience may vary.</p>
<p>If you plan to use custom recoveries, simply follow the instructions for custom recovery and you’re all set.</p>
<p>Warning: Magisk will overwrite the custom recovery.</p>
<p>If you plan not to use custom recoveries, you will have to extract RECOVERY_RAMDIS.img from your firmware. Follow the instructions for boot image patching above, but use the RECOVERY_RAMDIS.img file instead of a boot image.</p>
<p>To flash the patched image to your device, here is the fastboot command:</p>
<p>fastboot flash recovery_ramdisk &#x2F;path&#x2F;to&#x2F;magisk_patched.img</p>
<p>Be aware you are flashing to recovery_ramdisk, not boot!</p>
<h1 id="Samsung-System-as-root"><a href="#Samsung-System-as-root" class="headerlink" title="Samsung (System-as-root)"></a>Samsung (System-as-root)</h1><p>If your device is NOT launched with Android 9.0 or higher (released after 2019), you are reading the wrong section.</p>
<p>Before Installing Magisk</p>
<p>Your device is non-A&#x2F;B and uses system-as-root, so Magisk will be installed to the recovery partition of your device. Please read the Magisk in Recovery section!</p>
<p>Installing Magisk WILL trip KNOX</p>
<p>Installing Magisk for the first time REQUIRES a full data wipe, backup before continue</p>
<p>You have to have your bootloader unlocked before following the instructions</p>
<p>Unlocking Bootloader</p>
<p>Normally I wouldn’t provide instructions for this, but since things had changed drastically from previous Samsung devices, and there are some caveats, I figure this would be helpful.</p>
<p>Allow bootloader unlocking in Developer options → OEM unlocking</p>
<p>Reboot your device to download mode. Either use adb reboot download, or use the key combo for your device.</p>
<p>Long press volume up to unlock the bootloader. This will wipe your data and automatically reboot.</p>
<p>Just when you think the bootloader is unlocked, it is actually not! Samsung introduced VaultKeeper, meaning the bootloader will reject any unofficial partitions before VaultKeeper explicitly allows it.</p>
<p>Go through the initial setup. Skip through all the steps since data will be wiped again later when we are installing Magisk. Connect the device to internet in the setup!</p>
<p>Enable developer options, and confirm that the OEM unlocking option exists and grayed out! The VaultKeeper service will unleash the bootloader after it confirms that the user has the OEM unlocking option enabled.</p>
<p>Your bootloader now accepts unofficial images in download mode.</p>
<p>Instructions</p>
<p>Download the firmware for your device.</p>
<p>Unzip the firmware and copy the AP tar file to your device. It is normally named as AP_[device_model_sw_ver].tar.md5</p>
<p>Install the latest Magisk Manager</p>
<p>In Magisk Manager: Install → Install → Select and Patch a File and select the AP tar file.</p>
<p>Magisk Manager will patch the whole firmware file and store the output to [Internal Storage]&#x2F;Download&#x2F;magisk_patched.tar</p>
<p>Copy the patched file to your PC with adb pull &#x2F;sdcard&#x2F;Download&#x2F;magisk_patched.tar. Do not use MTP as it is reported to corrupt files.</p>
<p>Reboot to download mode, and flash magisk_patched.tar as AP in Odin, together with the BL, CP and HOME_CSC files. Never flash only an AP file, as Odin can shrink your &#x2F;data file-system if you do.</p>
<p>Important: Uncheck “Auto Reboot” in Options!</p>
<p>Magisk is now successfully flashed to your device! But there are still several steps before you can properly use the device.</p>
<p>We now want to boot into the stock recovery to factory reset our device.</p>
<p>Full data wipe is mandatory! Do not skip this step.</p>
<p>Press Power + Volume Down to exit download mode. As soon as the screen turns off, immediately press the combo key to boot to recovery (e.g. on the S10 it is Power + Bixby + Volume Up). Since we want to boot into stock recovery, continue pressing the volume up button until you see the stock recovery screen.</p>
<p>Use volume buttons to navigate through the stock recovery menu, and the power button to select an option. Choose Wipe data&#x2F;factory reset to wipe the data of the device.</p>
<p>This time, we can finally boot to the system with Magisk. Select Reboot system now, and immediately press the combo key to recovery. After seeing the bootloader warning screen, release all buttons so it can boot to the system.</p>
<p>The device will automatically reboot for the first time it boots. This is completely normal and done by design.</p>
<p>After the device is booted up, do the usual initial setup. The following steps will need an internet connection.</p>
<p>You shall see Magisk Manager in your app drawer; if not, manually install the APK you downloaded in step 3 and continue to the next step. The app would be a stub and it shall automatically upgrade to the full Magisk Manager when you open it.</p>
<p>Magisk Manager will ask to do additional setups. Let it do its job and the app will automatically reboot your device.</p>
<p>Voila! Enjoy Magisk :)</p>
<p>Additional Info</p>
<p>Magisk actually patches 3 partitions on your device:</p>
<p>vbmeta: replace with empty vbmeta image to disable partition verification</p>
<p>boot: remove the signature of the image to prevent soft bricks</p>
<p>recovery: this is where Magisk is actually installed</p>
<p>Never, ever try to restore either of the 3 images mentioned back to stock! You can easily brick your device by doing so, and the only way out is to do full Odin restore following with factory reset. Just don’t do it.</p>
<p>If you want to upgrade your device, never flash the stock AP tar file with the reasons mentioned above. Always pre-patch the firmware before flashing in Odin.</p>
<p>If you don’t need to patch the full firmware, you can manually create a tar file with at least vbmeta.img, boot.img, and recovery.img to let Magisk Manager patch your images in the proper way.</p>
<h1 id="Magisk-Modules"><a href="#Magisk-Modules" class="headerlink" title="Magisk Modules"></a>Magisk Modules</h1>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/09/26/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Zax Tseng">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZAX">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | ZAX">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2022/09/26/%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%8C%96/" class="post-title-link" itemprop="url">前端工程化</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2022-09-26 21:07:20" itemprop="dateCreated datePublished" datetime="2022-09-26T21:07:20+08:00">2022-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2022-12-27 11:12:53" itemprop="dateModified" datetime="2022-12-27T11:12:53+08:00">2022-12-27</time>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <hr>
<p>title: 前端工程化</p>
<p>date: 2019-09-01 14:26:50</p>
<p>tags: javascript</p>
<p>categories:  # 这里写的分类会自动汇集到 categories 页面上,分类可以多级</p>
<ul>
<li>JS # 一级分类</li>
<li>前端工程化 # 二级分类</li>
</ul>
<hr>
<h1 id="模块化初探"><a href="#模块化初探" class="headerlink" title="模块化初探"></a>模块化初探</h1><h2 id="模块化系统的风格"><a href="#模块化系统的风格" class="headerlink" title="模块化系统的风格"></a>模块化系统的风格</h2><p>模块化的价值</p>
<p>最主要的目的：</p>
<ul>
<li>解决命名冲突</li>
<li>依赖管理</li>
</ul>
<p>其他价值:</p>
<ul>
<li>提高代码可读性</li>
<li>代码解耦,提高复用性</li>
</ul>
<h3 id="lt-script-gt-标签风格"><a href="#lt-script-gt-标签风格" class="headerlink" title="&lt;script&gt;标签风格"></a><code>&lt;script&gt;</code>标签风格</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;script src=<span class="string">&quot;module1.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;module2.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;module3.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>各个模块把接口暴露给全局对象,比如 window.各个模块通过全局对象进行相互访问</p>
<p>出现的问题:</p>
<ol>
<li>全局对象的冲突</li>
<li>加载的顺序很重要</li>
<li>开发者需要解决模块的依赖问题</li>
<li>在大项目中模块非常多难以维护</li>
</ol>
<h3 id="CommonJs-同步的-require"><a href="#CommonJs-同步的-require" class="headerlink" title="CommonJs: 同步的 require"></a>CommonJs: 同步的 require</h3><p>CommonJs 是 Node 独有的规范，浏览器中使用就需要用到 Browserify 解析了。</p>
<p>使用同步的<code>require</code>方法来加载依赖和返回暴露的接口.一个模块可以通过<code>exports</code>对象添加属性,或者设置<code>module.exports</code>的值来描述暴露对象.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>(<span class="string">&quot;moudle&quot;</span>);</span><br><span class="line"><span class="built_in">require</span>(<span class="string">&quot;../file.js&quot;</span>);</span><br><span class="line"><span class="built_in">exports</span>.<span class="property">doStuff</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;&#125;;</span><br><span class="line">moudle.<span class="property">exports</span> = someValue;</span><br></pre></td></tr></table></figure>

<p>优点:</p>
<ol>
<li>服务端代码可以被复用.</li>
<li>npm 有大量的代码</li>
<li>使用方便</li>
</ol>
<p>缺点:</p>
<ol>
<li>阻塞调用无法在网络环境应用,网络请求是异步的</li>
<li>不能并行<code>require</code>多个模块</li>
</ol>
<h4 id="CommonJS-规范"><a href="#CommonJS-规范" class="headerlink" title="CommonJS 规范"></a>CommonJS 规范</h4><ol>
<li>在一个模块中,存在一个自由的变量”require”,它是一个函数。</li>
</ol>
<p>这个”require”函数接收一个模块标识符。</p>
<p>“require”返回外部模块所输出的 API。 2. 在一个模块中,会存在一个名为”exports”的自由变量,它是一个对象,模块可以在执行的时候把自身的 API 加入到其中。 3. 模块必须使用”exports”对象来做为输出的唯一表示。</p>
<h3 id="AMD-规范-异步的-require"><a href="#AMD-规范-异步的-require" class="headerlink" title="AMD 规范: 异步的 require"></a>AMD 规范: 异步的 require</h3><p>AMD 主要解决两个问题:</p>
<ol>
<li>多个 js 文件可能有依赖关系,被依赖的文件需要早于依赖它的文件加载到浏览器</li>
<li>js 加载的时候浏览器会停止页面渲染,加载文件越多,页面失去响应时间越长</li>
</ol>
<h4 id="requireJS-语法"><a href="#requireJS-语法" class="headerlink" title="requireJS 语法"></a>requireJS 语法</h4><p>RequireJS 遵循 AMD 规范,用于解决命名冲突和文件依赖的问题.</p>
<p>requireJS 定义了一个函数 define,它是全局变量,用来定义模块</p>
<p><code>define(id?, dependencies?, factory);</code></p>
<ol>
<li>id：可选参数,用来定义模块的标识,如果没有提供该参数,脚本文件名(去掉拓展名)</li>
<li>dependencies：是一个当前模块依赖的模块名称数组</li>
<li>factory：工厂方法,模块初始化要执行的函数或对象。如果为函数,它应该只被执行一次。如果是对象,此对象应该为模块的输出值</li>
</ol>
<p>在页面上使用 require 函数加载模块</p>
<p><code>require([dependencies], function()&#123;&#125;);</code></p>
<p>require()函数接受两个参数:</p>
<ol>
<li>第一个参数是一个数组,表示所依赖的模块</li>
<li>第二个参数是一个回调函数,当前面指定的模块都加载成功后,它将被调用。加载的模块会以参数形式传入该函数,从而在回调函数内部就可以使用这些模块.</li>
</ol>
<p>require()函数在加载依赖的函数的时候是异步加载的,这样浏览器不会失去响应,它指定的回调函数,只有前面的模块都加载成功后,才会运行,解决了依赖性的问题。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span>([<span class="string">&quot;moudle&quot;</span>, <span class="string">&quot;../file&quot;</span>], <span class="keyword">function</span> (<span class="params">moudle, file</span>) &#123;</span><br><span class="line">  <span class="comment">/* ... */</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="title function_">define</span>(<span class="string">&quot;moudle&quot;</span>, [<span class="string">&quot;dep1&quot;</span>, <span class="string">&quot;dep2&quot;</span>], <span class="keyword">function</span> (<span class="params">d1, d2</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> someExportedValue;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="import和export的区别"><a href="#import和export的区别" class="headerlink" title="import和export的区别"></a><code>import</code>和<code>export</code>的区别</h1><p>以前:</p>
<p>CommonJS（服务器） 和 AMD（浏览器）规范各自实现了运行时加载模块的方法（没办法在编译时做“静态优化”）。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// CommonJS模块</span></span><br><span class="line"><span class="keyword">let</span> &#123; stat, exists, readFile &#125; = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">let</span> _fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">let</span> stat = _fs.<span class="property">stat</span>;</span><br><span class="line"><span class="keyword">let</span> exists = _fs.<span class="property">exists</span>;</span><br><span class="line"><span class="keyword">let</span> readfile = _fs.<span class="property">readfile</span>;</span><br></pre></td></tr></table></figure>

<p>现在：</p>
<p><strong>ES6</strong>：一个模块就是一个文件，<code>export/import</code>命令可以出现在模块的任何位置，只要处于模块顶层就可以。</p>
<p>通过<code>import</code>和<code>export</code>实现静态加载（编译时加载），服务端和浏览器通用。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ES6模块</span></span><br><span class="line"><span class="keyword">import</span> &#123; stat, exists, readFile &#125; <span class="keyword">from</span> <span class="string">&quot;fs&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>export</strong>：如果你希望外部能够读取模块内部的某个变量，就必须使用 export 关键字输出该变量</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// profile.js</span></span><br><span class="line"><span class="keyword">var</span> firstName = <span class="string">&quot;Michael&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> lastName = <span class="string">&quot;Jackson&quot;</span>;</span><br><span class="line"><span class="keyword">var</span> year = <span class="number">1958</span>;</span><br><span class="line"><span class="keyword">export</span> &#123; firstName, lastName, year &#125;;</span><br></pre></td></tr></table></figure>

<p>还可以输出函数和 class 类：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">multiply</span>(<span class="params">x, y</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> x * y;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>还可以改个名字输出：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">v1</span>(<span class="params"></span>) &#123; ... &#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">v2</span>(<span class="params"></span>) &#123; ... &#125;</span><br><span class="line"><span class="keyword">export</span> &#123;</span><br><span class="line">  v1 <span class="keyword">as</span> streamV1,</span><br><span class="line">  v2 <span class="keyword">as</span> streamV2,</span><br><span class="line">  v2 <span class="keyword">as</span> streamLatestVersion</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>需要特别注意的是，export 命令规定的是对外的接口，必须与模块内部的变量建立一一对应关系。</p>
</blockquote>
<p>export 语句输出的接口，与其对应的值是动态绑定关系，即通过该接口，可以取到模块内部实时的值。</p>
<p>CommonJS 模块输出的是值的缓存，不存在动态更新。</p>
<p>import：加载模块</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; firstName, lastName, year &#125; <span class="keyword">from</span> <span class="string">&quot;./profile&quot;</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setName</span>(<span class="params">element</span>) &#123;</span><br><span class="line">  element.<span class="property">textContent</span> = firstName + <span class="string">&quot; &quot;</span> + lastName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以改名字：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; lastName <span class="keyword">as</span> surname &#125; <span class="keyword">from</span> <span class="string">&quot;./profile&quot;</span>;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意，import 命令具有提升效果，会提升到整个模块的头部，首先执行。import 命令是编译阶段执行的，在代码运行之前。</p>
</blockquote>
<p>由于 import 是静态执行，所以不能使用表达式和变量。</p>
<p>会执行加载的模块：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;lodash&quot;</span>; <span class="comment">//仅仅执行lodash模块，但是不输入任何值。多次引入同一个模块仅执行一次。</span></span><br></pre></td></tr></table></figure>

<p>整体加载所有的模块：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> circle <span class="keyword">from</span> <span class="string">&quot;./circle&quot;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>export default</strong>：为模块指定默认输出，引用的时候不用知道输出的到底是什么，可以指定任意名字。</p>
<p>需要注意的是，这时 import 命令后面，不使用大括号。一个模块只能有一个默认输出。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// export-default.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;foo&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// import-default.js</span></span><br><span class="line"><span class="keyword">import</span> customName <span class="keyword">from</span> <span class="string">&quot;./export-default&quot;</span>;</span><br><span class="line"><span class="title function_">customName</span>(); <span class="comment">// &#x27;foo&#x27;</span></span><br></pre></td></tr></table></figure>

<p>同时引用默认模块和其他模块：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">function</span> (<span class="params">obj</span>) &#123;</span><br><span class="line">  <span class="comment">// ···</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">each</span>(<span class="params">obj, iterator, context</span>) &#123;</span><br><span class="line">  <span class="comment">// ···</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> &#123; each <span class="keyword">as</span> forEach &#125;;</span><br><span class="line"><span class="comment">//对应的加载</span></span><br><span class="line"><span class="keyword">import</span> _, &#123; each, each <span class="keyword">as</span> forEach &#125; <span class="keyword">from</span> <span class="string">&quot;lodash&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>ES6 模块加载 CommonJS 模块：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//commonjs模块：</span></span><br><span class="line"><span class="comment">// a.js</span></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="string">&quot;hello&quot;</span>,</span><br><span class="line">  <span class="attr">bar</span>: <span class="string">&quot;world&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 等同于</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">foo</span>: <span class="string">&quot;hello&quot;</span>,</span><br><span class="line">  <span class="attr">bar</span>: <span class="string">&quot;world&quot;</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//es6加载上面的模块：</span></span><br><span class="line"><span class="comment">// 写法一</span></span><br><span class="line"><span class="keyword">import</span> baz <span class="keyword">from</span> <span class="string">&quot;./a&quot;</span>;</span><br><span class="line"><span class="comment">// baz = &#123;foo: &#x27;hello&#x27;, bar: &#x27;world&#x27;&#125;;</span></span><br><span class="line"><span class="comment">// 写法二</span></span><br><span class="line"><span class="keyword">import</span> &#123; <span class="keyword">default</span> <span class="keyword">as</span> baz &#125; <span class="keyword">from</span> <span class="string">&quot;./a&quot;</span>;</span><br><span class="line"><span class="comment">// baz = &#123;foo: &#x27;hello&#x27;, bar: &#x27;world&#x27;&#125;;</span></span><br><span class="line"><span class="comment">// 写法三</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> baz <span class="keyword">from</span> <span class="string">&quot;./a&quot;</span>;</span><br><span class="line"><span class="comment">// baz = &#123;</span></span><br><span class="line"><span class="comment">//   get default() &#123;return module.exports;&#125;,</span></span><br><span class="line"><span class="comment">//   get foo() &#123;return this.default.foo&#125;.bind(baz),</span></span><br><span class="line"><span class="comment">//   get bar() &#123;return this.default.bar&#125;.bind(baz)</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>

<p>CommonJS 加载 ES6 模块：通过<code>import()</code>函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// es6.mjs</span></span><br><span class="line"><span class="keyword">let</span> foo = &#123; <span class="attr">bar</span>: <span class="string">&quot;my-default&quot;</span> &#125;;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> foo;</span><br><span class="line">foo = <span class="literal">null</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// commonjs.js</span></span><br><span class="line"><span class="keyword">const</span> es_namespace = <span class="keyword">await</span> <span class="keyword">import</span>(<span class="string">&quot;./es&quot;</span>);</span><br><span class="line"><span class="comment">// es_namespace = &#123;</span></span><br><span class="line"><span class="comment">//   get default() &#123;</span></span><br><span class="line"><span class="comment">//     ...</span></span><br><span class="line"><span class="comment">//   &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(es_namespace.<span class="property">default</span>);</span><br><span class="line"><span class="comment">// &#123; bar:&#x27;my-default&#x27; &#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="import-和-require-的区别"><a href="#import-和-require-的区别" class="headerlink" title="import 和 require 的区别"></a>import 和 require 的区别</h1><p>#module.exports 和 export default 的区别</p>
<h1 id="webpack"><a href="#webpack" class="headerlink" title="webpack"></a>webpack</h1><p>webpack 是收把项目当作一个整体,通过一个给定的的主文件,webpack 将从这个文件开始找到你的项目的所有依赖文件,使用 loaders 处理它们,最后打包成一个或多个浏览器可识别的 js 文件.</p>
<h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2><ol>
<li>新建一个文件夹,cd 到它的目录下.执行<code>npm init -y</code>命令</li>
<li>执行<code>npm install --save--dev webpack</code>命令安装(也可以全局安装)</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/配置</span><br><span class="line">touch webpack.<span class="property">config</span>.<span class="property">js</span></span><br><span class="line">vi  webpack.<span class="property">config</span>.<span class="property">js</span></span><br><span class="line"><span class="comment">//在里面写以下内容</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">const path = require(&#x27;path&#x27;);</span></span><br><span class="line"><span class="comment">module.exports = &#123;</span></span><br><span class="line"><span class="comment">  entry: &#x27;./src/index.js&#x27;, //入口</span></span><br><span class="line"><span class="comment">  output: &#123;</span></span><br><span class="line"><span class="comment">    filename: &#x27;bundle.js&#x27;,</span></span><br><span class="line"><span class="comment">    path: path.resolve(__dirname, &#x27;dist&#x27;)</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">&#125;;*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建文件</span></span><br><span class="line">touch src/index.<span class="property">js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//运行webpack</span></span><br><span class="line">npx webpack  <span class="comment">//这时会多出dist目录,里面有bundle.js文件</span></span><br></pre></td></tr></table></figure>

<h1 id="2-使用"><a href="#2-使用" class="headerlink" title="2.使用"></a>2.使用</h1><h3 id="1-在-index-js-里写"><a href="#1-在-index-js-里写" class="headerlink" title="1.在 index.js 里写"></a>1.在 index.js 里写</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">console.log(1)</span><br><span class="line"></span><br><span class="line">//再运行webpack:</span><br><span class="line">npx webpack</span><br><span class="line"></span><br><span class="line">//再看bundle.js,这时会多出来一行console.log(1)</span><br></pre></td></tr></table></figure>

<h3 id="2-安装-babel-loader-自动转换-es6"><a href="#2-安装-babel-loader-自动转换-es6" class="headerlink" title="2.安装 babel-loader 自动转换 es6"></a>2.安装 babel-loader 自动转换 es6</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//安装v6,命令行</span></span><br><span class="line">npm install babel-loader babel-core babel-preset-env webpack</span><br><span class="line"></span><br><span class="line"><span class="comment">//将这个复制到webpack的配置文件webpack.config.js里,加在output的下面</span></span><br><span class="line"><span class="attr">module</span>: &#123;</span><br><span class="line">  <span class="attr">rules</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">      <span class="attr">exclude</span>: <span class="regexp">/(node_modules|bower_components)/</span>,</span><br><span class="line">      <span class="attr">use</span>: &#123;</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">presets</span>: [<span class="string">&#x27;env&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//加在output的下面,复制完后成这样</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">  <span class="attr">output</span>: &#123;</span><br><span class="line">    <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span>,</span><br><span class="line">    <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">  <span class="attr">rules</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</span><br><span class="line">      <span class="attr">exclude</span>: <span class="regexp">/(node_modules|bower_components)/</span>,</span><br><span class="line">      <span class="attr">use</span>: &#123;</span><br><span class="line">        <span class="attr">loader</span>: <span class="string">&#x27;babel-loader&#x27;</span>,</span><br><span class="line">        <span class="attr">options</span>: &#123;</span><br><span class="line">          <span class="attr">presets</span>: [<span class="string">&#x27;env&#x27;</span>]</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>运行 npx webpack</p>
</blockquote>
<p>若出现 can’t find ‘…’或 can’t resolve ‘…’的报错,则安装省略号里的东西 npm i ‘省略号’</p>
<p>注意：若是 Couldn’t find preset “env”,不要安装 env,而是 npm i babel-preset-env</p>
<h3 id="3-使用-babel"><a href="#3-使用-babel" class="headerlink" title="3.使用 babel"></a>3.使用 babel</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//当你在写index.js里写</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="comment">//它就会帮你自动转换成es5了</span></span><br></pre></td></tr></table></figure>

<h3 id="NPM-脚本-NPM-Scripts"><a href="#NPM-脚本-NPM-Scripts" class="headerlink" title="NPM 脚本(NPM Scripts)"></a>NPM 脚本(NPM Scripts)</h3><p>在 package.json 文件中写入 npm 脚本,就可以使用<code>npm run build</code>替代<code>npx</code>命令.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">  &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: <span class="string">&quot;webpack-demo&quot;</span>,</span><br><span class="line">    <span class="string">&quot;version&quot;</span>: <span class="string">&quot;1.0.0&quot;</span>,</span><br><span class="line">    <span class="string">&quot;description&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;main&quot;</span>: <span class="string">&quot;index.js&quot;</span>,</span><br><span class="line">    <span class="string">&quot;scripts&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;test&quot;</span>: <span class="string">&quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</span>,</span><br><span class="line">+     <span class="string">&quot;build&quot;</span>: <span class="string">&quot;webpack&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">&quot;keywords&quot;</span>: [],</span><br><span class="line">    <span class="string">&quot;author&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">    <span class="string">&quot;license&quot;</span>: <span class="string">&quot;ISC&quot;</span>,</span><br><span class="line">    <span class="string">&quot;devDependencies&quot;</span>: &#123;</span><br><span class="line">      <span class="string">&quot;webpack&quot;</span>: <span class="string">&quot;^4.0.1&quot;</span>,</span><br><span class="line">      <span class="string">&quot;webpack-cli&quot;</span>: <span class="string">&quot;^2.0.9&quot;</span>,</span><br><span class="line">      <span class="string">&quot;lodash&quot;</span>: <span class="string">&quot;^4.17.5&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="管理资源-css-图片之类"><a href="#管理资源-css-图片之类" class="headerlink" title="管理资源(css,图片之类)"></a>管理资源(css,图片之类)</h3><h4 id="加载-CSS"><a href="#加载-CSS" class="headerlink" title="加载 CSS"></a>加载 CSS</h4><ol>
<li>需要先安装 style-laoder 和 css-loader</li>
</ol>
<p><code>npm install --save-dev style-loader css-loader</code></p>
<ol start="2">
<li>然后在<code>webpack.config.js</code>文件里添加规则</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">&#x27;path&#x27;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">entry</span>: <span class="string">&#x27;./src/index.js&#x27;</span>,</span><br><span class="line">    <span class="attr">output</span>: &#123;</span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&#x27;bundle.js&#x27;</span>,</span><br><span class="line">      <span class="attr">path</span>: path.<span class="title function_">resolve</span>(__dirname, <span class="string">&#x27;dist&#x27;</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">+   <span class="attr">module</span>: &#123;</span><br><span class="line">+     <span class="attr">rules</span>: [</span><br><span class="line">+       &#123;</span><br><span class="line">+         <span class="attr">test</span>: <span class="regexp">/\.css$/</span>,</span><br><span class="line">+         <span class="attr">use</span>: [</span><br><span class="line">+           <span class="string">&#x27;style-loader&#x27;</span>,</span><br><span class="line">+           <span class="string">&#x27;css-loader&#x27;</span></span><br><span class="line">+         ]</span><br><span class="line">+       &#125;</span><br><span class="line">+     ]</span><br><span class="line">+   &#125;</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>webpack 根据正则表达式,来确定应该查找哪些文件,并将其提供给指定的 loader。在这种情况下,以 .css 结尾的全部文件,都将被提供给 style-loader 和 css-loader。</p>
</blockquote>
<p>这使你可以在依赖于此样式的文件中<code>import &#39;./style.css&#39;</code>。现在,当该模块运行时,含有 CSS 字符串的<code>&lt;style&gt;</code>标签,将被插入到 html 文件的 <code>&lt;head&gt;</code>中。</p>
<h4 id="加载图片"><a href="#加载图片" class="headerlink" title="加载图片"></a>加载图片</h4><ol>
<li>安装<code>npm install --save-dev file-loader</code>插件</li>
<li>配置<code>webpack.config.js</code>文件</li>
</ol>
<p>现在,当你 <code>import MyImage from &#39;./my-image.png&#39;</code>,该图像将被处理并添加到 output 目录,</p>
<p><em>并且</em> <code>MyImage</code> 变量将包含该图像在处理后的最终 url。当使用 css-loader 时,如上所示,</p>
<p>你的 CSS 中的<code>url(&#39;./my-image.png&#39;)</code> 会使用类似的过程去处理。loader 会识别这是一个本地文件,</p>
<p>并将 <code>&#39;./my-image.png&#39;</code>路径,替换为输出目录中图像的最终路径。</p>
<p>html-loader 以相同的方式处理 <code>&lt;img src=&quot;./my-image.png&quot; /&gt;</code>。</p>
<ol start="3">
<li><p>在 src 文件夹下创建 icon.png.</p>
</li>
<li><p>修改<code>src/index.js</code>文件</p>
</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">import</span> _ <span class="keyword">from</span> <span class="string">&#x27;lodash&#x27;</span>;</span><br><span class="line">  <span class="keyword">import</span> <span class="string">&#x27;./style.css&#x27;</span>;</span><br><span class="line">+ <span class="keyword">import</span> <span class="title class_">Icon</span> <span class="keyword">from</span> <span class="string">&#x27;./icon.png&#x27;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">component</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> element = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Lodash,现在由此脚本导入</span></span><br><span class="line">    element.<span class="property">innerHTML</span> = _.<span class="title function_">join</span>([<span class="string">&#x27;Hello&#x27;</span>, <span class="string">&#x27;webpack&#x27;</span>], <span class="string">&#x27; &#x27;</span>);</span><br><span class="line">    element.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;hello&#x27;</span>);</span><br><span class="line"></span><br><span class="line">+   <span class="comment">// 将图像添加到我们现有的 div。</span></span><br><span class="line">+   <span class="keyword">var</span> myIcon = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">+   myIcon.<span class="property">src</span> = <span class="title class_">Icon</span>;</span><br><span class="line">+</span><br><span class="line">+   element.<span class="title function_">appendChild</span>(myIcon);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> element;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(<span class="title function_">component</span>());</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><code>src/style.css</code>中引入图片</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  .<span class="property">hello</span> &#123;</span><br><span class="line">    <span class="attr">color</span>: red;</span><br><span class="line">+   <span class="attr">background</span>: <span class="title function_">url</span>(<span class="string">&#x27;./icon.png&#x27;</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<ol start="6">
<li>重新构建<code>npm run build</code></li>
</ol>
<h1 id="Glup"><a href="#Glup" class="headerlink" title="Glup"></a>Glup</h1><p><strong>简介</strong></p>
<p>它是一款 nodejs 应用。</p>
<p>它是打造前端工作流的利器,打包、压缩、合并、git、远程操作…,</p>
<p>简单易用</p>
<p>无快不破</p>
<p>高质量的插件</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>安装 gulp</p>
<p><code>npm install -g gulp</code></p>
<p>如果报<code>Error: EACCES, open &#39;/Users/xxx/xxx.lock</code>错误。</p>
<p>先执行：<code>sudo chown -R $(whoami) $HOME/.npm</code></p>
<p>如果使用 npm 安装插件太慢(被墙),</p>
<p>可执行 <code>npm install -g cnpm --registry=https://registry.npm.taobao.org</code></p>
<p>先安装 cnpm, 之后再安装插件时用 cnpm 安装<code>cnpm install gulp</code></p>
<ol start="2">
<li>安装各种插件</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">npm install --save gulp            <span class="comment">//本地使用gulp</span></span><br><span class="line">npm install --save gulp-imagemin   <span class="comment">//压缩图片</span></span><br><span class="line">npm install --save gulp-minify-css <span class="comment">//压缩css</span></span><br><span class="line">npm install --save gulp-ruby-sass  <span class="comment">//sass</span></span><br><span class="line">npm install --save gulp-jshint     <span class="comment">//js代码检测</span></span><br><span class="line">npm install --save gulp-uglify     <span class="comment">//js压缩</span></span><br><span class="line">npm install --save gulp-concat     <span class="comment">//文件合并</span></span><br><span class="line">npm install --save gulp-rename     <span class="comment">//文件重命名</span></span><br><span class="line">npm install --save png-sprite      <span class="comment">//png合并</span></span><br><span class="line">npm install --save gulp-htmlmin    <span class="comment">//压缩html</span></span><br><span class="line">npm install --save gulp-clean      <span class="comment">//清空文件夹</span></span><br><span class="line">npm install --save browser-sync    <span class="comment">//文件修改浏览器自动刷新</span></span><br><span class="line">npm install --save gulp-shell      <span class="comment">//执行shell命令</span></span><br><span class="line">npm install --save gulp-ssh        <span class="comment">//操作远程机器</span></span><br><span class="line">npm install --save run-sequence    <span class="comment">//task顺序执行</span></span><br></pre></td></tr></table></figure>

<p>或者根据 package.json 自动安装。把 package.json 拷贝到自己的工程目录下,进入目录,执行:<code>npm install</code></p>
<h1 id="语法-gulp-API"><a href="#语法-gulp-API" class="headerlink" title="语法 gulp API"></a>语法 gulp API</h1><h2 id="gulp-src-globs-options"><a href="#gulp-src-globs-options" class="headerlink" title="gulp.src(globs[,options])"></a>gulp.src(globs[,options])</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gulp</span><br><span class="line">  .<span class="title function_">src</span>(<span class="string">&quot;client/templates/*.jade&quot;</span>)</span><br><span class="line">  .<span class="title function_">pipe</span>(<span class="title function_">jade</span>())</span><br><span class="line">  .<span class="title function_">pipe</span>(<span class="title function_">minify</span>()) <span class="comment">//压缩文件</span></span><br><span class="line">  .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;build/minified_templates&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>作用: 输出符合所提供的匹配模式或数组的文件.</p>
<p><strong>globs</strong> 类型: string 或 Array</p>
<p>所要读取的 glob 或者包含 globs 的数组.可以是地址</p>
<p><strong>options</strong> 类型:object</p>
<p>额外的选项参数</p>
<h2 id="gulp-dest-path-options"><a href="#gulp-dest-path-options" class="headerlink" title="gulp.dest(path[,options])"></a>gulp.dest(path[,options])</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gulp</span><br><span class="line">  .<span class="title function_">src</span>(<span class="string">&quot;./client/templates/*.jade&quot;</span>)</span><br><span class="line">  .<span class="title function_">pipe</span>(<span class="title function_">jade</span>())</span><br><span class="line">  .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;./build/templates&quot;</span>))</span><br><span class="line">  .<span class="title function_">pipe</span>(<span class="title function_">minify</span>())</span><br><span class="line">  .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;./build/minified_templates&quot;</span>));</span><br></pre></td></tr></table></figure>

<p>文件被 pipe 进来,dest 生成或者写入一个文件.</p>
<p><strong>path</strong></p>
<p>文件将被写入的路径(输出目录)。</p>
<h2 id="gulp-task-name-deps-fn"><a href="#gulp-task-name-deps-fn" class="headerlink" title="gulp.task(name[,deps],fn)"></a>gulp.task(name[,deps],fn)</h2><p>定义一个实现任务</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(&#x27;somename&#x27;, function()&#123;</span><br><span class="line">  //任务</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>name</strong></p>
<p>任务名字</p>
<p><strong>deps</strong> 类型: array</p>
<p>一个包含任务列表的数组,这些任务会在你当前运行任务之前完成.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gulp.task(&#x27;mytask&#x27;, [&#x27;array&#x27;, &#x27;of&#x27;, &#x27;task&#x27;, &#x27;names&#x27;], function()&#123;</span><br><span class="line">  //任务</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><strong>fn</strong></p>
<p>该函数定义任务所要执行的一些操作。通常来说,它会是这种形式：gulp.src().pipe(someplugin())。</p>
<h2 id="gulp-watch-glob-opts-tasks"><a href="#gulp-watch-glob-opts-tasks" class="headerlink" title="gulp.watch(glob[, opts], tasks)"></a>gulp.watch(glob[, opts], tasks)</h2><p>监视文件,并且可以在文件发生改动时候做一些事情。它总会返回一个 EventEmitter 来发射(emit) change 事件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> watcher = gulp.<span class="title function_">watch</span>(<span class="string">&quot;js/**/*.js&quot;</span>, [<span class="string">&quot;uglify&quot;</span>, <span class="string">&quot;reload&quot;</span>]);</span><br><span class="line">watcher.<span class="title function_">on</span>(<span class="string">&quot;change&quot;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(</span><br><span class="line">    <span class="string">&quot;File &quot;</span> + event.<span class="property">path</span> + <span class="string">&quot; was &quot;</span> + event.<span class="property">type</span> + <span class="string">&quot;, running tasks...&quot;</span></span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="gulp-使用实例"><a href="#gulp-使用实例" class="headerlink" title="gulp 使用实例"></a>gulp 使用实例</h1><h2 id="范例-1-压缩合并"><a href="#范例-1-压缩合并" class="headerlink" title="范例 1. 压缩合并"></a>范例 1. 压缩合并</h2><p>demo1 目录结构如下。把 demo1 中的 index.html 压缩,把 src 里面的 less 编译、合并、压缩、重命名、存储到 dist。src 里面的图片压缩、合并存储到 dist。src 里面的 js 做代码检查,压缩,合并,存储到 dist。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">+ demo1</span><br><span class="line">    + dist</span><br><span class="line">        + css</span><br><span class="line">            - merge.min.css</span><br><span class="line">        + js</span><br><span class="line">            - merge.min.js</span><br><span class="line">        + imgs</span><br><span class="line">            - 1.png</span><br><span class="line">            - 2.png</span><br><span class="line">        - index.html</span><br><span class="line">    + src</span><br><span class="line">        + css</span><br><span class="line">            - a.css</span><br><span class="line">            - b.css</span><br><span class="line">        + js</span><br><span class="line">            - a.js</span><br><span class="line">            - b.js</span><br><span class="line">        + imgs</span><br><span class="line">            - 1.png</span><br><span class="line">            - 2.png</span><br><span class="line">        - index.html</span><br></pre></td></tr></table></figure>

<p>创建 gulpfile.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入组件</span></span><br><span class="line"><span class="keyword">var</span> minifycss = <span class="built_in">require</span>(<span class="string">&quot;gulp-minify-css&quot;</span>), <span class="comment">// CSS压缩</span></span><br><span class="line">  uglify = <span class="built_in">require</span>(<span class="string">&quot;gulp-uglify&quot;</span>), <span class="comment">// js压缩</span></span><br><span class="line">  concat = <span class="built_in">require</span>(<span class="string">&quot;gulp-concat&quot;</span>), <span class="comment">// 合并文件</span></span><br><span class="line">  rename = <span class="built_in">require</span>(<span class="string">&quot;gulp-rename&quot;</span>), <span class="comment">// 重命名</span></span><br><span class="line">  clean = <span class="built_in">require</span>(<span class="string">&quot;gulp-clean&quot;</span>), <span class="comment">//清空文件夹</span></span><br><span class="line">  minhtml = <span class="built_in">require</span>(<span class="string">&quot;gulp-htmlmin&quot;</span>), <span class="comment">//html压缩</span></span><br><span class="line">  jshint = <span class="built_in">require</span>(<span class="string">&quot;gulp-jshint&quot;</span>), <span class="comment">//js代码规范性检查</span></span><br><span class="line">  imagemin = <span class="built_in">require</span>(<span class="string">&quot;gulp-imagemin&quot;</span>); <span class="comment">//图片压缩</span></span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;html&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;src/*.html&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">minhtml</span>(&#123; <span class="attr">collapseWhitespace</span>: <span class="literal">true</span> &#125;)) <span class="comment">//html压缩</span></span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;css&quot;</span>, <span class="keyword">function</span> (<span class="params">argument</span>) &#123;</span><br><span class="line">  gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;src/css/*.css&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">concat</span>(<span class="string">&quot;merge.css&quot;</span>)) <span class="comment">// CSS压缩</span></span><br><span class="line">    .<span class="title function_">pipe</span>(</span><br><span class="line">      <span class="title function_">rename</span>(&#123;</span><br><span class="line">        <span class="attr">suffix</span>: <span class="string">&quot;.min&quot;</span>, <span class="comment">// 重命名</span></span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">minifycss</span>()) <span class="comment">// CSS压缩</span></span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist/css/&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;js&quot;</span>, <span class="keyword">function</span> (<span class="params">argument</span>) &#123;</span><br><span class="line">  gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;src/js/*.js&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">jshint</span>()) <span class="comment">//js代码规范性检查</span></span><br><span class="line">    .<span class="title function_">pipe</span>(jshint.<span class="title function_">reporter</span>(<span class="string">&quot;default&quot;</span>))</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">concat</span>(<span class="string">&quot;merge.js&quot;</span>)) <span class="comment">// 合并文件</span></span><br><span class="line">    .<span class="title function_">pipe</span>(</span><br><span class="line">      <span class="title function_">rename</span>(&#123;</span><br><span class="line">        <span class="attr">suffix</span>: <span class="string">&quot;.min&quot;</span>, <span class="comment">// 重命名</span></span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">uglify</span>()) <span class="comment">// js压缩</span></span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist/js/&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;img&quot;</span>, <span class="keyword">function</span> (<span class="params">argument</span>) &#123;</span><br><span class="line">  gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;src/imgs/*&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">imagemin</span>()) <span class="comment">//图片压缩</span></span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist/imgs&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;clear&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  gulp.<span class="title function_">src</span>(<span class="string">&quot;dist/*&quot;</span>, &#123; <span class="attr">read</span>: <span class="literal">false</span> &#125;).<span class="title function_">pipe</span>(<span class="title function_">clean</span>()); <span class="comment">//清空文件夹</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;build&quot;</span>, [<span class="string">&quot;html&quot;</span>, <span class="string">&quot;css&quot;</span>, <span class="string">&quot;js&quot;</span>, <span class="string">&quot;img&quot;</span>]);</span><br></pre></td></tr></table></figure>

<p>最后命令行<code>gulp build;</code></p>
<p>可实现 src 目录下的 html 压缩,css、js 合并压缩,图片压缩,最后放入 dist 目录下</p>
<h2 id="范例-2-监控变动自动同步"><a href="#范例-2-监控变动自动同步" class="headerlink" title="范例 2. 监控变动自动同步"></a>范例 2. 监控变动自动同步</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入组件</span></span><br><span class="line"><span class="keyword">var</span> browserSync = <span class="built_in">require</span>(<span class="string">&quot;browser-sync&quot;</span>).<span class="title function_">create</span>(); <span class="comment">//用于浏览器自动刷新</span></span><br><span class="line"><span class="keyword">var</span> scp = <span class="built_in">require</span>(<span class="string">&quot;gulp-scp2&quot;</span>); <span class="comment">//用于scp到远程机器</span></span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;reload&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  browserSync.<span class="title function_">reload</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;server&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  browserSync.<span class="title function_">init</span>(&#123;</span><br><span class="line">    <span class="attr">server</span>: &#123;</span><br><span class="line">      <span class="attr">baseDir</span>: <span class="string">&quot;./src&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  gulp.<span class="title function_">watch</span>([<span class="string">&quot;**/*.css&quot;</span>, <span class="string">&quot;**/*.js&quot;</span>, <span class="string">&quot;**/*.html&quot;</span>], [<span class="string">&quot;reload&quot;</span>, <span class="string">&quot;scp&quot;</span>]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;scp&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;src/**/*&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(</span><br><span class="line">      <span class="title function_">scp</span>(&#123;</span><br><span class="line">        <span class="attr">host</span>: <span class="string">&quot;121.40.201.213&quot;</span>,</span><br><span class="line">        <span class="attr">username</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">        <span class="attr">privateKey</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;/Users/wingo/.ssh/id_rsa&quot;</span>),</span><br><span class="line">        <span class="attr">dest</span>: <span class="string">&quot;/var/www/fe.jirengu.com&quot;</span>,</span><br><span class="line">        <span class="attr">watch</span>: <span class="keyword">function</span> (<span class="params">client</span>) &#123;</span><br><span class="line">          client.<span class="title function_">on</span>(<span class="string">&quot;write&quot;</span>, <span class="keyword">function</span> (<span class="params">o</span>) &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;write %s&quot;</span>, o.<span class="property">destination</span>);</span><br><span class="line">          &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;)</span><br><span class="line">    )</span><br><span class="line">    .<span class="title function_">on</span>(<span class="string">&quot;error&quot;</span>, <span class="keyword">function</span> (<span class="params">err</span>) &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>命令行执行:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gulp scp;  <span class="comment">// 可把本地开发环境代码拷贝到服务器</span></span><br><span class="line">gulp server; <span class="comment">//可在本地创建服务器,本地开发浏览器立刻刷新</span></span><br></pre></td></tr></table></figure>

<h2 id="范例-3-监控项目文件变动-自动压缩、合并、打包、添加版本号"><a href="#范例-3-监控项目文件变动-自动压缩、合并、打包、添加版本号" class="headerlink" title="范例 3.   监控项目文件变动,自动压缩、合并、打包、添加版本号"></a>范例 3.   监控项目文件变动,自动压缩、合并、打包、添加版本号</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- build:css css/merge.css --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;css/a.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;css/b.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- endbuild --&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>demo1-工程化手动版<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- build:js js/merge.js --&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;js/a.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;js/b.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="comment">&lt;!-- endbuild --&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>设置 gulpfile.js 文件</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> rev = <span class="built_in">require</span>(<span class="string">&quot;gulp-rev&quot;</span>); <span class="comment">//添加版本号</span></span><br><span class="line"><span class="keyword">var</span> revReplace = <span class="built_in">require</span>(<span class="string">&quot;gulp-rev-replace&quot;</span>); <span class="comment">//版本号替换</span></span><br><span class="line"><span class="keyword">var</span> useref = <span class="built_in">require</span>(<span class="string">&quot;gulp-useref&quot;</span>); <span class="comment">//解析html资源定位</span></span><br><span class="line"><span class="keyword">var</span> filter = <span class="built_in">require</span>(<span class="string">&quot;gulp-filter&quot;</span>); <span class="comment">//过滤数据</span></span><br><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">&quot;gulp-uglify&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> csso = <span class="built_in">require</span>(<span class="string">&quot;gulp-csso&quot;</span>); <span class="comment">//css优化压缩</span></span><br><span class="line"><span class="keyword">var</span> clean = <span class="built_in">require</span>(<span class="string">&quot;gulp-clean&quot;</span>);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;index&quot;</span>, [<span class="string">&quot;clear&quot;</span>], <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> jsFilter = <span class="title function_">filter</span>(<span class="string">&quot;**/*.js&quot;</span>, &#123; <span class="attr">restore</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">  <span class="keyword">var</span> cssFilter = <span class="title function_">filter</span>(<span class="string">&quot;**/*.css&quot;</span>, &#123; <span class="attr">restore</span>: <span class="literal">true</span> &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> userefAssets = useref.<span class="title function_">assets</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> gulp</span><br><span class="line">    .<span class="title function_">src</span>(<span class="string">&quot;src/index.html&quot;</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(userefAssets) <span class="comment">// Concatenate with gulp-useref</span></span><br><span class="line">    .<span class="title function_">pipe</span>(jsFilter)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">uglify</span>()) <span class="comment">// Minify any javascript sources</span></span><br><span class="line">    .<span class="title function_">pipe</span>(jsFilter.<span class="property">restore</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(cssFilter)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">csso</span>()) <span class="comment">// Minify any CSS sources</span></span><br><span class="line">    .<span class="title function_">pipe</span>(cssFilter.<span class="property">restore</span>)</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">rev</span>()) <span class="comment">// Rename the concatenated files</span></span><br><span class="line">    .<span class="title function_">pipe</span>(userefAssets.<span class="title function_">restore</span>())</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">useref</span>())</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">revReplace</span>()) <span class="comment">// Substitute in new filenames</span></span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&quot;dist&quot;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;clear&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  gulp.<span class="title function_">src</span>(<span class="string">&quot;dist/*&quot;</span>, &#123; <span class="attr">read</span>: <span class="literal">false</span> &#125;).<span class="title function_">pipe</span>(<span class="title function_">clean</span>());</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="范例-4-本地-shell-命令-远程-shell-任务顺序执行…"><a href="#范例-4-本地-shell-命令-远程-shell-任务顺序执行…" class="headerlink" title="范例 4. 本地 shell 命令, 远程 shell, 任务顺序执行…"></a>范例 4. 本地 shell 命令, 远程 shell, 任务顺序执行…</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">&quot;gulp&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> shell = <span class="built_in">require</span>(<span class="string">&quot;gulp-shell&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> runSequence = <span class="built_in">require</span>(<span class="string">&quot;run-sequence&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">&quot;fs&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">GulpSSH</span> = <span class="built_in">require</span>(<span class="string">&quot;gulp-ssh&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//shell操作,</span></span><br><span class="line">gulp.<span class="title function_">task</span>(</span><br><span class="line">  <span class="string">&quot;git&quot;</span>,</span><br><span class="line">  shell.<span class="title function_">task</span>([<span class="string">&quot;git add .&quot;</span>, <span class="string">&#x27;git commit -am &quot;dd&quot;&#x27;</span>, <span class="string">&quot;git push -u origin dev&quot;</span>])</span><br><span class="line">);</span><br><span class="line">gulp.<span class="title function_">task</span>(</span><br><span class="line">  <span class="string">&quot;clear&quot;</span>,</span><br><span class="line">  shell.<span class="title function_">task</span>([<span class="string">&#x27;find . -name &quot;.DS_Store&quot; -depth -exec rm &#123;&#125; \\;&#x27;</span>])</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">//操作远程主机</span></span><br><span class="line"><span class="keyword">var</span> gulpSSH = <span class="keyword">new</span> <span class="title class_">GulpSSH</span>(&#123;</span><br><span class="line">  <span class="attr">ignoreErrors</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">sshConfig</span>: &#123;</span><br><span class="line">    <span class="attr">host</span>: <span class="string">&quot;121.40.201.213&quot;</span>,</span><br><span class="line">    <span class="attr">port</span>: <span class="number">22</span>,</span><br><span class="line">    <span class="attr">username</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">    <span class="attr">privateKey</span>: fs.<span class="title function_">readFileSync</span>(<span class="string">&quot;/Users/wingo/.ssh/id_rsa&quot;</span>),</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;remote&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> gulpSSH.<span class="title function_">shell</span>([</span><br><span class="line">    <span class="string">&quot;cd /var/www/fe.jirengu.com&quot;</span>,</span><br><span class="line">    <span class="string">&quot;git pull origin dev&quot;</span>,</span><br><span class="line">    <span class="string">&quot;rm -rf _runtime&quot;</span>,</span><br><span class="line">  ]);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;build&quot;</span>, <span class="keyword">function</span> (<span class="params">callback</span>) &#123;</span><br><span class="line">  <span class="title function_">runSequence</span>(<span class="string">&quot;git&quot;</span>, <span class="string">&quot;clear&quot;</span>, <span class="string">&quot;remote&quot;</span>, callback);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&quot;watch&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  gulp.<span class="title function_">watch</span>([<span class="string">&quot;**/*.css&quot;</span>, <span class="string">&quot;**/*.js&quot;</span>, <span class="string">&quot;**/*.html&quot;</span>, <span class="string">&quot;**/*.php&quot;</span>], [<span class="string">&quot;build&quot;</span>]);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="webpack-相关问题"><a href="#webpack-相关问题" class="headerlink" title="webpack 相关问题"></a>webpack 相关问题</h1><ol>
<li><strong>webpack 与 grunt、gulp 的不同</strong>？</li>
</ol>
<p>三者都是前端构建工具,grunt 和 gulp 在早期比较流行,现在 webpack 相对来说比较主流,不过一些轻量化的任务还是会用 gulp 来处理,比如单独打包 CSS 文件等。</p>
<p>grunt 和 gulp 是基于任务和流(Task、Stream)的。类似 jQuery,找到一个(或一类)文件,对其做一系列链式操作,更新流上的数据, 整条链式操作构成了一个任务,多个任务就构成了整个 web 的构建流程。</p>
<p>webpack 是基于入口的。webpack 会自动地递归解析入口所需要加载的所有资源文件,然后用不同的 Loader 来处理不同的文件,用 Plugin 来扩展 webpack 功能。</p>
<p>所以总结一下：</p>
<p>从构建思路来说</p>
<p>gulp 和 grunt 需要开发者将整个前端构建过程拆分成多个<code>Task</code>,并合理控制所有<code>Task</code>的调用关系</p>
<p>webpack 需要开发者找到入口,并需要清楚对于不同的资源应该使用什么 Loader 做何种解析和加工</p>
<p>对于知识背景来说</p>
<p>gulp 更像后端开发者的思路,需要对于整个流程了如指掌 webpack 更倾向于前端开发者的思路</p>
<ol start="2">
<li><strong>与 webpack 类似的工具还有哪些？谈谈你为什么最终选择(或放弃)使用 webpack？</strong></li>
</ol>
<p>同样是基于入口的打包工具还有以下几个主流的：</p>
<p>webpack</p>
<p>rollup</p>
<p>parcel</p>
<p>从应用场景上来看：</p>
<p>webpack 适用于大型复杂的前端站点构建</p>
<p>rollup 适用于基础库的打包,如 vue、react</p>
<p>parcel 适用于简单的实验性项目,他可以满足低门槛的快速看到效果</p>
<p>由于 parcel 在打包过程中给出的调试信息十分有限,所以一旦打包出错难以调试,所以不建议复杂的项目使用 parcel</p>
<ol start="3">
<li><strong>有哪些常见的 Loader？他们是解决什么问题的？</strong></li>
</ol>
<p><code>file-loader</code>：把文件输出到一个文件夹中,在代码中通过相对 URL 去引用输出的文件</p>
<p><code>url-loader</code>：和 file-loader 类似,但是能在文件很小的情况下以 base64 的方式把文件内容注入到代码中去</p>
<p><code>source-map-loader</code>：加载额外的 Source Map 文件,以方便断点调试</p>
<p><code>image-loader</code>：加载并且压缩图片文件</p>
<p><code>babel-loader</code>：把 ES6 转换成 ES5</p>
<p><code>css-loader</code>：加载 CSS,支持模块化、压缩、文件导入等特性</p>
<p><code>style-loader</code>：把 CSS 代码注入到 JavaScript 中,通过 DOM 操作去加载 CSS。</p>
<p><code>eslint-loader</code>：通过 ESLint 检查 JavaScript 代码</p>
<ol start="4">
<li><strong>有哪些常见的 Plugin？他们是解决什么问题的？</strong></li>
</ol>
<p><code>define-plugin</code>：定义环境变量</p>
<p><code>commons-chunk-plugin</code>：提取公共代码</p>
<p><code>uglifyjs-webpack-plugin</code>：通过 UglifyES 压缩 ES6 代码</p>
<ol start="5">
<li><strong>Loader 和 Plugin 的不同？</strong></li>
</ol>
<p><strong>不同的作用</strong></p>
<p>Loader 直译为”加载器”。Webpack 将一切文件视为模块,但是 webpack 原生是只能解析 js 文件,如果想将其他文件也打包的话,就会用到 loader。 所以 Loader 的作用是<strong>让 webpack 拥有了加载和解析非 JavaScript 文件的能力</strong>。</p>
<p>Plugin 直译为”插件”。Plugin 可以扩展 webpack 的功能,让 webpack 具有更多的灵活性。 在 Webpack 运行的生命周期中会广播出许多事件,Plugin 可以监听这些事件,在合适的时机通过 Webpack 提供的 API 改变输出结果。</p>
<p><strong>不同的用法</strong></p>
<p>Loader 在 module.rules 中配置,也就是它作为模块的解析规则而存在。 类型为数组,每一项都是一个 Object,里面描述了对于什么类型的文件(test),使用什么加载(loader)和使用的参数(options)</p>
<p>Plugin 在 plugins 中单独配置。 类型为数组,每一项是一个 plugin 的实例,参数都通过构造函数传入。</p>
<ol start="6">
<li><strong>webpack 的构建流程是什么?从读取配置到输出文件这个过程尽量说全</strong></li>
</ol>
<p>Webpack 的运行流程是一个串行的过程,从启动到结束会依次执行以下流程：</p>
<p>初始化参数：从配置文件和 Shell 语句中读取与合并参数,得出最终的参数;</p>
<p>开始编译：用上一步得到的参数初始化 Compiler 对象,加载所有配置的插件,执行对象的 run 方法开始执行编译;</p>
<p>确定入口：根据配置中的 entry 找出所有的入口文件;</p>
<p>编译模块：从入口文件出发,调用所有配置的 Loader 对模块进行翻译,再找出该模块依赖的模块,再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理;</p>
<p>完成模块编译：在经过第 4 步使用 Loader 翻译完所有模块后,得到了每个模块被翻译后的最终内容以及它们之间的依赖关系;</p>
<p>输出资源：根据入口和模块之间的依赖关系,组装成一个个包含多个模块的 Chunk,再把每个 Chunk 转换成一个单独的文件加入到输出列表,这步是可以修改输出内容的最后机会;</p>
<p>输出完成：在确定好输出内容后,根据配置确定输出的路径和文件名,把文件内容写入到文件系统。</p>
<p>在以上过程中,Webpack 会在特定的时间点广播出特定的事件,插件在监听到感兴趣的事件后会执行特定的逻辑,并且插件可以调用 Webpack 提供的 API 改变 Webpack 的运行结果。</p>
<ol start="7">
<li><strong>是否写过 Loader 和 Plugin？描述一下编写 loader 或 plugin 的思路？</strong></li>
</ol>
<p>Loader 像一个”翻译官”把读到的源文件内容转义成新的文件内容,并且每个 Loader 通过链式操作,将源文件一步步翻译成想要的样子。</p>
<p>编写 Loader 时要遵循单一原则,每个 Loader 只做一种”转义”工作。 每个 Loader 的拿到的是源文件内容(source),可以通过返回值的方式将处理后的内容输出,也可以调用 this.callback()方法,将内容返回给 webpack。 还可以通过 this.async()生成一个 callback 函数,再用这个 callback 将处理后的内容输出出去。 此外 webpack 还为开发者准备了开发 loader 的工具函数集——loader-utils。</p>
<p>相对于 Loader 而言,Plugin 的编写就灵活了许多。 webpack 在运行的生命周期中会广播出许多事件,Plugin 可以监听这些事件,在合适的时机通过 Webpack 提供的 API 改变输出结果。</p>
<ol start="8">
<li><strong>webpack 的热更新是如何做到的？说明其原理？</strong></li>
</ol>
<p>webpack 的热更新又称热替换(Hot Module Replacement),缩写为 HMR。 这个机制可以做到不用刷新浏览器而将新变更的模块替换掉旧的模块。</p>
<p><strong>原理：</strong></p>
<p><img src="https://i.loli.net/2019/09/20/vY3hdHTJVUNgtjo.jpg#alt=9m5z9odoe6.jpeg"></p>
<p>首先要知道 server 端和 client 端都做了处理工作</p>
<p><strong>第一步</strong>,在 webpack 的 watch 模式下,文件系统中某一个文件发生修改,webpack 监听到文件变化,根据配置文件对模块重新编译打包,并将打包后的代码通过简单的 JavaScript 对象保存在内存中。</p>
<p><strong>第二步</strong>是 webpack-dev-server 和 webpack 之间的接口交互,而在这一步,主要是 dev-server 的中间件 webpack-dev-middleware 和 webpack 之间的交互,webpack-dev-middleware 调用 webpack 暴露的 API 对代码变化进行监控,并且告诉 webpack,将代码打包到内存中。</p>
<p><strong>第三步</strong>是 webpack-dev-server 对文件变化的一个监控,这一步不同于第一步,并不是监控代码变化重新打包。当我们在配置文件中配置了 devServer.watchContentBase 为 true 的时候,Server 会监听这些配置文件夹中静态文件的变化,变化后会通知浏览器端对应用进行 live reload。注意,这儿是浏览器刷新,和 HMR 是两个概念。</p>
<p><strong>第四步</strong>也是 webpack-dev-server 代码的工作,该步骤主要是通过 sockjs(webpack-dev-server 的依赖)在浏览器端和服务端之间建立一个 websocket 长连接,将 webpack 编译打包的各个阶段的状态信息告知浏览器端,同时也包括第三步中 Server 监听静态文件变化的信息。浏览器端根据这些 socket 消息进行不同的操作。当然服务端传递的最主要信息还是新模块的 hash 值,后面的步骤根据这一 hash 值来进行模块热替换。</p>
<p>webpack-dev-server&#x2F;client 端并不能够请求更新的代码,也不会执行热更模块操作,而把这些工作又交回给了 webpack,webpack&#x2F;hot&#x2F;dev-server 的工作就是根据 webpack-dev-server&#x2F;client 传给它的信息以及 dev-server 的配置决定是刷新浏览器呢还是进行模块热更新。当然如果仅仅是刷新浏览器,也就没有后面那些步骤了。</p>
<p>HotModuleReplacement.runtime 是客户端 HMR 的中枢,它接收到上一步传递给他的新模块的 hash 值,它通过 JsonpMainTemplate.runtime 向 server 端发送 Ajax 请求,服务端返回一个 json,该 json 包含了所有要更新的模块的 hash 值,获取到更新列表后,该模块再次通过 jsonp 请求,获取到最新的模块代码。这就是上图中 7、8、9 步骤。</p>
<p>而第 10 步是决定 HMR 成功与否的关键步骤,在该步骤中,HotModulePlugin 将会对新旧模块进行对比,决定是否更新模块,在决定更新模块后,检查模块之间的依赖关系,更新模块的同时更新模块间的依赖引用。</p>
<p>最后一步,当 HMR 失败后,回退到 live reload 操作,也就是进行浏览器刷新来获取最新打包代码。</p>
<ol start="9">
<li><strong>如何利用 webpack 来优化前端性能？(提高性能和体验)</strong></li>
</ol>
<p>用 webpack 优化前端性能是指优化 webpack 的输出结果,让打包的最终结果在浏览器运行快速高效。</p>
<p>压缩代码。删除多余的代码、注释、简化代码的写法等等方式。可以利用 webpack 的 UglifyJsPlugin 和 ParallelUglifyPlugin 来压缩 JS 文件, 利用 cssnano(css-loader?minimize)来压缩 css</p>
<p>利用 CDN 加速。在构建过程中,将引用的静态资源路径修改为 CDN 上对应的路径。可以利用 webpack 对于 output 参数和各 loader 的 publicPath 参数来修改资源路径</p>
<p>删除死代码(Tree Shaking)。将代码中永远不会走到的片段删除掉。可以通过在启动 webpack 时追加参数–optimize-minimize 来实现</p>
<p>提取公共代码。</p>
<ol start="10">
<li><strong>如何提高 webpack 的构建速度？</strong></li>
</ol>
<p>多入口情况下,使用 CommonsChunkPlugin 来提取公共代码</p>
<p>通过 externals 配置来提取常用库</p>
<p>利用 DllPlugin 和 DllReferencePlugin 预编译资源模块 通过 DllPlugin 来对那些我们引用但是绝对不会修改的 npm 包来进行预编译,再通过 DllReferencePlugin 将预编译的模块加载进来。</p>
<p>使用 Happypack 实现多线程加速编译</p>
<p>使用 webpack-uglify-parallel 来提升 uglifyPlugin 的压缩速度。 原理上 webpack-uglify-parallel 采用了多核并行压缩来提升压缩速度</p>
<p>使用 Tree-shaking 和 Scope Hoisting 来剔除多余代码</p>
<ol start="11">
<li><strong>怎么配置单页应用？怎么配置多页应用?</strong></li>
</ol>
<p>单页应用可以理解为 webpack 的标准模式,直接在 entry 中指定单页应用的入口即可,这里不再赘述</p>
<p>多页应用的话,可以使用 webpack 的 AutoWebPlugin 来完成简单自动化的构建,但是前提是项目的目录结构必须遵守他预设的规范。 多页应用中要注意的是：</p>
<p>每个页面都有公共的代码,可以将这些代码抽离出来,避免重复的加载。比如,每个页面都引用了同一套 css 样式表</p>
<p>随着业务的不断扩展,页面可能会不断的追加,所以一定要让入口的配置足够灵活,避免每次添加新页面还需要修改构建配置</p>
<ol start="12">
<li><strong>npm 打包时需要注意哪些？如何利用 webpack 来更好的构建？</strong></li>
</ol>
<p>Npm 是目前最大的 JavaScript 模块仓库,里面有来自全世界开发者上传的可复用模块。你可能只是 JS 模块的使用者,但是有些情况你也会去选择上传自己开发的模块。 关于 NPM 模块上传的方法可以去官网上进行学习,这里只讲解如何利用 webpack 来构建。</p>
<p>NPM 模块需要注意以下问题：</p>
<p>要支持 CommonJS 模块化规范,所以要求打包后的最后结果也遵守该规则。</p>
<p>Npm 模块使用者的环境是不确定的,很有可能并不支持 ES6,所以打包的最后结果应该是采用 ES5 编写的。并且如果 ES5 是经过转换的,请最好连同 SourceMap 一同上传。</p>
<p>Npm 包大小应该是尽量小(有些仓库会限制包大小)</p>
<p>发布的模块不能将依赖的模块也一同打包,应该让用户选择性的去自行安装。这样可以避免模块应用者再次打包时出现底层模块被重复打包的情况。</p>
<p>UI 组件类的模块应该将依赖的其它资源文件,例如.css 文件也需要包含在发布的模块里。</p>
<p>基于以上需要注意的问题,我们可以对于 webpack 配置做以下扩展和优化：</p>
<p>CommonJS 模块化规范的解决方案：</p>
<p>设置<code>output.libraryTarget=&#39;commonjs2&#39;</code>使输出的代码符合 CommonJS2 模块化规范,以供给其它模块导入使用</p>
<p>输出 ES5 代码的解决方案：</p>
<p>使用 babel-loader 把 ES6 代码转换成 ES5 的代码。再通过开启<code>devtool: &#39;source-map&#39;</code>输出 SourceMap 以发布调试。</p>
<p>Npm 包大小尽量小的解决方案：</p>
<p>Babel 在把 ES6 代码转换成 ES5 代码时会注入一些辅助函数,最终导致每个输出的文件中都包含这段辅助函数的代码,造成了代码的冗余。解决方法是修改.babelrc 文件,为其加入 transform-runtime 插件</p>
<p>不能将依赖模块打包到 NPM 模块中的解决方案：</p>
<p>使用 externals 配置项来告诉 webpack 哪些模块不需要打包。</p>
<p>对于依赖的资源文件打包的解决方案：通过 css-loader 和 extract-text-webpack-plugin 来实现,配置如下：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">ExtractTextPlugin</span> = <span class="built_in">require</span>(<span class="string">&quot;extract-text-webpack-plugin&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">  <span class="attr">module</span>: &#123;</span><br><span class="line">    <span class="attr">rules</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="comment">//增加对CSS文件的支持</span></span><br><span class="line">        <span class="attr">test</span>: <span class="regexp">/\.css/</span>,</span><br><span class="line">        <span class="comment">//提取出 Chunk 中的CSS代码到单独的文件中</span></span><br><span class="line">        <span class="attr">use</span>: <span class="title class_">ExtractTextPlugin</span>.<span class="title function_">extract</span>(&#123;</span><br><span class="line">          <span class="attr">use</span>: [<span class="string">&quot;css-loader&quot;</span>],</span><br><span class="line">        &#125;),</span><br><span class="line">      &#125;,</span><br><span class="line">    ],</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">plugins</span>: [</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">ExtractTextPlugin</span>(&#123;</span><br><span class="line">      <span class="comment">//输出的CSS文件名称</span></span><br><span class="line">      <span class="attr">filename</span>: <span class="string">&quot;index.css&quot;</span>,</span><br><span class="line">    &#125;),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ol start="13">
<li><strong>如何在 vue 项目中实现按需加载？</strong></li>
</ol>
<p><strong>Vue UI 组件库的按需加载</strong>:</p>
<p>为了快速开发前端项目,经常会引入现成的 UI 组件库如 ElementUI、iView 等,但是他们的体积和他们所提供的功能一样,是很庞大的。 而通常情况下,我们仅仅需要少量的几个组件就足够了,但是我们却将庞大的组件库打包到我们的源码中,造成了不必要的开销。</p>
<p>不过很多组件库已经提供了现成的解决方案,如 Element 出品的 babel-plugin-component 和 AntDesign 出品的 babel-plugin-import 安装以上插件后,在.babelrc 配置中或 babel-loader 的参数中进行设置,即可实现组件按需加载了。</p>
<p><strong>单页应用的按需加载</strong></p>
<p>现在很多前端项目都是通过单页应用的方式开发的,但是随着业务的不断扩展,会面临一个严峻的问题——首次加载的代码量会越来越多,影响用户的体验。</p>
<p>通过<code>import(*)</code>语句来控制加载时机,webpack 内置了对于<code>import(*)</code>的解析,会将<code>import(*)</code>中引入的模块作为一个新的入口在生成一个 chunk。 当代码执行到<code>import(*)</code>语句时,会去加载 Chunk 对应生成的文件。<code>import()</code>会返回一个<strong>Promise 对象</strong>,所以为了让浏览器支持,需要事先注入<code>Promise polyfill</code>.</p>
<h1 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h1><p>nginx 是一个反向代理服务器.客户端向服务端发送请求,可以配置一个 nginx 代理服务器.</p>
<h3 id="反向代理"><a href="#反向代理" class="headerlink" title="反向代理"></a>反向代理</h3><p>代理服务器负责接收请求,转发给内部的服务器.从颞部服务器得到响应返回给客户端.</p>
<p>反向代理服务器为服务端工作.对服务端是透明的,对客户端不透明.</p>
<h2 id="nginx-的作用"><a href="#nginx-的作用" class="headerlink" title="nginx 的作用"></a>nginx 的作用</h2><p>解决跨域</p>
<p>请求过滤</p>
<p>负载均衡</p>
<p>配置 gzip</p>
<p>静态资源服务器</p>
<h3 id="解决跨域"><a href="#解决跨域" class="headerlink" title="解决跨域"></a>解决跨域</h3><p>在 server 中配置一个 server-name,和客户端同域名</p>
<p>在 Location 中拦截向客户端域名发送的请求,并且请求代理回服务器.</p>
<h3 id="请求过滤"><a href="#请求过滤" class="headerlink" title="请求过滤"></a>请求过滤</h3><p>在 Location 中过滤相应的状态码或者 url,或者请求类型</p>
<h3 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h3><p>通过配置 upstream 指定后端服务器的地址列表</p>
<p>在 server 中拦截请求,并将请求转发到 upstream 的后端服务器列表里.</p>
<h4 id="策略"><a href="#策略" class="headerlink" title="策略"></a>策略</h4><p>默认采用轮训的策略,缺点是一台服务器压力过大时,会影响其他服务器.</p>
<p>最小连接数策略,优先分配给连接数最少的服务器</p>
<p>least_connt</p>
<p>最快响应时间策略,优先分配给响应时间最短的服务器</p>
<p>fair</p>
<h2 id="静态资源服务器"><a href="#静态资源服务器" class="headerlink" title="静态资源服务器"></a>静态资源服务器</h2><p>在 Location 中配置,匹配比如说图片为结尾的请求,转发到本地路径.设置 root 指定路径.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Zax Tseng</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/mist/" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

    </div>
  </footer>

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  





  





</body>
</html>
